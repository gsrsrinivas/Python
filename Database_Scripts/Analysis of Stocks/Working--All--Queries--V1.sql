begin
select * from Analyse_Stocks where Batch_No = (select max(batch_no) from Analyse_Stocks)
and Trade_Type_Details != ''
order by Volume_Shockers desc
;
select coalesce(case when 1=1 then 'coalesce 1st part' else 'elsepart' end,'coalesce 2nd part') as checking
;
end
begin -- truncate tables
/*
truncate table dbo.Analyse_15Minutes_Stocks;
truncate table dbo.Analyse_Stocks;
truncate table dbo.Cash_15Minutes_Stocks;
truncate table dbo.Cash_Stocks;
*/
select * from Analyse_Stocks_v order by trading_view_order, volume_shockers desc ,Report_Sort_Order;
end
begin

-- column list
--  Sno,Batch_No,Created_Date,Report_Sort_Order,Symbol,Trading_View_Order,Segments_Order,Segments,Segments_Length,Segments_Sum,Volume_Shockers,Volume_Shockers_Sum,Trade_Type_Details_Length,Trade_Type_Details,Trade_Type_Details_Sum,Industry,Stock_Name,Percent_Change,Price,Volume,Series,Trading_View,Trade_Type,Trade_Type_Length,Trade_Type_Bullish_Sum,Trade_Type_Bearish_Sum,price_action,ISIN_Code
-- ,Bullish_Triple_Screen_Strong_Monthly,Bullish_Triple_Screen_Strong_Weekly,Bullish_Triple_Screen_Strong_Daily,Bullish_Triple_Screen_Strong_4_Hourly,Bullish_Triple_Screen_Strong_1_Hourly,Bullish_Triple_Screen_Strong_15_Minutes,Bullish_Triple_Screen_Strong_Correction_Monthly,Bullish_Triple_Screen_Strong_Correction_Weekly,Bullish_Triple_Screen_Strong_Correction_Daily,Bullish_Triple_Screen_Strong_Correction_4_Hourly,Bullish_Triple_Screen_Strong_Correction_1_Hourly,Bullish_Triple_Screen_Strong_Correction_15_Minutes,Bullish_Double_Screen_Strong_Quarterly,Bullish_Double_Screen_Strong_Monthly,Bullish_Double_Screen_Strong_Weekly,Bullish_Double_Screen_Strong_Daily,Bullish_Double_Screen_Strong_4_Hourly,Bullish_Double_Screen_Strong_1_Hourly,Bullish_Double_Screen_Strong_15_Minutes,Bullish_Double_Screen_Strong_Correction_Quarterly,Bullish_Double_Screen_Strong_Correction_Monthly,Bullish_Double_Screen_Strong_Correction_Weekly,Bullish_Double_Screen_Strong_Correction_Daily,Bullish_Double_Screen_Strong_Correction_4_Hourly,Bullish_Double_Screen_Strong_Correction_1_Hourly,Bullish_Double_Screen_Strong_Correction_15_Minutes,Bullish_Single_Screen_Yearly,Bullish_Single_Screen_Quarterly,Bullish_Single_Screen_Monthly,Bullish_Single_Screen_Weekly,Bullish_Single_Screen_Daily,Bullish_Single_Screen_4_Hourly,Bullish_Single_Screen_1_Hourly,Bullish_Single_Screen_15_Minutes
-- ,Bearish_Triple_Screen_Strong_Monthly,Bearish_Triple_Screen_Strong_Weekly,Bearish_Triple_Screen_Strong_Daily,Bearish_Triple_Screen_Strong_4_Hourly,Bearish_Triple_Screen_Strong_1_Hourly,Bearish_Triple_Screen_Strong_15_Minutes,Bearish_Triple_Screen_Strong_Correction_Monthly,Bearish_Triple_Screen_Strong_Correction_Weekly,Bearish_Triple_Screen_Strong_Correction_Daily,Bearish_Triple_Screen_Strong_Correction_4_Hourly,Bearish_Triple_Screen_Strong_Correction_1_Hourly,Bearish_Triple_Screen_Strong_Correction_15_Minutes,Bearish_Double_Screen_Strong_Quarterly,Bearish_Double_Screen_Strong_Monthly,Bearish_Double_Screen_Strong_Weekly,Bearish_Double_Screen_Strong_Daily,Bearish_Double_Screen_Strong_4_Hourly,Bearish_Double_Screen_Strong_1_Hourly,Bearish_Double_Screen_Strong_15_Minutes,Bearish_Double_Screen_Strong_Correction_Quarterly,Bearish_Double_Screen_Strong_Correction_Monthly,Bearish_Double_Screen_Strong_Correction_Weekly,Bearish_Double_Screen_Strong_Correction_Daily,Bearish_Double_Screen_Strong_Correction_4_Hourly,Bearish_Double_Screen_Strong_Correction_1_Hourly,Bearish_Double_Screen_Strong_Correction_15_Minutes,Bearish_Single_Screen_Yearly,Bearish_Single_Screen_Quarterly,Bearish_Single_Screen_Monthly,Bearish_Single_Screen_Weekly,Bearish_Single_Screen_Daily,Bearish_Single_Screen_4_Hourly,Bearish_Single_Screen_1_Hourly,Bearish_Single_Screen_15_Minutes
-- ,Macd_Yearly_Crosses_Above,Macd_Yearly_Crosses_Below,Macd_Quarterly_Crosses_Above,Macd_Quarterly_Crosses_Below,Macd_Monthly_Crosses_Above,Macd_Monthly_Crosses_Below,Macd_Weekly_Crosses_Above,Macd_Weekly_Crosses_Below,Macd_Daily_Crosses_Above,Macd_Daily_Crosses_Below,Macd_4_Hourly_Crosses_Above,Macd_4_Hourly_Crosses_Below,Macd_1_Hourly_Crosses_Above,Macd_1_Hourly_Crosses_Below,Macd_15_Minutes_Crosses_Above,Macd_15_Minutes_Crosses_Below,Stochastic_Yearly_Crosses_Above,Stochastic_Yearly_Crosses_Below,Stochastic_Quarterly_Crosses_Above,Stochastic_Quarterly_Crosses_Below,Stochastic_Monthly_Crosses_Above,Stochastic_Monthly_Crosses_Below,Stochastic_Weekly_Crosses_Above,Stochastic_Weekly_Crosses_Below,Stochastic_Daily_Crosses_Above,Stochastic_Daily_Crosses_Below,Stochastic_4_Hourly_Crosses_Above,Stochastic_4_Hourly_Crosses_Below,Stochastic_1_Hourly_Crosses_Above,Stochastic_1_Hourly_Crosses_Below,Stochastic_15_Minutes_Crosses_Above,Stochastic_15_Minutes_Crosses_Below,Ema_5_13_Yearly_Crosses_Above,Ema_5_13_Yearly_Crosses_Below,Ema_5_13_Quarterly_Crosses_Above,Ema_5_13_Quarterly_Crosses_Below,Ema_5_13_Monthly_Crosses_Above,Ema_5_13_Monthly_Crosses_Below,Ema_5_13_Weekly_Crosses_Above,Ema_5_13_Weekly_Crosses_Below,Ema_5_13_Daily_Crosses_Above,Ema_5_13_Daily_Crosses_Below,Ema_5_13_4_Hourly_Crosses_Above,Ema_5_13_4_Hourly_Crosses_Below,Ema_5_13_1_Hourly_Crosses_Above,Ema_5_13_1_Hourly_Crosses_Below,Ema_5_13_15_Minutes_Crosses_Above,Ema_5_13_15_Minutes_Crosses_Below,Ema_13_26_Yearly_Crosses_Above,Ema_13_26_Yearly_Crosses_Below,Ema_13_26_Quarterly_Crosses_Above,Ema_13_26_Quarterly_Crosses_Below,Ema_13_26_Monthly_Crosses_Above,Ema_13_26_Monthly_Crosses_Below,Ema_13_26_Weekly_Crosses_Above,Ema_13_26_Weekly_Crosses_Below,Ema_13_26_Daily_Crosses_Above,Ema_13_26_Daily_Crosses_Below,Ema_13_26_4_Hourly_Crosses_Above,Ema_13_26_4_Hourly_Crosses_Below,Ema_13_26_1_Hourly_Crosses_Above,Ema_13_26_1_Hourly_Crosses_Below,Ema_13_26_15_Minutes_Crosses_Above,Ema_13_26_15_Minutes_Crosses_Below,Ema_50_100_Yearly_Crosses_Above,Ema_50_100_Yearly_Crosses_Below,Ema_50_100_Quarterly_Crosses_Above,Ema_50_100_Quarterly_Crosses_Below,Ema_50_100_Monthly_Crosses_Above,Ema_50_100_Monthly_Crosses_Below,Ema_50_100_Weekly_Crosses_Above,Ema_50_100_Weekly_Crosses_Below,Ema_50_100_Daily_Crosses_Above,Ema_50_100_Daily_Crosses_Below,Ema_50_100_4_Hourly_Crosses_Above,Ema_50_100_4_Hourly_Crosses_Below,Ema_50_100_1_Hourly_Crosses_Above,Ema_50_100_1_Hourly_Crosses_Below,Ema_50_100_15_Minutes_Crosses_Above,Ema_50_100_15_Minutes_Crosses_Below,Ema_100_200_Yearly_Crosses_Above,Ema_100_200_Yearly_Crosses_Below,Ema_100_200_Quarterly_Crosses_Above,Ema_100_200_Quarterly_Crosses_Below,Ema_100_200_Monthly_Crosses_Above,Ema_100_200_Monthly_Crosses_Below,Ema_100_200_Weekly_Crosses_Above,Ema_100_200_Weekly_Crosses_Below,Ema_100_200_Daily_Crosses_Above,Ema_100_200_Daily_Crosses_Below,Ema_100_200_4_Hourly_Crosses_Above,Ema_100_200_4_Hourly_Crosses_Below,Ema_100_200_1_Hourly_Crosses_Above,Ema_100_200_1_Hourly_Crosses_Below,Ema_100_200_15_Minutes_Crosses_Above,Ema_100_200_15_Minutes_Crosses_Below,Adx_Yearly_Crosses_Above,Adx_Yearly_Crosses_Below,Adx_Quarterly_Crosses_Above,Adx_Quarterly_Crosses_Below,Adx_Monthly_Crosses_Above,Adx_Monthly_Crosses_Below,Adx_Weekly_Crosses_Above,Adx_Weekly_Crosses_Below,Adx_Daily_Crosses_Above,Adx_Daily_Crosses_Below,Adx_4_Hourly_Crosses_Above,Adx_4_Hourly_Crosses_Below,Adx_1_Hourly_Crosses_Above,Adx_1_Hourly_Crosses_Below,Adx_15_Minutes_Crosses_Above,Adx_15_Minutes_Crosses_Below,Rsi_Yearly_Crosses_Above,Rsi_Yearly_Crosses_Below,Rsi_Quarterly_Crosses_Above,Rsi_Quarterly_Crosses_Below,Rsi_Monthly_Crosses_Above,Rsi_Monthly_Crosses_Below,Rsi_Weekly_Crosses_Above,Rsi_Weekly_Crosses_Below,Rsi_Daily_Crosses_Above,Rsi_Daily_Crosses_Below,Rsi_4_Hourly_Crosses_Above,Rsi_4_Hourly_Crosses_Below,Rsi_1_Hourly_Crosses_Above,Rsi_1_Hourly_Crosses_Below,Rsi_15_Minutes_Crosses_Above,Rsi_15_Minutes_Crosses_Below,Upper_Bollinger_Band3_Yearly_Greater_Than_Equal_To,Upper_Bollinger_Band3_Yearly_Less_Than_Equal_To,Upper_Bollinger_Band3_Quarterly_Greater_Than_Equal_To,Upper_Bollinger_Band3_Quarterly_Less_Than_Equal_To,Upper_Bollinger_Band3_Monthly_Greater_Than_Equal_To,Upper_Bollinger_Band3_Monthly_Less_Than_Equal_To,Upper_Bollinger_Band3_Weekly_Greater_Than_Equal_To,Upper_Bollinger_Band3_Weekly_Less_Than_Equal_To,Upper_Bollinger_Band3_Daily_Greater_Than_Equal_To,Upper_Bollinger_Band3_Daily_Less_Than_Equal_To,Upper_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To,Upper_Bollinger_Band3_4_Hourly_Less_Than_Equal_To,Upper_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To,Upper_Bollinger_Band3_1_Hourly_Less_Than_Equal_To,Upper_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To,Upper_Bollinger_Band3_15_Minutes_Less_Than_Equal_To,Lower_Bollinger_Band3_Yearly_Greater_Than_Equal_To,Lower_Bollinger_Band3_Yearly_Less_Than_Equal_To,Lower_Bollinger_Band3_Quarterly_Greater_Than_Equal_To,Lower_Bollinger_Band3_Quarterly_Less_Than_Equal_To,Lower_Bollinger_Band3_Monthly_Greater_Than_Equal_To,Lower_Bollinger_Band3_Monthly_Less_Than_Equal_To,Lower_Bollinger_Band3_Weekly_Greater_Than_Equal_To,Lower_Bollinger_Band3_Weekly_Less_Than_Equal_To,Lower_Bollinger_Band3_Daily_Greater_Than_Equal_To,Lower_Bollinger_Band3_Daily_Less_Than_Equal_To,Lower_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To,Lower_Bollinger_Band3_4_Hourly_Less_Than_Equal_To,Lower_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To,Lower_Bollinger_Band3_1_Hourly_Less_Than_Equal_To,Lower_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To,Lower_Bollinger_Band3_15_Minutes_Less_Than_Equal_To,Upper_Bollinger_Band2_Yearly_Greater_Than_Equal_To,Upper_Bollinger_Band2_Yearly_Less_Than_Equal_To,Upper_Bollinger_Band2_Quarterly_Greater_Than_Equal_To,Upper_Bollinger_Band2_Quarterly_Less_Than_Equal_To,Upper_Bollinger_Band2_Monthly_Greater_Than_Equal_To,Upper_Bollinger_Band2_Monthly_Less_Than_Equal_To,Upper_Bollinger_Band2_Weekly_Greater_Than_Equal_To,Upper_Bollinger_Band2_Weekly_Less_Than_Equal_To,Upper_Bollinger_Band2_Daily_Greater_Than_Equal_To,Upper_Bollinger_Band2_Daily_Less_Than_Equal_To,Upper_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To,Upper_Bollinger_Band2_4_Hourly_Less_Than_Equal_To,Upper_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To,Upper_Bollinger_Band2_1_Hourly_Less_Than_Equal_To,Upper_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To,Upper_Bollinger_Band2_15_Minutes_Less_Than_Equal_To,Lower_Bollinger_Band2_Yearly_Greater_Than_Equal_To,Lower_Bollinger_Band2_Yearly_Less_Than_Equal_To,Lower_Bollinger_Band2_Quarterly_Greater_Than_Equal_To,Lower_Bollinger_Band2_Quarterly_Less_Than_Equal_To,Lower_Bollinger_Band2_Monthly_Greater_Than_Equal_To,Lower_Bollinger_Band2_Monthly_Less_Than_Equal_To,Lower_Bollinger_Band2_Weekly_Greater_Than_Equal_To,Lower_Bollinger_Band2_Weekly_Less_Than_Equal_To,Lower_Bollinger_Band2_Daily_Greater_Than_Equal_To,Lower_Bollinger_Band2_Daily_Less_Than_Equal_To,Lower_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To,Lower_Bollinger_Band2_4_Hourly_Less_Than_Equal_To,Lower_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To,Lower_Bollinger_Band2_1_Hourly_Less_Than_Equal_To,Lower_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To,Lower_Bollinger_Band2_15_Minutes_Less_Than_Equal_To,Volume_Yearly_Greater_Than_Equal_To,Volume_Yearly_Less_Than_Equal_To,Volume_Quarterly_Greater_Than_Equal_To,Volume_Quarterly_Less_Than_Equal_To,Volume_Monthly_Greater_Than_Equal_To,Volume_Monthly_Less_Than_Equal_To,Volume_Weekly_Greater_Than_Equal_To,Volume_Weekly_Less_Than_Equal_To,Volume_Daily_Greater_Than_Equal_To,Volume_Daily_Less_Than_Equal_To,Volume_4_Hourly_Greater_Than_Equal_To,Volume_4_Hourly_Less_Than_Equal_To,Volume_1_Hourly_Greater_Than_Equal_To,Volume_1_Hourly_Less_Than_Equal_To,Volume_15_Minutes_Greater_Than_Equal_To,Volume_15_Minutes_Less_Than_Equal_To,Adx_Up_Tick_Yearly_Greater_Than_Equal_To,Adx_Down_Tick_Yearly_Less_Than_Equal_To,Adx_Up_Tick_Quarterly_Greater_Than_Equal_To,Adx_Down_Tick_Quarterly_Less_Than_Equal_To,Adx_Up_Tick_Monthly_Greater_Than_Equal_To,Adx_Down_Tick_Monthly_Less_Than_Equal_To,Adx_Up_Tick_Weekly_Greater_Than_Equal_To,Adx_Down_Tick_Weekly_Less_Than_Equal_To,Adx_Up_Tick_Daily_Greater_Than_Equal_To,Adx_Down_Tick_Daily_Less_Than_Equal_To,Adx_Up_Tick_4_Hourly_Greater_Than_Equal_To,Adx_Down_Tick_4_Hourly_Less_Than_Equal_To,Adx_Up_Tick_1_Hourly_Greater_Than_Equal_To,Adx_Down_Tick_1_Hourly_Less_Than_Equal_To,Adx_Up_Tick_15_Minutes_Greater_Than_Equal_To,Adx_Down_Tick_15_Minutes_Less_Than_Equal_To,volume_yearly_shockers,volume_quarterly_shockers,volume_monthly_shockers,volume_weekly_shockers,volume_daily_shockers,volume_4_hourly_shockers,volume_1_hourly_shockers,volume_15_minutes_shockers
select * from [dbo].[Master_Stocks_In_Segments] where Industry is null;
select * from [dbo].[Master_Stocks_In_Segments] where Industry is not null;
select distinct segments from [dbo].[Master_Stocks_In_Segments] where Industry is null;
select * from [dbo].[Master_Stocks_Industry_Sector_Wise_distinct];

end
begin
select 
Sno,Batch_No,Created_Date,Report_Sort_Order,Symbol,Segments_Order,Segments,Segments_Length,Segments_Sum,Volume_Shockers,Volume_Shockers_Sum,Trade_Type_Details_Length,Trade_Type_Details,Trade_Type_Details_Sum,Industry,Stock_Name,Percent_Change,Price,Volume,Series,Trading_View,Trading_View_Order,Trade_Type,Trade_Type_Length,Trade_Type_Bullish_Sum,Trade_Type_Bearish_Sum,price_action,ISIN_Code
-- ,Bullish_Triple_Screen_Strong_Monthly,Bullish_Triple_Screen_Strong_Weekly,Bullish_Triple_Screen_Strong_Daily,Bullish_Triple_Screen_Strong_4_Hourly,Bullish_Triple_Screen_Strong_1_Hourly,Bullish_Triple_Screen_Strong_15_Minutes,Bullish_Triple_Screen_Strong_Correction_Monthly,Bullish_Triple_Screen_Strong_Correction_Weekly,Bullish_Triple_Screen_Strong_Correction_Daily,Bullish_Triple_Screen_Strong_Correction_4_Hourly,Bullish_Triple_Screen_Strong_Correction_1_Hourly,Bullish_Triple_Screen_Strong_Correction_15_Minutes,Bullish_Double_Screen_Strong_Quarterly,Bullish_Double_Screen_Strong_Monthly,Bullish_Double_Screen_Strong_Weekly,Bullish_Double_Screen_Strong_Daily,Bullish_Double_Screen_Strong_4_Hourly,Bullish_Double_Screen_Strong_1_Hourly,Bullish_Double_Screen_Strong_15_Minutes,Bullish_Double_Screen_Strong_Correction_Quarterly,Bullish_Double_Screen_Strong_Correction_Monthly,Bullish_Double_Screen_Strong_Correction_Weekly,Bullish_Double_Screen_Strong_Correction_Daily,Bullish_Double_Screen_Strong_Correction_4_Hourly,Bullish_Double_Screen_Strong_Correction_1_Hourly,Bullish_Double_Screen_Strong_Correction_15_Minutes,Bullish_Single_Screen_Yearly,Bullish_Single_Screen_Quarterly,Bullish_Single_Screen_Monthly,Bullish_Single_Screen_Weekly,Bullish_Single_Screen_Daily,Bullish_Single_Screen_4_Hourly,Bullish_Single_Screen_1_Hourly,Bullish_Single_Screen_15_Minutes
-- ,Bearish_Triple_Screen_Strong_Monthly,Bearish_Triple_Screen_Strong_Weekly,Bearish_Triple_Screen_Strong_Daily,Bearish_Triple_Screen_Strong_4_Hourly,Bearish_Triple_Screen_Strong_1_Hourly,Bearish_Triple_Screen_Strong_15_Minutes,Bearish_Triple_Screen_Strong_Correction_Monthly,Bearish_Triple_Screen_Strong_Correction_Weekly,Bearish_Triple_Screen_Strong_Correction_Daily,Bearish_Triple_Screen_Strong_Correction_4_Hourly,Bearish_Triple_Screen_Strong_Correction_1_Hourly,Bearish_Triple_Screen_Strong_Correction_15_Minutes,Bearish_Double_Screen_Strong_Quarterly,Bearish_Double_Screen_Strong_Monthly,Bearish_Double_Screen_Strong_Weekly,Bearish_Double_Screen_Strong_Daily,Bearish_Double_Screen_Strong_4_Hourly,Bearish_Double_Screen_Strong_1_Hourly,Bearish_Double_Screen_Strong_15_Minutes,Bearish_Double_Screen_Strong_Correction_Quarterly,Bearish_Double_Screen_Strong_Correction_Monthly,Bearish_Double_Screen_Strong_Correction_Weekly,Bearish_Double_Screen_Strong_Correction_Daily,Bearish_Double_Screen_Strong_Correction_4_Hourly,Bearish_Double_Screen_Strong_Correction_1_Hourly,Bearish_Double_Screen_Strong_Correction_15_Minutes,Bearish_Single_Screen_Yearly,Bearish_Single_Screen_Quarterly,Bearish_Single_Screen_Monthly,Bearish_Single_Screen_Weekly,Bearish_Single_Screen_Daily,Bearish_Single_Screen_4_Hourly,Bearish_Single_Screen_1_Hourly,Bearish_Single_Screen_15_Minutes
-- ,Macd_Yearly_Crosses_Above,Macd_Yearly_Crosses_Below,Macd_Quarterly_Crosses_Above,Macd_Quarterly_Crosses_Below,Macd_Monthly_Crosses_Above,Macd_Monthly_Crosses_Below,Macd_Weekly_Crosses_Above,Macd_Weekly_Crosses_Below,Macd_Daily_Crosses_Above,Macd_Daily_Crosses_Below,Macd_4_Hourly_Crosses_Above,Macd_4_Hourly_Crosses_Below,Macd_1_Hourly_Crosses_Above,Macd_1_Hourly_Crosses_Below,Macd_15_Minutes_Crosses_Above,Macd_15_Minutes_Crosses_Below,Stochastic_Yearly_Crosses_Above,Stochastic_Yearly_Crosses_Below,Stochastic_Quarterly_Crosses_Above,Stochastic_Quarterly_Crosses_Below,Stochastic_Monthly_Crosses_Above,Stochastic_Monthly_Crosses_Below,Stochastic_Weekly_Crosses_Above,Stochastic_Weekly_Crosses_Below,Stochastic_Daily_Crosses_Above,Stochastic_Daily_Crosses_Below,Stochastic_4_Hourly_Crosses_Above,Stochastic_4_Hourly_Crosses_Below,Stochastic_1_Hourly_Crosses_Above,Stochastic_1_Hourly_Crosses_Below,Stochastic_15_Minutes_Crosses_Above,Stochastic_15_Minutes_Crosses_Below,Ema_5_13_Yearly_Crosses_Above,Ema_5_13_Yearly_Crosses_Below,Ema_5_13_Quarterly_Crosses_Above,Ema_5_13_Quarterly_Crosses_Below,Ema_5_13_Monthly_Crosses_Above,Ema_5_13_Monthly_Crosses_Below,Ema_5_13_Weekly_Crosses_Above,Ema_5_13_Weekly_Crosses_Below,Ema_5_13_Daily_Crosses_Above,Ema_5_13_Daily_Crosses_Below,Ema_5_13_4_Hourly_Crosses_Above,Ema_5_13_4_Hourly_Crosses_Below,Ema_5_13_1_Hourly_Crosses_Above,Ema_5_13_1_Hourly_Crosses_Below,Ema_5_13_15_Minutes_Crosses_Above,Ema_5_13_15_Minutes_Crosses_Below,Ema_13_26_Yearly_Crosses_Above,Ema_13_26_Yearly_Crosses_Below,Ema_13_26_Quarterly_Crosses_Above,Ema_13_26_Quarterly_Crosses_Below,Ema_13_26_Monthly_Crosses_Above,Ema_13_26_Monthly_Crosses_Below,Ema_13_26_Weekly_Crosses_Above,Ema_13_26_Weekly_Crosses_Below,Ema_13_26_Daily_Crosses_Above,Ema_13_26_Daily_Crosses_Below,Ema_13_26_4_Hourly_Crosses_Above,Ema_13_26_4_Hourly_Crosses_Below,Ema_13_26_1_Hourly_Crosses_Above,Ema_13_26_1_Hourly_Crosses_Below,Ema_13_26_15_Minutes_Crosses_Above,Ema_13_26_15_Minutes_Crosses_Below,Ema_50_100_Yearly_Crosses_Above,Ema_50_100_Yearly_Crosses_Below,Ema_50_100_Quarterly_Crosses_Above,Ema_50_100_Quarterly_Crosses_Below,Ema_50_100_Monthly_Crosses_Above,Ema_50_100_Monthly_Crosses_Below,Ema_50_100_Weekly_Crosses_Above,Ema_50_100_Weekly_Crosses_Below,Ema_50_100_Daily_Crosses_Above,Ema_50_100_Daily_Crosses_Below,Ema_50_100_4_Hourly_Crosses_Above,Ema_50_100_4_Hourly_Crosses_Below,Ema_50_100_1_Hourly_Crosses_Above,Ema_50_100_1_Hourly_Crosses_Below,Ema_50_100_15_Minutes_Crosses_Above,Ema_50_100_15_Minutes_Crosses_Below,Ema_100_200_Yearly_Crosses_Above,Ema_100_200_Yearly_Crosses_Below,Ema_100_200_Quarterly_Crosses_Above,Ema_100_200_Quarterly_Crosses_Below,Ema_100_200_Monthly_Crosses_Above,Ema_100_200_Monthly_Crosses_Below,Ema_100_200_Weekly_Crosses_Above,Ema_100_200_Weekly_Crosses_Below,Ema_100_200_Daily_Crosses_Above,Ema_100_200_Daily_Crosses_Below,Ema_100_200_4_Hourly_Crosses_Above,Ema_100_200_4_Hourly_Crosses_Below,Ema_100_200_1_Hourly_Crosses_Above,Ema_100_200_1_Hourly_Crosses_Below,Ema_100_200_15_Minutes_Crosses_Above,Ema_100_200_15_Minutes_Crosses_Below,Adx_Yearly_Crosses_Above,Adx_Yearly_Crosses_Below,Adx_Quarterly_Crosses_Above,Adx_Quarterly_Crosses_Below,Adx_Monthly_Crosses_Above,Adx_Monthly_Crosses_Below,Adx_Weekly_Crosses_Above,Adx_Weekly_Crosses_Below,Adx_Daily_Crosses_Above,Adx_Daily_Crosses_Below,Adx_4_Hourly_Crosses_Above,Adx_4_Hourly_Crosses_Below,Adx_1_Hourly_Crosses_Above,Adx_1_Hourly_Crosses_Below,Adx_15_Minutes_Crosses_Above,Adx_15_Minutes_Crosses_Below,Rsi_Yearly_Crosses_Above,Rsi_Yearly_Crosses_Below,Rsi_Quarterly_Crosses_Above,Rsi_Quarterly_Crosses_Below,Rsi_Monthly_Crosses_Above,Rsi_Monthly_Crosses_Below,Rsi_Weekly_Crosses_Above,Rsi_Weekly_Crosses_Below,Rsi_Daily_Crosses_Above,Rsi_Daily_Crosses_Below,Rsi_4_Hourly_Crosses_Above,Rsi_4_Hourly_Crosses_Below,Rsi_1_Hourly_Crosses_Above,Rsi_1_Hourly_Crosses_Below,Rsi_15_Minutes_Crosses_Above,Rsi_15_Minutes_Crosses_Below,Upper_Bollinger_Band3_Yearly_Greater_Than_Equal_To,Upper_Bollinger_Band3_Yearly_Less_Than_Equal_To,Upper_Bollinger_Band3_Quarterly_Greater_Than_Equal_To,Upper_Bollinger_Band3_Quarterly_Less_Than_Equal_To,Upper_Bollinger_Band3_Monthly_Greater_Than_Equal_To,Upper_Bollinger_Band3_Monthly_Less_Than_Equal_To,Upper_Bollinger_Band3_Weekly_Greater_Than_Equal_To,Upper_Bollinger_Band3_Weekly_Less_Than_Equal_To,Upper_Bollinger_Band3_Daily_Greater_Than_Equal_To,Upper_Bollinger_Band3_Daily_Less_Than_Equal_To,Upper_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To,Upper_Bollinger_Band3_4_Hourly_Less_Than_Equal_To,Upper_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To,Upper_Bollinger_Band3_1_Hourly_Less_Than_Equal_To,Upper_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To,Upper_Bollinger_Band3_15_Minutes_Less_Than_Equal_To,Lower_Bollinger_Band3_Yearly_Greater_Than_Equal_To,Lower_Bollinger_Band3_Yearly_Less_Than_Equal_To,Lower_Bollinger_Band3_Quarterly_Greater_Than_Equal_To,Lower_Bollinger_Band3_Quarterly_Less_Than_Equal_To,Lower_Bollinger_Band3_Monthly_Greater_Than_Equal_To,Lower_Bollinger_Band3_Monthly_Less_Than_Equal_To,Lower_Bollinger_Band3_Weekly_Greater_Than_Equal_To,Lower_Bollinger_Band3_Weekly_Less_Than_Equal_To,Lower_Bollinger_Band3_Daily_Greater_Than_Equal_To,Lower_Bollinger_Band3_Daily_Less_Than_Equal_To,Lower_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To,Lower_Bollinger_Band3_4_Hourly_Less_Than_Equal_To,Lower_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To,Lower_Bollinger_Band3_1_Hourly_Less_Than_Equal_To,Lower_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To,Lower_Bollinger_Band3_15_Minutes_Less_Than_Equal_To,Upper_Bollinger_Band2_Yearly_Greater_Than_Equal_To,Upper_Bollinger_Band2_Yearly_Less_Than_Equal_To,Upper_Bollinger_Band2_Quarterly_Greater_Than_Equal_To,Upper_Bollinger_Band2_Quarterly_Less_Than_Equal_To,Upper_Bollinger_Band2_Monthly_Greater_Than_Equal_To,Upper_Bollinger_Band2_Monthly_Less_Than_Equal_To,Upper_Bollinger_Band2_Weekly_Greater_Than_Equal_To,Upper_Bollinger_Band2_Weekly_Less_Than_Equal_To,Upper_Bollinger_Band2_Daily_Greater_Than_Equal_To,Upper_Bollinger_Band2_Daily_Less_Than_Equal_To,Upper_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To,Upper_Bollinger_Band2_4_Hourly_Less_Than_Equal_To,Upper_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To,Upper_Bollinger_Band2_1_Hourly_Less_Than_Equal_To,Upper_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To,Upper_Bollinger_Band2_15_Minutes_Less_Than_Equal_To,Lower_Bollinger_Band2_Yearly_Greater_Than_Equal_To,Lower_Bollinger_Band2_Yearly_Less_Than_Equal_To,Lower_Bollinger_Band2_Quarterly_Greater_Than_Equal_To,Lower_Bollinger_Band2_Quarterly_Less_Than_Equal_To,Lower_Bollinger_Band2_Monthly_Greater_Than_Equal_To,Lower_Bollinger_Band2_Monthly_Less_Than_Equal_To,Lower_Bollinger_Band2_Weekly_Greater_Than_Equal_To,Lower_Bollinger_Band2_Weekly_Less_Than_Equal_To,Lower_Bollinger_Band2_Daily_Greater_Than_Equal_To,Lower_Bollinger_Band2_Daily_Less_Than_Equal_To,Lower_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To,Lower_Bollinger_Band2_4_Hourly_Less_Than_Equal_To,Lower_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To,Lower_Bollinger_Band2_1_Hourly_Less_Than_Equal_To,Lower_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To,Lower_Bollinger_Band2_15_Minutes_Less_Than_Equal_To,Volume_Yearly_Greater_Than_Equal_To,Volume_Yearly_Less_Than_Equal_To,Volume_Quarterly_Greater_Than_Equal_To,Volume_Quarterly_Less_Than_Equal_To,Volume_Monthly_Greater_Than_Equal_To,Volume_Monthly_Less_Than_Equal_To,Volume_Weekly_Greater_Than_Equal_To,Volume_Weekly_Less_Than_Equal_To,Volume_Daily_Greater_Than_Equal_To,Volume_Daily_Less_Than_Equal_To,Volume_4_Hourly_Greater_Than_Equal_To,Volume_4_Hourly_Less_Than_Equal_To,Volume_1_Hourly_Greater_Than_Equal_To,Volume_1_Hourly_Less_Than_Equal_To,Volume_15_Minutes_Greater_Than_Equal_To,Volume_15_Minutes_Less_Than_Equal_To,Adx_Up_Tick_Yearly_Greater_Than_Equal_To,Adx_Down_Tick_Yearly_Less_Than_Equal_To,Adx_Up_Tick_Quarterly_Greater_Than_Equal_To,Adx_Down_Tick_Quarterly_Less_Than_Equal_To,Adx_Up_Tick_Monthly_Greater_Than_Equal_To,Adx_Down_Tick_Monthly_Less_Than_Equal_To,Adx_Up_Tick_Weekly_Greater_Than_Equal_To,Adx_Down_Tick_Weekly_Less_Than_Equal_To,Adx_Up_Tick_Daily_Greater_Than_Equal_To,Adx_Down_Tick_Daily_Less_Than_Equal_To,Adx_Up_Tick_4_Hourly_Greater_Than_Equal_To,Adx_Down_Tick_4_Hourly_Less_Than_Equal_To,Adx_Up_Tick_1_Hourly_Greater_Than_Equal_To,Adx_Down_Tick_1_Hourly_Less_Than_Equal_To,Adx_Up_Tick_15_Minutes_Greater_Than_Equal_To,Adx_Down_Tick_15_Minutes_Less_Than_Equal_To,volume_yearly_shockers,volume_quarterly_shockers,volume_monthly_shockers,volume_weekly_shockers,volume_daily_shockers,volume_4_hourly_shockers,volume_1_hourly_shockers,volume_15_minutes_shockers
from Analyse_Stocks where Batch_No = (select max(batch_no) from Analyse_Stocks)
-- and Trading_View_Order is not null
order by Report_Sort_Order,Trading_View_Order, Volume_Shockers desc
;

select * from dbo.Master_Stocks_In_Segments where Industry is null

-- update a set 
Industry = b.[Industry / Segment]
,ISIN_Code = b.[ISIN Code]
,series = b.series
from dbo.Master_Stocks_In_Segments a
inner join [dbo].[Symbol-IndustrySegment-Series] b on a.Symbol = b.Symbol

select * from dbo.Master_Stocks_In_Segments a
-- inner join [dbo].[Symbol-IndustrySegment-Series] b on a.Symbol = b.Symbol
where a.Industry is null

select * from [dbo].[Symbol-IndustrySegment-Series]
end

begin
DECLARE @StartTime DATETIME = GETDATE();
PRINT 'Script started at: ' + CONVERT(VARCHAR, @StartTime, 121);

-- delete from dbo.Cash_Stocks where Batch_No = 20250731180015;

BULK INSERT dbo.cash_stocks FROM 'C:\Users\gsrsr\Documents\PythonProject\Chart_Ink\Source\chart_ink_daily1.csv'
WITH ( 
	FIELDTERMINATOR = ',',   -- Column delimiter, e.g., comma for CSV
	ROWTERMINATOR = '\n',       -- Row delimiter, newline character
	FIRSTROW = 2,   -- Skip header row if present (start at row 2)
	TABLOCK,        -- Optional: improve performance by locking the table
	KEEPIDENTITY    -- keep identity values from file
);

-- select count(1) from dbo.Cash_Stocks where Batch_No = (select max(batch_no) from dbo.Cash_Stocks)
DECLARE	 @EndTime DATETIME = GETDATE() --,@StartTime DATETIME = GETDATE(); 
DECLARE	 @DurationMs INT = DATEDIFF(MILLISECOND, @StartTime, @EndTime); 

PRINT 'Script started at: ' + CONVERT(VARCHAR, @StartTime, 121); 
PRINT 'Script ended at  : ' + CONVERT(VARCHAR, @EndTime, 121); 
PRINT 'Duration (ms)    : ' + CAST(@DurationMs AS VARCHAR); 
PRINT 'Duration         : ' + CAST(CAST(DATEADD(MILLISECOND, @DurationMs, '00:00:00.000') AS TIME) as VARCHAR)
; 

end