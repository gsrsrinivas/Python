begin transaction
begin -- all the running queries are stored  
DECLARE @Batch_no INT
end
------------------------------------------------------------------------------------------------------------
-- C:\Program Files\Microsoft SQL Server\MSSQL16.MSSQLSERVER\MSSQL\DATA\
SELECT @Batch_no = MAX(batch_no) FROM dbo.Analyse_Stocks;

-- Step 1: Create a temp table to hold all MACD crosses
SELECT 
    cs.Symbol,
    CASE WHEN Indicator = 'Macd' AND TimeLine = 'Yearly' AND Direction = 'Crosses Above' THEN 1 ELSE 0 END AS Macd_Yearly_Crosses_Above,
    CASE WHEN Indicator = 'Macd' AND TimeLine = 'Yearly' AND Direction = 'Crosses Below' THEN 1 ELSE 0 END AS Macd_Yearly_Crosses_Below,
    CASE WHEN Indicator = 'Macd' AND TimeLine = 'Quarterly' AND Direction = 'Crosses Above' THEN 1 ELSE 0 END AS Macd_Quarterly_Crosses_Above,
    CASE WHEN Indicator = 'Macd' AND TimeLine = 'Quarterly' AND Direction = 'Crosses Below' THEN 1 ELSE 0 END AS Macd_Quarterly_Crosses_Below,
    CASE WHEN Indicator = 'Macd' AND TimeLine = 'Monthly' AND Direction = 'Crosses Above' THEN 1 ELSE 0 END AS Macd_Monthly_Crosses_Above,
    CASE WHEN Indicator = 'Macd' AND TimeLine = 'Monthly' AND Direction = 'Crosses Below' THEN 1 ELSE 0 END AS Macd_Monthly_Crosses_Below,
    CASE WHEN Indicator = 'Macd' AND TimeLine = 'Weekly' AND Direction = 'Crosses Above' THEN 1 ELSE 0 END AS Macd_Weekly_Crosses_Above,
    CASE WHEN Indicator = 'Macd' AND TimeLine = 'Weekly' AND Direction = 'Crosses Below' THEN 1 ELSE 0 END AS Macd_Weekly_Crosses_Below,
    CASE WHEN Indicator = 'Macd' AND TimeLine = 'Daily' AND Direction = 'Crosses Above' THEN 1 ELSE 0 END AS Macd_Daily_Crosses_Above,
    CASE WHEN Indicator = 'Macd' AND TimeLine = 'Daily' AND Direction = 'Crosses Below' THEN 1 ELSE 0 END AS Macd_Daily_Crosses_Below,
    CASE WHEN Indicator = 'Macd' AND TimeLine = '4 Hourly' AND Direction = 'Crosses Above' THEN 1 ELSE 0 END AS Macd_4_Hourly_Crosses_Above,
    CASE WHEN Indicator = 'Macd' AND TimeLine = '4 Hourly' AND Direction = 'Crosses Below' THEN 1 ELSE 0 END AS Macd_4_Hourly_Crosses_Below,
    CASE WHEN Indicator = 'Macd' AND TimeLine = '1 Hourly' AND Direction = 'Crosses Above' THEN 1 ELSE 0 END AS Macd_1_Hourly_Crosses_Above,
    CASE WHEN Indicator = 'Macd' AND TimeLine = '1 Hourly' AND Direction = 'Crosses Below' THEN 1 ELSE 0 END AS Macd_1_Hourly_Crosses_Below,
    CASE WHEN Indicator = 'Macd' AND TimeLine = '15 Minutes' AND Direction = 'Crosses Above' THEN 1 ELSE 0 END AS Macd_15_Minutes_Crosses_Above,
    CASE WHEN Indicator = 'Macd' AND TimeLine = '15 Minutes' AND Direction = 'Crosses Below' THEN 1 ELSE 0 END AS Macd_15_Minutes_Crosses_Below
INTO #MacdIndicators
FROM dbo.Cash_Stocks cs;

-- Step 2: Update Analyse_Stocks in a single pass
UPDATE a
SET 
    Macd_Yearly_Crosses_Above = b.Macd_Yearly_Crosses_Above,
    Macd_Yearly_Crosses_Below = b.Macd_Yearly_Crosses_Below,
    Macd_Quarterly_Crosses_Above = b.Macd_Quarterly_Crosses_Above,
    Macd_Quarterly_Crosses_Below = b.Macd_Quarterly_Crosses_Below,
    Macd_Monthly_Crosses_Above = b.Macd_Monthly_Crosses_Above,
    Macd_Monthly_Crosses_Below = b.Macd_Monthly_Crosses_Below,
    Macd_Weekly_Crosses_Above = b.Macd_Weekly_Crosses_Above,
    Macd_Weekly_Crosses_Below = b.Macd_Weekly_Crosses_Below,
    Macd_Daily_Crosses_Above = b.Macd_Daily_Crosses_Above,
    Macd_Daily_Crosses_Below = b.Macd_Daily_Crosses_Below,
    Macd_4_Hourly_Crosses_Above = b.Macd_4_Hourly_Crosses_Above,
    Macd_4_Hourly_Crosses_Below = b.Macd_4_Hourly_Crosses_Below,
    Macd_1_Hourly_Crosses_Above = b.Macd_1_Hourly_Crosses_Above,
    Macd_1_Hourly_Crosses_Below = b.Macd_1_Hourly_Crosses_Below,
    Macd_15_Minutes_Crosses_Above = b.Macd_15_Minutes_Crosses_Above,
    Macd_15_Minutes_Crosses_Below = b.Macd_15_Minutes_Crosses_Below
FROM dbo.Analyse_Stocks a
INNER JOIN #MacdIndicators b ON a.Symbol = b.Symbol
WHERE a.Batch_No = @Batch_no;

-- Cleanup
DROP TABLE #MacdIndicators;
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------
select Batch_No, Created_Date, Trading_View, Trading_View_Order, Segments, Segments_Order, Volume_Shockers, Volume_Shockers_Sum, Trade_Type_Details, Trade_Type_Details_Sum, Industry, Stock_Name, Symbol, Percent_Change, Price, Volume, Series, Trade_Type, Trade_Type_Length, Trade_Type_Bullish_Sum, Trade_Type_Bearish_Sum, Trade_Type_Details_Length, Segments_Length, Segments_Sum, price_action, ISIN_Code, Bullish_Triple_Screen_Strong_Monthly, Bullish_Triple_Screen_Strong_Weekly, Bullish_Triple_Screen_Strong_Daily, Bullish_Triple_Screen_Strong_4_Hourly, Bullish_Triple_Screen_Strong_1_Hourly, Bullish_Triple_Screen_Strong_15_Minutes, Bullish_Triple_Screen_Strong_Correction_Monthly, Bullish_Triple_Screen_Strong_Correction_Weekly, Bullish_Triple_Screen_Strong_Correction_Daily, Bullish_Triple_Screen_Strong_Correction_4_Hourly, Bullish_Triple_Screen_Strong_Correction_1_Hourly, Bullish_Triple_Screen_Strong_Correction_15_Minutes, Bullish_Double_Screen_Strong_Quarterly, Bullish_Double_Screen_Strong_Monthly, Bullish_Double_Screen_Strong_Weekly, Bullish_Double_Screen_Strong_Daily, Bullish_Double_Screen_Strong_4_Hourly, Bullish_Double_Screen_Strong_1_Hourly, Bullish_Double_Screen_Strong_15_Minutes, Bullish_Double_Screen_Strong_Correction_Quarterly, Bullish_Double_Screen_Strong_Correction_Monthly, Bullish_Double_Screen_Strong_Correction_Weekly, Bullish_Double_Screen_Strong_Correction_Daily, Bullish_Double_Screen_Strong_Correction_4_Hourly, Bullish_Double_Screen_Strong_Correction_1_Hourly, Bullish_Double_Screen_Strong_Correction_15_Minutes, Bullish_Single_Screen_Yearly, Bullish_Single_Screen_Quarterly, Bullish_Single_Screen_Monthly, Bullish_Single_Screen_Weekly, Bullish_Single_Screen_Daily, Bullish_Single_Screen_4_Hourly, Bullish_Single_Screen_1_Hourly, Bullish_Single_Screen_15_Minutes, Bearish_Triple_Screen_Strong_Monthly, Bearish_Triple_Screen_Strong_Weekly, Bearish_Triple_Screen_Strong_Daily, Bearish_Triple_Screen_Strong_4_Hourly, Bearish_Triple_Screen_Strong_1_Hourly, Bearish_Triple_Screen_Strong_15_Minutes, Bearish_Triple_Screen_Strong_Correction_Monthly, Bearish_Triple_Screen_Strong_Correction_Weekly, Bearish_Triple_Screen_Strong_Correction_Daily, Bearish_Triple_Screen_Strong_Correction_4_Hourly, Bearish_Triple_Screen_Strong_Correction_1_Hourly, Bearish_Triple_Screen_Strong_Correction_15_Minutes, Bearish_Double_Screen_Strong_Quarterly, Bearish_Double_Screen_Strong_Monthly, Bearish_Double_Screen_Strong_Weekly, Bearish_Double_Screen_Strong_Daily, Bearish_Double_Screen_Strong_4_Hourly, Bearish_Double_Screen_Strong_1_Hourly, Bearish_Double_Screen_Strong_15_Minutes, Bearish_Double_Screen_Strong_Correction_Quarterly, Bearish_Double_Screen_Strong_Correction_Monthly, Bearish_Double_Screen_Strong_Correction_Weekly, Bearish_Double_Screen_Strong_Correction_Daily, Bearish_Double_Screen_Strong_Correction_4_Hourly, Bearish_Double_Screen_Strong_Correction_1_Hourly, Bearish_Double_Screen_Strong_Correction_15_Minutes, Bearish_Single_Screen_Yearly, Bearish_Single_Screen_Quarterly, Bearish_Single_Screen_Monthly, Bearish_Single_Screen_Weekly, Bearish_Single_Screen_Daily, Bearish_Single_Screen_4_Hourly, Bearish_Single_Screen_1_Hourly, Bearish_Single_Screen_15_Minutes, Macd_Yearly_Crosses_Above, Macd_Yearly_Crosses_Below, Macd_Quarterly_Crosses_Above, Macd_Quarterly_Crosses_Below, Macd_Monthly_Crosses_Above, Macd_Monthly_Crosses_Below, Macd_Weekly_Crosses_Above, Macd_Weekly_Crosses_Below, Macd_Daily_Crosses_Above, Macd_Daily_Crosses_Below, Macd_4_Hourly_Crosses_Above, Macd_4_Hourly_Crosses_Below, Macd_1_Hourly_Crosses_Above, Macd_1_Hourly_Crosses_Below, Macd_15_Minutes_Crosses_Above, Macd_15_Minutes_Crosses_Below, Stochastic_Yearly_Crosses_Above, Stochastic_Yearly_Crosses_Below, Stochastic_Quarterly_Crosses_Above, Stochastic_Quarterly_Crosses_Below, Stochastic_Monthly_Crosses_Above, Stochastic_Monthly_Crosses_Below, Stochastic_Weekly_Crosses_Above, Stochastic_Weekly_Crosses_Below, Stochastic_Daily_Crosses_Above, Stochastic_Daily_Crosses_Below, Stochastic_4_Hourly_Crosses_Above, Stochastic_4_Hourly_Crosses_Below, Stochastic_1_Hourly_Crosses_Above, Stochastic_1_Hourly_Crosses_Below, Stochastic_15_Minutes_Crosses_Above, Stochastic_15_Minutes_Crosses_Below, Ema_5_13_Yearly_Crosses_Above, Ema_5_13_Yearly_Crosses_Below, Ema_5_13_Quarterly_Crosses_Above, Ema_5_13_Quarterly_Crosses_Below, Ema_5_13_Monthly_Crosses_Above, Ema_5_13_Monthly_Crosses_Below, Ema_5_13_Weekly_Crosses_Above, Ema_5_13_Weekly_Crosses_Below, Ema_5_13_Daily_Crosses_Above, Ema_5_13_Daily_Crosses_Below, Ema_5_13_4_Hourly_Crosses_Above, Ema_5_13_4_Hourly_Crosses_Below, Ema_5_13_1_Hourly_Crosses_Above, Ema_5_13_1_Hourly_Crosses_Below, Ema_5_13_15_Minutes_Crosses_Above, Ema_5_13_15_Minutes_Crosses_Below, Ema_13_26_Yearly_Crosses_Above, Ema_13_26_Yearly_Crosses_Below, Ema_13_26_Quarterly_Crosses_Above, Ema_13_26_Quarterly_Crosses_Below, Ema_13_26_Monthly_Crosses_Above, Ema_13_26_Monthly_Crosses_Below, Ema_13_26_Weekly_Crosses_Above, Ema_13_26_Weekly_Crosses_Below, Ema_13_26_Daily_Crosses_Above, Ema_13_26_Daily_Crosses_Below, Ema_13_26_4_Hourly_Crosses_Above, Ema_13_26_4_Hourly_Crosses_Below, Ema_13_26_1_Hourly_Crosses_Above, Ema_13_26_1_Hourly_Crosses_Below, Ema_13_26_15_Minutes_Crosses_Above, Ema_13_26_15_Minutes_Crosses_Below, Ema_50_100_Yearly_Crosses_Above, Ema_50_100_Yearly_Crosses_Below, Ema_50_100_Quarterly_Crosses_Above, Ema_50_100_Quarterly_Crosses_Below, Ema_50_100_Monthly_Crosses_Above, Ema_50_100_Monthly_Crosses_Below, Ema_50_100_Weekly_Crosses_Above, Ema_50_100_Weekly_Crosses_Below, Ema_50_100_Daily_Crosses_Above, Ema_50_100_Daily_Crosses_Below, Ema_50_100_4_Hourly_Crosses_Above, Ema_50_100_4_Hourly_Crosses_Below, Ema_50_100_1_Hourly_Crosses_Above, Ema_50_100_1_Hourly_Crosses_Below, Ema_50_100_15_Minutes_Crosses_Above, Ema_50_100_15_Minutes_Crosses_Below, Ema_100_200_Yearly_Crosses_Above, Ema_100_200_Yearly_Crosses_Below, Ema_100_200_Quarterly_Crosses_Above, Ema_100_200_Quarterly_Crosses_Below, Ema_100_200_Monthly_Crosses_Above, Ema_100_200_Monthly_Crosses_Below, Ema_100_200_Weekly_Crosses_Above, Ema_100_200_Weekly_Crosses_Below, Ema_100_200_Daily_Crosses_Above, Ema_100_200_Daily_Crosses_Below, Ema_100_200_4_Hourly_Crosses_Above, Ema_100_200_4_Hourly_Crosses_Below, Ema_100_200_1_Hourly_Crosses_Above, Ema_100_200_1_Hourly_Crosses_Below, Ema_100_200_15_Minutes_Crosses_Above, Ema_100_200_15_Minutes_Crosses_Below, Adx_Yearly_Crosses_Above, Adx_Yearly_Crosses_Below, Adx_Quarterly_Crosses_Above, Adx_Quarterly_Crosses_Below, Adx_Monthly_Crosses_Above, Adx_Monthly_Crosses_Below, Adx_Weekly_Crosses_Above, Adx_Weekly_Crosses_Below, Adx_Daily_Crosses_Above, Adx_Daily_Crosses_Below, Adx_4_Hourly_Crosses_Above, Adx_4_Hourly_Crosses_Below, Adx_1_Hourly_Crosses_Above, Adx_1_Hourly_Crosses_Below, Adx_15_Minutes_Crosses_Above, Adx_15_Minutes_Crosses_Below, Rsi_Yearly_Crosses_Above, Rsi_Yearly_Crosses_Below, Rsi_Quarterly_Crosses_Above, Rsi_Quarterly_Crosses_Below, Rsi_Monthly_Crosses_Above, Rsi_Monthly_Crosses_Below, Rsi_Weekly_Crosses_Above, Rsi_Weekly_Crosses_Below, Rsi_Daily_Crosses_Above, Rsi_Daily_Crosses_Below, Rsi_4_Hourly_Crosses_Above, Rsi_4_Hourly_Crosses_Below, Rsi_1_Hourly_Crosses_Above, Rsi_1_Hourly_Crosses_Below, Rsi_15_Minutes_Crosses_Above, Rsi_15_Minutes_Crosses_Below, Upper_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band3_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band3_Daily_Less_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band3_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band3_Daily_Less_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band2_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band2_Daily_Less_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band2_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band2_Daily_Less_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Volume_Yearly_Greater_Than_Equal_To, Volume_Yearly_Less_Than_Equal_To, Volume_Quarterly_Greater_Than_Equal_To, Volume_Quarterly_Less_Than_Equal_To, Volume_Monthly_Greater_Than_Equal_To, Volume_Monthly_Less_Than_Equal_To, Volume_Weekly_Greater_Than_Equal_To, Volume_Weekly_Less_Than_Equal_To, Volume_Daily_Greater_Than_Equal_To, Volume_Daily_Less_Than_Equal_To, Volume_4_Hourly_Greater_Than_Equal_To, Volume_4_Hourly_Less_Than_Equal_To, Volume_1_Hourly_Greater_Than_Equal_To, Volume_1_Hourly_Less_Than_Equal_To, Volume_15_Minutes_Greater_Than_Equal_To, Volume_15_Minutes_Less_Than_Equal_To, Adx_Up_Tick_Yearly_Greater_Than_Equal_To, Adx_Down_Tick_Yearly_Less_Than_Equal_To, Adx_Up_Tick_Quarterly_Greater_Than_Equal_To, Adx_Down_Tick_Quarterly_Less_Than_Equal_To, Adx_Up_Tick_Monthly_Greater_Than_Equal_To, Adx_Down_Tick_Monthly_Less_Than_Equal_To, Adx_Up_Tick_Weekly_Greater_Than_Equal_To, Adx_Down_Tick_Weekly_Less_Than_Equal_To, Adx_Up_Tick_Daily_Greater_Than_Equal_To, Adx_Down_Tick_Daily_Less_Than_Equal_To, Adx_Up_Tick_4_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_4_Hourly_Less_Than_Equal_To, Adx_Up_Tick_1_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_1_Hourly_Less_Than_Equal_To, Adx_Up_Tick_15_Minutes_Greater_Than_Equal_To, Adx_Down_Tick_15_Minutes_Less_Than_Equal_To, volume__yearly__shockers, volume__quarterly__shockers, volume__monthly__shockers, volume__weekly__shockers, volume__daily__shockers, volume__4_hourly__shockers, volume__1_hourly__shockers, volume__15_minutes__shockers, Report_Sort_Order
into dbo.Analyse_15Minutes_Stocks_temp
from dbo.Analyse_15Minutes_Stocks

EXEC sp_rename 'dbo.Analyse_15Minutes_Stocks', 'Analyse_15Minutes_Stocks_Old12';

------------------------------------------------------------------------------------------------------------------------------
-- insert into dbo.Analyse_Stocks_New (Batch_No, Created_Date, Symbol, Trading_View, Trading_View_Order, Segments, Segments_Order, Volume_Shockers, Volume_Shockers_Sum, Trade_Type_Details, Trade_Type_Details_Sum, Industry, Stock_Name, Percent_Change, Price, Volume, Series, Trade_Type, Trade_Type_Length, Trade_Type_Bullish_Sum, Trade_Type_Bearish_Sum, Trade_Type_Details_Length, Segments_Length, Segments_Sum, price_action, ISIN_Code, Bullish_Triple_Screen_Strong_Monthly, Bullish_Triple_Screen_Strong_Weekly, Bullish_Triple_Screen_Strong_Daily, Bullish_Triple_Screen_Strong_4_Hourly, Bullish_Triple_Screen_Strong_1_Hourly, Bullish_Triple_Screen_Strong_15_Minutes, Bullish_Triple_Screen_Strong_Correction_Monthly, Bullish_Triple_Screen_Strong_Correction_Weekly, Bullish_Triple_Screen_Strong_Correction_Daily, Bullish_Triple_Screen_Strong_Correction_4_Hourly, Bullish_Triple_Screen_Strong_Correction_1_Hourly, Bullish_Triple_Screen_Strong_Correction_15_Minutes, Bullish_Double_Screen_Strong_Quarterly, Bullish_Double_Screen_Strong_Monthly, Bullish_Double_Screen_Strong_Weekly, Bullish_Double_Screen_Strong_Daily, Bullish_Double_Screen_Strong_4_Hourly, Bullish_Double_Screen_Strong_1_Hourly, Bullish_Double_Screen_Strong_15_Minutes, Bullish_Double_Screen_Strong_Correction_Quarterly, Bullish_Double_Screen_Strong_Correction_Monthly, Bullish_Double_Screen_Strong_Correction_Weekly, Bullish_Double_Screen_Strong_Correction_Daily, Bullish_Double_Screen_Strong_Correction_4_Hourly, Bullish_Double_Screen_Strong_Correction_1_Hourly, Bullish_Double_Screen_Strong_Correction_15_Minutes, Bullish_Single_Screen_Yearly, Bullish_Single_Screen_Quarterly, Bullish_Single_Screen_Monthly, Bullish_Single_Screen_Weekly, Bullish_Single_Screen_Daily, Bullish_Single_Screen_4_Hourly, Bullish_Single_Screen_1_Hourly, Bullish_Single_Screen_15_Minutes, Bearish_Triple_Screen_Strong_Monthly, Bearish_Triple_Screen_Strong_Weekly, Bearish_Triple_Screen_Strong_Daily, Bearish_Triple_Screen_Strong_4_Hourly, Bearish_Triple_Screen_Strong_1_Hourly, Bearish_Triple_Screen_Strong_15_Minutes, Bearish_Triple_Screen_Strong_Correction_Monthly, Bearish_Triple_Screen_Strong_Correction_Weekly, Bearish_Triple_Screen_Strong_Correction_Daily, Bearish_Triple_Screen_Strong_Correction_4_Hourly, Bearish_Triple_Screen_Strong_Correction_1_Hourly, Bearish_Triple_Screen_Strong_Correction_15_Minutes, Bearish_Double_Screen_Strong_Quarterly, Bearish_Double_Screen_Strong_Monthly, Bearish_Double_Screen_Strong_Weekly, Bearish_Double_Screen_Strong_Daily, Bearish_Double_Screen_Strong_4_Hourly, Bearish_Double_Screen_Strong_1_Hourly, Bearish_Double_Screen_Strong_15_Minutes, Bearish_Double_Screen_Strong_Correction_Quarterly, Bearish_Double_Screen_Strong_Correction_Monthly, Bearish_Double_Screen_Strong_Correction_Weekly, Bearish_Double_Screen_Strong_Correction_Daily, Bearish_Double_Screen_Strong_Correction_4_Hourly, Bearish_Double_Screen_Strong_Correction_1_Hourly, Bearish_Double_Screen_Strong_Correction_15_Minutes, Bearish_Single_Screen_Yearly, Bearish_Single_Screen_Quarterly, Bearish_Single_Screen_Monthly, Bearish_Single_Screen_Weekly, Bearish_Single_Screen_Daily, Bearish_Single_Screen_4_Hourly, Bearish_Single_Screen_1_Hourly, Bearish_Single_Screen_15_Minutes, Macd_Yearly_Crosses_Above, Macd_Yearly_Crosses_Below, Macd_Quarterly_Crosses_Above, Macd_Quarterly_Crosses_Below, Macd_Monthly_Crosses_Above, Macd_Monthly_Crosses_Below, Macd_Weekly_Crosses_Above, Macd_Weekly_Crosses_Below, Macd_Daily_Crosses_Above, Macd_Daily_Crosses_Below, Macd_4_Hourly_Crosses_Above, Macd_4_Hourly_Crosses_Below, Macd_1_Hourly_Crosses_Above, Macd_1_Hourly_Crosses_Below, Macd_15_Minutes_Crosses_Above, Macd_15_Minutes_Crosses_Below, Stochastic_Yearly_Crosses_Above, Stochastic_Yearly_Crosses_Below, Stochastic_Quarterly_Crosses_Above, Stochastic_Quarterly_Crosses_Below, Stochastic_Monthly_Crosses_Above, Stochastic_Monthly_Crosses_Below, Stochastic_Weekly_Crosses_Above, Stochastic_Weekly_Crosses_Below, Stochastic_Daily_Crosses_Above, Stochastic_Daily_Crosses_Below, Stochastic_4_Hourly_Crosses_Above, Stochastic_4_Hourly_Crosses_Below, Stochastic_1_Hourly_Crosses_Above, Stochastic_1_Hourly_Crosses_Below, Stochastic_15_Minutes_Crosses_Above, Stochastic_15_Minutes_Crosses_Below, Ema_5_13_Yearly_Crosses_Above, Ema_5_13_Yearly_Crosses_Below, Ema_5_13_Quarterly_Crosses_Above, Ema_5_13_Quarterly_Crosses_Below, Ema_5_13_Monthly_Crosses_Above, Ema_5_13_Monthly_Crosses_Below, Ema_5_13_Weekly_Crosses_Above, Ema_5_13_Weekly_Crosses_Below, Ema_5_13_Daily_Crosses_Above, Ema_5_13_Daily_Crosses_Below, Ema_5_13_4_Hourly_Crosses_Above, Ema_5_13_4_Hourly_Crosses_Below, Ema_5_13_1_Hourly_Crosses_Above, Ema_5_13_1_Hourly_Crosses_Below, Ema_5_13_15_Minutes_Crosses_Above, Ema_5_13_15_Minutes_Crosses_Below, Ema_13_26_Yearly_Crosses_Above, Ema_13_26_Yearly_Crosses_Below, Ema_13_26_Quarterly_Crosses_Above, Ema_13_26_Quarterly_Crosses_Below, Ema_13_26_Monthly_Crosses_Above, Ema_13_26_Monthly_Crosses_Below, Ema_13_26_Weekly_Crosses_Above, Ema_13_26_Weekly_Crosses_Below, Ema_13_26_Daily_Crosses_Above, Ema_13_26_Daily_Crosses_Below, Ema_13_26_4_Hourly_Crosses_Above, Ema_13_26_4_Hourly_Crosses_Below, Ema_13_26_1_Hourly_Crosses_Above, Ema_13_26_1_Hourly_Crosses_Below, Ema_13_26_15_Minutes_Crosses_Above, Ema_13_26_15_Minutes_Crosses_Below, Ema_50_100_Yearly_Crosses_Above, Ema_50_100_Yearly_Crosses_Below, Ema_50_100_Quarterly_Crosses_Above, Ema_50_100_Quarterly_Crosses_Below, Ema_50_100_Monthly_Crosses_Above, Ema_50_100_Monthly_Crosses_Below, Ema_50_100_Weekly_Crosses_Above, Ema_50_100_Weekly_Crosses_Below, Ema_50_100_Daily_Crosses_Above, Ema_50_100_Daily_Crosses_Below, Ema_50_100_4_Hourly_Crosses_Above, Ema_50_100_4_Hourly_Crosses_Below, Ema_50_100_1_Hourly_Crosses_Above, Ema_50_100_1_Hourly_Crosses_Below, Ema_50_100_15_Minutes_Crosses_Above, Ema_50_100_15_Minutes_Crosses_Below, Ema_100_200_Yearly_Crosses_Above, Ema_100_200_Yearly_Crosses_Below, Ema_100_200_Quarterly_Crosses_Above, Ema_100_200_Quarterly_Crosses_Below, Ema_100_200_Monthly_Crosses_Above, Ema_100_200_Monthly_Crosses_Below, Ema_100_200_Weekly_Crosses_Above, Ema_100_200_Weekly_Crosses_Below, Ema_100_200_Daily_Crosses_Above, Ema_100_200_Daily_Crosses_Below, Ema_100_200_4_Hourly_Crosses_Above, Ema_100_200_4_Hourly_Crosses_Below, Ema_100_200_1_Hourly_Crosses_Above, Ema_100_200_1_Hourly_Crosses_Below, Ema_100_200_15_Minutes_Crosses_Above, Ema_100_200_15_Minutes_Crosses_Below, Adx_Yearly_Crosses_Above, Adx_Yearly_Crosses_Below, Adx_Quarterly_Crosses_Above, Adx_Quarterly_Crosses_Below, Adx_Monthly_Crosses_Above, Adx_Monthly_Crosses_Below, Adx_Weekly_Crosses_Above, Adx_Weekly_Crosses_Below, Adx_Daily_Crosses_Above, Adx_Daily_Crosses_Below, Adx_4_Hourly_Crosses_Above, Adx_4_Hourly_Crosses_Below, Adx_1_Hourly_Crosses_Above, Adx_1_Hourly_Crosses_Below, Adx_15_Minutes_Crosses_Above, Adx_15_Minutes_Crosses_Below, Rsi_Yearly_Crosses_Above, Rsi_Yearly_Crosses_Below, Rsi_Quarterly_Crosses_Above, Rsi_Quarterly_Crosses_Below, Rsi_Monthly_Crosses_Above, Rsi_Monthly_Crosses_Below, Rsi_Weekly_Crosses_Above, Rsi_Weekly_Crosses_Below, Rsi_Daily_Crosses_Above, Rsi_Daily_Crosses_Below, Rsi_4_Hourly_Crosses_Above, Rsi_4_Hourly_Crosses_Below, Rsi_1_Hourly_Crosses_Above, Rsi_1_Hourly_Crosses_Below, Rsi_15_Minutes_Crosses_Above, Rsi_15_Minutes_Crosses_Below, Upper_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band3_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band3_Daily_Less_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band3_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band3_Daily_Less_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band2_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band2_Daily_Less_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band2_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band2_Daily_Less_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Volume_Yearly_Greater_Than_Equal_To, Volume_Yearly_Less_Than_Equal_To, Volume_Quarterly_Greater_Than_Equal_To, Volume_Quarterly_Less_Than_Equal_To, Volume_Monthly_Greater_Than_Equal_To, Volume_Monthly_Less_Than_Equal_To, Volume_Weekly_Greater_Than_Equal_To, Volume_Weekly_Less_Than_Equal_To, Volume_Daily_Greater_Than_Equal_To, Volume_Daily_Less_Than_Equal_To, Volume_4_Hourly_Greater_Than_Equal_To, Volume_4_Hourly_Less_Than_Equal_To, Volume_1_Hourly_Greater_Than_Equal_To, Volume_1_Hourly_Less_Than_Equal_To, Volume_15_Minutes_Greater_Than_Equal_To, Volume_15_Minutes_Less_Than_Equal_To, Adx_Up_Tick_Yearly_Greater_Than_Equal_To, Adx_Down_Tick_Yearly_Less_Than_Equal_To, Adx_Up_Tick_Quarterly_Greater_Than_Equal_To, Adx_Down_Tick_Quarterly_Less_Than_Equal_To, Adx_Up_Tick_Monthly_Greater_Than_Equal_To, Adx_Down_Tick_Monthly_Less_Than_Equal_To, Adx_Up_Tick_Weekly_Greater_Than_Equal_To, Adx_Down_Tick_Weekly_Less_Than_Equal_To, Adx_Up_Tick_Daily_Greater_Than_Equal_To, Adx_Down_Tick_Daily_Less_Than_Equal_To, Adx_Up_Tick_4_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_4_Hourly_Less_Than_Equal_To, Adx_Up_Tick_1_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_1_Hourly_Less_Than_Equal_To, Adx_Up_Tick_15_Minutes_Greater_Than_Equal_To, Adx_Down_Tick_15_Minutes_Less_Than_Equal_To, volume__yearly__shockers, volume__quarterly__shockers, volume__monthly__shockers, volume__weekly__shockers, volume__daily__shockers, volume__4_hourly__shockers, volume__1_hourly__shockers, volume__15_minutes__shockers, Report_Sort_Order )
select Batch_No, Created_Date, Symbol, Trading_View, Trading_View_Order, Segments, Segments_Order, Volume_Shockers, Volume_Shockers_Sum, Trade_Type_Details, Trade_Type_Details_Sum, Industry, Stock_Name, Percent_Change, Price, Volume, Series, Trade_Type, Trade_Type_Length, Trade_Type_Bullish_Sum, Trade_Type_Bearish_Sum, Trade_Type_Details_Length, Segments_Length, Segments_Sum, price_action, ISIN_Code, Bullish_Triple_Screen_Strong_Monthly, Bullish_Triple_Screen_Strong_Weekly, Bullish_Triple_Screen_Strong_Daily, Bullish_Triple_Screen_Strong_4_Hourly, Bullish_Triple_Screen_Strong_1_Hourly, Bullish_Triple_Screen_Strong_15_Minutes, Bullish_Triple_Screen_Strong_Correction_Monthly, Bullish_Triple_Screen_Strong_Correction_Weekly, Bullish_Triple_Screen_Strong_Correction_Daily, Bullish_Triple_Screen_Strong_Correction_4_Hourly, Bullish_Triple_Screen_Strong_Correction_1_Hourly, Bullish_Triple_Screen_Strong_Correction_15_Minutes, Bullish_Double_Screen_Strong_Quarterly, Bullish_Double_Screen_Strong_Monthly, Bullish_Double_Screen_Strong_Weekly, Bullish_Double_Screen_Strong_Daily, Bullish_Double_Screen_Strong_4_Hourly, Bullish_Double_Screen_Strong_1_Hourly, Bullish_Double_Screen_Strong_15_Minutes, Bullish_Double_Screen_Strong_Correction_Quarterly, Bullish_Double_Screen_Strong_Correction_Monthly, Bullish_Double_Screen_Strong_Correction_Weekly, Bullish_Double_Screen_Strong_Correction_Daily, Bullish_Double_Screen_Strong_Correction_4_Hourly, Bullish_Double_Screen_Strong_Correction_1_Hourly, Bullish_Double_Screen_Strong_Correction_15_Minutes, Bullish_Single_Screen_Yearly, Bullish_Single_Screen_Quarterly, Bullish_Single_Screen_Monthly, Bullish_Single_Screen_Weekly, Bullish_Single_Screen_Daily, Bullish_Single_Screen_4_Hourly, Bullish_Single_Screen_1_Hourly, Bullish_Single_Screen_15_Minutes, Bearish_Triple_Screen_Strong_Monthly, Bearish_Triple_Screen_Strong_Weekly, Bearish_Triple_Screen_Strong_Daily, Bearish_Triple_Screen_Strong_4_Hourly, Bearish_Triple_Screen_Strong_1_Hourly, Bearish_Triple_Screen_Strong_15_Minutes, Bearish_Triple_Screen_Strong_Correction_Monthly, Bearish_Triple_Screen_Strong_Correction_Weekly, Bearish_Triple_Screen_Strong_Correction_Daily, Bearish_Triple_Screen_Strong_Correction_4_Hourly, Bearish_Triple_Screen_Strong_Correction_1_Hourly, Bearish_Triple_Screen_Strong_Correction_15_Minutes, Bearish_Double_Screen_Strong_Quarterly, Bearish_Double_Screen_Strong_Monthly, Bearish_Double_Screen_Strong_Weekly, Bearish_Double_Screen_Strong_Daily, Bearish_Double_Screen_Strong_4_Hourly, Bearish_Double_Screen_Strong_1_Hourly, Bearish_Double_Screen_Strong_15_Minutes, Bearish_Double_Screen_Strong_Correction_Quarterly, Bearish_Double_Screen_Strong_Correction_Monthly, Bearish_Double_Screen_Strong_Correction_Weekly, Bearish_Double_Screen_Strong_Correction_Daily, Bearish_Double_Screen_Strong_Correction_4_Hourly, Bearish_Double_Screen_Strong_Correction_1_Hourly, Bearish_Double_Screen_Strong_Correction_15_Minutes, Bearish_Single_Screen_Yearly, Bearish_Single_Screen_Quarterly, Bearish_Single_Screen_Monthly, Bearish_Single_Screen_Weekly, Bearish_Single_Screen_Daily, Bearish_Single_Screen_4_Hourly, Bearish_Single_Screen_1_Hourly, Bearish_Single_Screen_15_Minutes, Macd_Yearly_Crosses_Above, Macd_Yearly_Crosses_Below, Macd_Quarterly_Crosses_Above, Macd_Quarterly_Crosses_Below, Macd_Monthly_Crosses_Above, Macd_Monthly_Crosses_Below, Macd_Weekly_Crosses_Above, Macd_Weekly_Crosses_Below, Macd_Daily_Crosses_Above, Macd_Daily_Crosses_Below, Macd_4_Hourly_Crosses_Above, Macd_4_Hourly_Crosses_Below, Macd_1_Hourly_Crosses_Above, Macd_1_Hourly_Crosses_Below, Macd_15_Minutes_Crosses_Above, Macd_15_Minutes_Crosses_Below, Stochastic_Yearly_Crosses_Above, Stochastic_Yearly_Crosses_Below, Stochastic_Quarterly_Crosses_Above, Stochastic_Quarterly_Crosses_Below, Stochastic_Monthly_Crosses_Above, Stochastic_Monthly_Crosses_Below, Stochastic_Weekly_Crosses_Above, Stochastic_Weekly_Crosses_Below, Stochastic_Daily_Crosses_Above, Stochastic_Daily_Crosses_Below, Stochastic_4_Hourly_Crosses_Above, Stochastic_4_Hourly_Crosses_Below, Stochastic_1_Hourly_Crosses_Above, Stochastic_1_Hourly_Crosses_Below, Stochastic_15_Minutes_Crosses_Above, Stochastic_15_Minutes_Crosses_Below, Ema_5_13_Yearly_Crosses_Above, Ema_5_13_Yearly_Crosses_Below, Ema_5_13_Quarterly_Crosses_Above, Ema_5_13_Quarterly_Crosses_Below, Ema_5_13_Monthly_Crosses_Above, Ema_5_13_Monthly_Crosses_Below, Ema_5_13_Weekly_Crosses_Above, Ema_5_13_Weekly_Crosses_Below, Ema_5_13_Daily_Crosses_Above, Ema_5_13_Daily_Crosses_Below, Ema_5_13_4_Hourly_Crosses_Above, Ema_5_13_4_Hourly_Crosses_Below, Ema_5_13_1_Hourly_Crosses_Above, Ema_5_13_1_Hourly_Crosses_Below, Ema_5_13_15_Minutes_Crosses_Above, Ema_5_13_15_Minutes_Crosses_Below, Ema_13_26_Yearly_Crosses_Above, Ema_13_26_Yearly_Crosses_Below, Ema_13_26_Quarterly_Crosses_Above, Ema_13_26_Quarterly_Crosses_Below, Ema_13_26_Monthly_Crosses_Above, Ema_13_26_Monthly_Crosses_Below, Ema_13_26_Weekly_Crosses_Above, Ema_13_26_Weekly_Crosses_Below, Ema_13_26_Daily_Crosses_Above, Ema_13_26_Daily_Crosses_Below, Ema_13_26_4_Hourly_Crosses_Above, Ema_13_26_4_Hourly_Crosses_Below, Ema_13_26_1_Hourly_Crosses_Above, Ema_13_26_1_Hourly_Crosses_Below, Ema_13_26_15_Minutes_Crosses_Above, Ema_13_26_15_Minutes_Crosses_Below, Ema_50_100_Yearly_Crosses_Above, Ema_50_100_Yearly_Crosses_Below, Ema_50_100_Quarterly_Crosses_Above, Ema_50_100_Quarterly_Crosses_Below, Ema_50_100_Monthly_Crosses_Above, Ema_50_100_Monthly_Crosses_Below, Ema_50_100_Weekly_Crosses_Above, Ema_50_100_Weekly_Crosses_Below, Ema_50_100_Daily_Crosses_Above, Ema_50_100_Daily_Crosses_Below, Ema_50_100_4_Hourly_Crosses_Above, Ema_50_100_4_Hourly_Crosses_Below, Ema_50_100_1_Hourly_Crosses_Above, Ema_50_100_1_Hourly_Crosses_Below, Ema_50_100_15_Minutes_Crosses_Above, Ema_50_100_15_Minutes_Crosses_Below, Ema_100_200_Yearly_Crosses_Above, Ema_100_200_Yearly_Crosses_Below, Ema_100_200_Quarterly_Crosses_Above, Ema_100_200_Quarterly_Crosses_Below, Ema_100_200_Monthly_Crosses_Above, Ema_100_200_Monthly_Crosses_Below, Ema_100_200_Weekly_Crosses_Above, Ema_100_200_Weekly_Crosses_Below, Ema_100_200_Daily_Crosses_Above, Ema_100_200_Daily_Crosses_Below, Ema_100_200_4_Hourly_Crosses_Above, Ema_100_200_4_Hourly_Crosses_Below, Ema_100_200_1_Hourly_Crosses_Above, Ema_100_200_1_Hourly_Crosses_Below, Ema_100_200_15_Minutes_Crosses_Above, Ema_100_200_15_Minutes_Crosses_Below, Adx_Yearly_Crosses_Above, Adx_Yearly_Crosses_Below, Adx_Quarterly_Crosses_Above, Adx_Quarterly_Crosses_Below, Adx_Monthly_Crosses_Above, Adx_Monthly_Crosses_Below, Adx_Weekly_Crosses_Above, Adx_Weekly_Crosses_Below, Adx_Daily_Crosses_Above, Adx_Daily_Crosses_Below, Adx_4_Hourly_Crosses_Above, Adx_4_Hourly_Crosses_Below, Adx_1_Hourly_Crosses_Above, Adx_1_Hourly_Crosses_Below, Adx_15_Minutes_Crosses_Above, Adx_15_Minutes_Crosses_Below, Rsi_Yearly_Crosses_Above, Rsi_Yearly_Crosses_Below, Rsi_Quarterly_Crosses_Above, Rsi_Quarterly_Crosses_Below, Rsi_Monthly_Crosses_Above, Rsi_Monthly_Crosses_Below, Rsi_Weekly_Crosses_Above, Rsi_Weekly_Crosses_Below, Rsi_Daily_Crosses_Above, Rsi_Daily_Crosses_Below, Rsi_4_Hourly_Crosses_Above, Rsi_4_Hourly_Crosses_Below, Rsi_1_Hourly_Crosses_Above, Rsi_1_Hourly_Crosses_Below, Rsi_15_Minutes_Crosses_Above, Rsi_15_Minutes_Crosses_Below, Upper_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band3_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band3_Daily_Less_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band3_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band3_Daily_Less_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band2_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band2_Daily_Less_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band2_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band2_Daily_Less_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Volume_Yearly_Greater_Than_Equal_To, Volume_Yearly_Less_Than_Equal_To, Volume_Quarterly_Greater_Than_Equal_To, Volume_Quarterly_Less_Than_Equal_To, Volume_Monthly_Greater_Than_Equal_To, Volume_Monthly_Less_Than_Equal_To, Volume_Weekly_Greater_Than_Equal_To, Volume_Weekly_Less_Than_Equal_To, Volume_Daily_Greater_Than_Equal_To, Volume_Daily_Less_Than_Equal_To, Volume_4_Hourly_Greater_Than_Equal_To, Volume_4_Hourly_Less_Than_Equal_To, Volume_1_Hourly_Greater_Than_Equal_To, Volume_1_Hourly_Less_Than_Equal_To, Volume_15_Minutes_Greater_Than_Equal_To, Volume_15_Minutes_Less_Than_Equal_To, Adx_Up_Tick_Yearly_Greater_Than_Equal_To, Adx_Down_Tick_Yearly_Less_Than_Equal_To, Adx_Up_Tick_Quarterly_Greater_Than_Equal_To, Adx_Down_Tick_Quarterly_Less_Than_Equal_To, Adx_Up_Tick_Monthly_Greater_Than_Equal_To, Adx_Down_Tick_Monthly_Less_Than_Equal_To, Adx_Up_Tick_Weekly_Greater_Than_Equal_To, Adx_Down_Tick_Weekly_Less_Than_Equal_To, Adx_Up_Tick_Daily_Greater_Than_Equal_To, Adx_Down_Tick_Daily_Less_Than_Equal_To, Adx_Up_Tick_4_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_4_Hourly_Less_Than_Equal_To, Adx_Up_Tick_1_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_1_Hourly_Less_Than_Equal_To, Adx_Up_Tick_15_Minutes_Greater_Than_Equal_To, Adx_Down_Tick_15_Minutes_Less_Than_Equal_To, volume__yearly__shockers, volume__quarterly__shockers, volume__monthly__shockers, volume__weekly__shockers, volume__daily__shockers, volume__4_hourly__shockers, volume__1_hourly__shockers, volume__15_minutes__shockers, Report_Sort_Order
from dbo.Analyse_Stocks
order by Batch_No, Created_Date, Report_Sort_Order
;
EXEC sp_rename 'dbo.dbo.Analyse_Stocks_old12', 'Analyse_Stocks_old12';
;
------------------------------------------------------------------------------------------------------------------------------
-- all the query are stored for future use --
use Stocks_Analysis;
------------------------------------------------------------------------------------------------------------------------------
select * from dbo.Analyse_15Minutes_Stocks_v 
order by Trading_View desc,sector_order desc,Trade_Type_Details_Sum desc, Trade_Type_Details_Length desc,Segments_Length desc,Trade_Type_Length desc
;
select * from dbo.Analyse_Stocks_v 
order by Trading_View desc,sector_order desc,Trade_Type_Details_Sum desc, Trade_Type_Details_Length desc,Segments_Length desc,Trade_Type_Length desc
;
------------------------------------------------------------------------------------------------------------------------------
select * from dbo.Analyse_15Minutes_Stocks_v 
order by Trading_View desc,sector_order desc,Trade_Type_Details_Sum desc, Trade_Type_Details_Length desc,Segments_Length desc,Trade_Type_Length desc
;
select * from dbo.Analyse_Stocks_v 
order by Trading_View desc,sector_order desc,Trade_Type_Details_Sum desc, Trade_Type_Details_Length desc,Segments_Length desc,Trade_Type_Length desc
;
------------------------------------------------------------------------------------------------------------------------------
select Batch_No, Trading_View,Trade-Type-Details,segments/*,Trade_Type_Details,Segments*/, Symbol, Percent_Change, Price, Volume
,rn,Stock_Name, Trade_Type_Details_Sum, Trade_Type_Bullish_Sum, Trade_Type_Bearish_Sum, Trade_Type, Trade_Type_Length, Segments_Length, Trade_Type_Details_Length, Created_Date
,sector_order,sector_sum
from (
	select row_number() over(partition by Batch_No, Trading_View,Trade_Type_Details,Stock_Name, Segments, Symbol order by Sno desc) as rn,
	Sno, Batch_No, Trade_Type_Details_Sum, Trade_Type_Bullish_Sum, Trade_Type_Bearish_Sum, Segments_Length, Trading_View, Trade_Type, Trade_Type_Length, replace(Trade_Type_Details,';',';'+char(13)+char(10)) as 'Trade-Type-Details',Trade_Type_Details, Trade_Type_Details_Length, Created_Date, Stock_Name,replace(Segments,';',';' + char(13)+ char(10))as segment, Segments, Symbol, Percent_Change, Price, Volume
	,sector_order,sector_sum
	--from dbo.Analyse_15Minutes_Stocks where Batch_No = (select max(batch_no) from dbo.Analyse_15Minutes_Stocks)
	 from dbo.Analyse_Stocks where Batch_No = (select max(batch_no) from dbo.Analyse_Stocks)	 	
	and Segments_Length > 5 and Trade_Type_Details_Sum > 10 and Segments_Length > 25 and volume >1000
	--and Symbol in ('BSE','ARE&M','AXISBANK','COALINDIA','HAL','IREDA','OLAELEC','RELIANCE','SHREEGANES-X','SWSOLAR','TVSSCS','VBL','NIFTY50-INDEX','DEEPAKNTR','DLF','MUKTAARTS','WEBELSOLAR','COLPAL','REDINGTON','BHARATFORG','MUTHOOTFIN')
) a where rn = 1
order by Trading_View desc, sector_order desc,Trade_Type_Details_Sum desc,volume desc,Trade_Type_Details_Length desc,Segments_Length desc,Trade_Type_Length desc
;
------------------------------------------------------------------------------------------------------------------------------
select Batch_No, Trading_View,Trade_Type_Details,Segments, Symbol, Percent_Change, Price, Volume
,rn,Stock_Name, Trade_Type_Details_Sum, Trade_Type_Bullish_Sum, Trade_Type_Bearish_Sum, Trade_Type, Trade_Type_Length, Segments_Length, Trade_Type_Details_Length, Created_Date
from (
	select row_number() over(partition by Batch_No, Trading_View, Trade_Type_Details,Stock_Name, Segments, Symbol order by Sno desc) as rn,
	Sno, Batch_No, Trade_Type_Details_Sum, Trade_Type_Bullish_Sum, Trade_Type_Bearish_Sum, Segments_Length, Trading_View, Trade_Type, Trade_Type_Length, Trade_Type_Details, Trade_Type_Details_Length, Created_Date, Stock_Name, Segments, Symbol, Percent_Change, Price, Volume
	from 
	dbo.Analyse_Stocks 
	-- dbo.Analyse_15Minutes_Stocks 
	where Batch_No = (select max(batch_no) from dbo.Analyse_15Minutes_Stocks) 
	and Segments_Length > 5 and Trade_Type_Details_Sum > 10 and Segments_Length > 25 and volume >10000
) a where rn = 1
order by Trading_View desc,Trade_Type_Details_Sum desc, Trade_Type_Details_Length desc,Segments_Length desc,Trade_Type_Length desc
;
------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------
select * from dbo.ALL_Stocks;
select * from dbo.Stocks_In_Segments; ;
select * 
from 
(select distinct symbol,STRING_AGG(segment,'; ') as Segments from 
( select distinct symbol,segment from dbo.ALL_Stocks ) a
group by symbol) a
;

select segment,count(1) from dbo.ALL_Stocks group by segment; ;
select distinct symbol from dbo.ALL_Stocks where Segment = 'cash' ;
select distinct symbol from dbo.Cash_Stocks;
select distinct symbol from dbo.Stocks where lower(Segment) = 'cash';
select * from dbo.Stocks_In_Segments;
------------------------------------------------------------------------------------------------------------------------------
--
select * 
--update a set Stock_Name = b.stock_name
from dbo.Stocks_In_Segments a
inner join dbo.Cash_Stocks b
on a.symbol = b.symbol
;
select  distinct b.stock_name,a.*
from dbo.Stocks_In_Segments a
inner join dbo.Cash_Stocks b
on a.symbol = b.symbol
;

select a.*,b.Macd_Yearly_Crosses_Above
from dbo.Stocks_In_Segments a
left join (select symbol, 1 as Macd_Yearly_Crosses_Above from dbo.Cash_Stocks 
where Indicator = 'Macd' and TimeLine = 'Yearly' and Direction = 'Crosses Above'
) b on a.Symbol = b.symbol
;
select a.*,m1.Macd_Yearly_Crosses_Above,m2.Macd_Yearly_Crosses_Below,m3.Macd_Quarterly_Crosses_Above,m4.Macd_Quarterly_Crosses_Above,m5.Macd_Monthly_Crosses_Above,m6.Macd_Monthly_Crosses_Above,m7.Macd_Weekly_Crosses_Above,m8.Macd_Weekly_Crosses_Above,m9.Macd_Daily_Crosses_Above,m10.Macd_Daily_Crosses_Above,m11.Macd_4Hourly_Crosses_Above,m12.Macd_4Hourly_Crosses_Above,m13.Macd_1Hourly_Crosses_Above,m14.Macd_1Hourly_Crosses_Above,m15.Macd_15Minutes_Crosses_Above,m16.Macd_15Minutes_Crosses_Above
from dbo.Stocks_In_Segments a
left join (select symbol, 1 as Macd_Yearly_Crosses_Above from dbo.Cash_Stocks where Indicator = 'Macd' and TimeLine = 'Yearly' and Direction = 'Crosses Above'
) m1 on m1.symbol = a.Symbol
left join (select symbol, 1 as Macd_Yearly_Crosses_Below from dbo.Cash_Stocks where Indicator = 'Macd' and TimeLine = 'Yearly' and Direction = 'Crosses Below'
) m2 on m2.symbol = a.Symbol
left join (select symbol, 1 as Macd_Quarterly_Crosses_Above from dbo.Cash_Stocks where Indicator = 'Macd' and TimeLine = 'Quarterly' and Direction = 'Crosses Above'
) m3 on m3.symbol = a.Symbol
left join (select symbol, 1 as Macd_Quarterly_Crosses_Above from dbo.Cash_Stocks where Indicator = 'Macd' and TimeLine = 'Quarterly' and Direction = 'Crosses Below'
) m4 on m4.symbol = a.Symbol
left join (select symbol, 1 as Macd_Monthly_Crosses_Above from dbo.Cash_Stocks where Indicator = 'Macd' and TimeLine = 'Monthly' and Direction = 'Crosses Above'
) m5 on m5.symbol = a.Symbol
left join (select symbol, 1 as Macd_Monthly_Crosses_Above from dbo.Cash_Stocks where Indicator = 'Macd' and TimeLine = 'Monthly' and Direction = 'Crosses Below'
) m6 on m6.symbol = a.Symbol
left join (select symbol, 1 as Macd_Weekly_Crosses_Above from dbo.Cash_Stocks where Indicator = 'Macd' and TimeLine = 'Weekly' and Direction = 'Crosses Above'
) m7 on m7.symbol = a.Symbol
left join (select symbol, 1 as Macd_Weekly_Crosses_Above from dbo.Cash_Stocks where Indicator = 'Macd' and TimeLine = 'Weekly' and Direction = 'Crosses Below'
) m8 on m8.symbol = a.Symbol
left join (select symbol, 1 as Macd_Daily_Crosses_Above from dbo.Cash_Stocks where Indicator = 'Macd' and TimeLine = 'Daily' and Direction = 'Crosses Above'
) m9 on m9.symbol = a.Symbol
left join (select symbol, 1 as Macd_Daily_Crosses_Above from dbo.Cash_Stocks where Indicator = 'Macd' and TimeLine = 'Daily' and Direction = 'Crosses Below'
) m10 on m10.symbol = a.Symbol
left join (select symbol, 1 as Macd_4Hourly_Crosses_Above from dbo.Cash_Stocks where Indicator = 'Macd' and TimeLine = '4 Hourly' and Direction = 'Crosses Above'
) m11 on m11.symbol = a.Symbol
left join (select symbol, 1 as Macd_4Hourly_Crosses_Above from dbo.Cash_Stocks where Indicator = 'Macd' and TimeLine = '4 Hourly' and Direction = 'Crosses Below'
) m12 on m12.symbol = a.Symbol
left join (select symbol, 1 as Macd_1Hourly_Crosses_Above from dbo.Cash_Stocks where Indicator = 'Macd' and TimeLine = '1 Hourly' and Direction = 'Crosses Above'
) m13 on m13.symbol = a.Symbol
left join (select symbol, 1 as Macd_1Hourly_Crosses_Above from dbo.Cash_Stocks where Indicator = 'Macd' and TimeLine = '1 Hourly' and Direction = 'Crosses Below'
) m14 on m14.symbol = a.Symbol
left join (select symbol, 1 as Macd_15Minutes_Crosses_Above from dbo.Cash_Stocks where Indicator = 'Macd' and TimeLine = '15 Minutes' and Direction = 'Crosses Above'
) m15 on m15.symbol = a.Symbol
left join (select symbol, 1 as Macd_15Minutes_Crosses_Above from dbo.Cash_Stocks where Indicator = 'Macd' and TimeLine = '15 Minutes' and Direction = 'Crosses Below'
) m16 on m16.symbol = a.Symbol
;
select distinct s.symbol,a.indicator,a.timeline,a.direction,b.indicator,b.timeline,b.direction,c.indicator,c.timeline,c.direction,d.indicator,d.timeline,d.direction,e.indicator,e.timeline,e.direction,f.indicator,f.timeline,f.direction
from dbo.Stocks s
left join (select * from dbo.Stocks where indicator = 'MACD' and timeline = 'Monthly' and direction = 'Crosses Above') a on s.symbol = a.symbol
left join (select * from dbo.Stocks where indicator = 'MACD' and timeline = 'Weekly' and direction = 'Crosses Above') b on s.symbol = b.symbol
left join (select * from dbo.Stocks where indicator = 'MACD' and timeline = 'Daily' and direction = 'Crosses Above') c on s.symbol = c.symbol
left join (select * from dbo.Stocks where indicator = 'MACD' and timeline = '4 Hourly' and direction = 'Crosses Above') d on s.symbol = d.symbol
left join (select * from dbo.Stocks where indicator = 'MACD' and timeline = '1 Hourly' and direction = 'Crosses Above') e on s.symbol = e.symbol
left join (select * from dbo.Stocks where indicator = 'MACD' and timeline = '15 Minutes' and direction = 'Crosses Above') f on s.symbol = f.symbol
;

select distinct s.symbol,a.indicator,a.timeline,a.direction,b.indicator,b.timeline,b.direction,c.indicator,c.timeline,c.direction,d.indicator,d.timeline,d.direction,e.indicator,e.timeline,e.direction,f.indicator,f.timeline,f.direction
from dbo.Stocks s
left join (select * from dbo.Stocks where indicator = 'MACD' and timeline = 'Monthly' and direction = 'Crosses Below') a on s.symbol = a.symbol
left join (select * from dbo.Stocks where indicator = 'MACD' and timeline = 'Weekly' and direction = 'Crosses Below') b on s.symbol = b.symbol
left join (select * from dbo.Stocks where indicator = 'MACD' and timeline = 'Daily' and direction = 'Crosses Below') c on s.symbol = c.symbol
left join (select * from dbo.Stocks where indicator = 'MACD' and timeline = '4 Hourly' and direction = 'Crosses Below') d on s.symbol = d.symbol
left join (select * from dbo.Stocks where indicator = 'MACD' and timeline = '1 Hourly' and direction = 'Crosses Below') e on s.symbol = e.symbol
left join (select * from dbo.Stocks where indicator = 'MACD' and timeline = '15 Minutes' and direction = 'Crosses Below') f on s.symbol = f.symbol
;

select distinct symbol,STRING_AGG(segment,', ') from 
( select distinct symbol,segment from dbo.Stocks ) a
group by symbol
;

select distinct a.sno,a.stock_name,a.symbol, a.TimeLine, a.Direction, a.Indicator, a.price, a.Percent_Change, a.volume from dbo.Stocks a where symbol = 'DANGEE'
;
select distinct indicator from dbo.Stocks
/*
Adx Down Tick
Ema 50 100
Adx
Upper Bollinger Band3
Stochastic
Adx Up Tick
Lower Bollinger Band2
Ema 13 26
Ema 5 13
Rsi
Volume
Upper Bollinger Band2
Macd
Ema 100 200
Lower Bollinger Band3
*/

select * from dbo.Analyse_Stocks
where Macd_Monthly_Crosses_Above = 1 and 
Stochastic_Monthly_Crosses_Above = 1 and 
Rsi_Monthly_Crosses_Above = 1 and 
Ema_5_13_Monthly_Crosses_Above = 1 and 
Ema_13_26_Monthly_Crosses_Above = 1 and 
Ema_50_100_Monthly_Crosses_Above = 1 and 
Ema_100_200_Monthly_Crosses_Above = 1 and 
Upper_Bollinger_Band3_Monthly_Greater_Than_Equal_To = 1 and 
Lower_Bollinger_Band3_Monthly_Less_Than_Equal_To = 1 and 
Upper_Bollinger_Band2_Monthly_Greater_Than_Equal_To = 1 and 
Lower_Bollinger_Band2_Monthly_Less_Than_Equal_To = 1 and
Adx_Monthly_Crosses_Above = 1 and 
Adx_Up_Tick_1_Hourly_Greater_Than_Equal_To = 1 and 
Volume_Monthly_Greater_Than_Equal_To = 1
;

select * 
-- update sis set Sno = rn 
from dbo.Stocks_In_Segments sis inner join (
select row_number() over(order by len(segments) desc) as rn, 
len(segments) as maxsegments,* 
from dbo.Stocks_In_Segments
) b
on sis.Symbol = b.Symbol
;
select count(1),Batch_No from dbo.Cash_Stocks
group by Batch_No
order by Batch_No
;
select * from dbo.Cash_Stocks
;
select  Batch_No, Created_Date, Symbol, Segments, Stock_Name, Macd_Yearly_Crosses_Above, Macd_Yearly_Crosses_Below, Macd_Quarterly_Crosses_Above, Macd_Quarterly_Crosses_Below, Macd_Monthly_Crosses_Above, Macd_Monthly_Crosses_Below, Macd_Daily_Crosses_Above, Macd_Daily_Crosses_Below, Macd_Weekly_Crosses_Above, Macd_Weekly_Crosses_Below, Macd_4_Hourly_Crosses_Above, Macd_4_Hourly_Crosses_Below, Macd_1_Hourly_Crosses_Above, Macd_1_Hourly_Crosses_Below, Macd_15_Minutes_Crosses_Above, Macd_15_Minutes_Crosses_Below, Stochastic_Yearly_Crosses_Above, Stochastic_Yearly_Crosses_Below, Stochastic_Quarterly_Crosses_Above, Stochastic_Quarterly_Crosses_Below, Stochastic_Monthly_Crosses_Above, Stochastic_Monthly_Crosses_Below, Stochastic_Daily_Crosses_Above, Stochastic_Daily_Crosses_Below, Stochastic_Weekly_Crosses_Above, Stochastic_Weekly_Crosses_Below, Stochastic_4_Hourly_Crosses_Above, Stochastic_4_Hourly_Crosses_Below, Stochastic_1_Hourly_Crosses_Above, Stochastic_1_Hourly_Crosses_Below, Stochastic_15_Minutes_Crosses_Above, Stochastic_15_Minutes_Crosses_Below, Ema_5_13_Yearly_Crosses_Above, Ema_5_13_Yearly_Crosses_Below, Ema_5_13_Quarterly_Crosses_Above, Ema_5_13_Quarterly_Crosses_Below, Ema_5_13_Monthly_Crosses_Above, Ema_5_13_Monthly_Crosses_Below, Ema_5_13_Daily_Crosses_Above, Ema_5_13_Daily_Crosses_Below, Ema_5_13_Weekly_Crosses_Above, Ema_5_13_Weekly_Crosses_Below, Ema_5_13_4_Hourly_Crosses_Above, Ema_5_13_4_Hourly_Crosses_Below, Ema_5_13_1_Hourly_Crosses_Above, Ema_5_13_1_Hourly_Crosses_Below, Ema_5_13_15_Minutes_Crosses_Above, Ema_5_13_15_Minutes_Crosses_Below, Ema_13_26_Yearly_Crosses_Above, Ema_13_26_Yearly_Crosses_Below, Ema_13_26_Quarterly_Crosses_Above, Ema_13_26_Quarterly_Crosses_Below, Ema_13_26_Monthly_Crosses_Above, Ema_13_26_Monthly_Crosses_Below, Ema_13_26_Daily_Crosses_Above, Ema_13_26_Daily_Crosses_Below, Ema_13_26_Weekly_Crosses_Above, Ema_13_26_Weekly_Crosses_Below, Ema_13_26_4_Hourly_Crosses_Above, Ema_13_26_4_Hourly_Crosses_Below, Ema_13_26_1_Hourly_Crosses_Above, Ema_13_26_1_Hourly_Crosses_Below, Ema_13_26_15_Minutes_Crosses_Above, Ema_13_26_15_Minutes_Crosses_Below, Ema_50_100_Yearly_Crosses_Above, Ema_50_100_Yearly_Crosses_Below, Ema_50_100_Quarterly_Crosses_Above, Ema_50_100_Quarterly_Crosses_Below, Ema_50_100_Monthly_Crosses_Above, Ema_50_100_Monthly_Crosses_Below, Ema_50_100_Daily_Crosses_Above, Ema_50_100_Daily_Crosses_Below, Ema_50_100_Weekly_Crosses_Above, Ema_50_100_Weekly_Crosses_Below, Ema_50_100_4_Hourly_Crosses_Above, Ema_50_100_4_Hourly_Crosses_Below, Ema_50_100_1_Hourly_Crosses_Above, Ema_50_100_1_Hourly_Crosses_Below, Ema_50_100_15_Minutes_Crosses_Above, Ema_50_100_15_Minutes_Crosses_Below, Ema_100_200_Yearly_Crosses_Above, Ema_100_200_Yearly_Crosses_Below, Ema_100_200_Quarterly_Crosses_Above, Ema_100_200_Quarterly_Crosses_Below, Ema_100_200_Monthly_Crosses_Above, Ema_100_200_Monthly_Crosses_Below, Ema_100_200_Daily_Crosses_Above, Ema_100_200_Daily_Crosses_Below, Ema_100_200_Weekly_Crosses_Above, Ema_100_200_Weekly_Crosses_Below, Ema_100_200_4_Hourly_Crosses_Above, Ema_100_200_4_Hourly_Crosses_Below, Ema_100_200_1_Hourly_Crosses_Above, Ema_100_200_1_Hourly_Crosses_Below, Ema_100_200_15_Minutes_Crosses_Above, Ema_100_200_15_Minutes_Crosses_Below, Adx_Yearly_Crosses_Above, Adx_Yearly_Crosses_Below, Adx_Quarterly_Crosses_Above, Adx_Quarterly_Crosses_Below, Adx_Monthly_Crosses_Above, Adx_Monthly_Crosses_Below, Adx_Daily_Crosses_Above, Adx_Daily_Crosses_Below, Adx_Weekly_Crosses_Above, Adx_Weekly_Crosses_Below, Adx_4_Hourly_Crosses_Above, Adx_4_Hourly_Crosses_Below, Adx_1_Hourly_Crosses_Above, Adx_1_Hourly_Crosses_Below, Adx_15_Minutes_Crosses_Above, Adx_15_Minutes_Crosses_Below, Rsi_Yearly_Crosses_Above, Rsi_Yearly_Crosses_Below, Rsi_Quarterly_Crosses_Above, Rsi_Quarterly_Crosses_Below, Rsi_Monthly_Crosses_Above, Rsi_Monthly_Crosses_Below, Rsi_Daily_Crosses_Above, Rsi_Daily_Crosses_Below, Rsi_Weekly_Crosses_Above, Rsi_Weekly_Crosses_Below, Rsi_4_Hourly_Crosses_Above, Rsi_4_Hourly_Crosses_Below, Rsi_1_Hourly_Crosses_Above, Rsi_1_Hourly_Crosses_Below, Rsi_15_Minutes_Crosses_Above, Rsi_15_Minutes_Crosses_Below, Upper_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band3_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band3_Daily_Less_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band3_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band3_Daily_Less_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band2_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band2_Daily_Less_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band2_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band2_Daily_Less_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Volume_Yearly_Greater_Than_Equal_To, Volume_Yearly_Less_Than_Equal_To, Volume_Quarterly_Greater_Than_Equal_To, Volume_Quarterly_Less_Than_Equal_To, Volume_Monthly_Greater_Than_Equal_To, Volume_Monthly_Less_Than_Equal_To, Volume_Daily_Greater_Than_Equal_To, Volume_Daily_Less_Than_Equal_To, Volume_Weekly_Greater_Than_Equal_To, Volume_Weekly_Less_Than_Equal_To, Volume_4_Hourly_Greater_Than_Equal_To, Volume_4_Hourly_Less_Than_Equal_To, Volume_1_Hourly_Greater_Than_Equal_To, Volume_1_Hourly_Less_Than_Equal_To, Volume_15_Minutes_Greater_Than_Equal_To, Volume_15_Minutes_Less_Than_Equal_To, Adx_Up_Tick_Yearly_Greater_Than_Equal_To, Adx_Down_Tick_Yearly_Less_Than_Equal_To, Adx_Up_Tick_Quarterly_Greater_Than_Equal_To, Adx_Down_Tick_Quarterly_Less_Than_Equal_To, Adx_Up_Tick_Monthly_Greater_Than_Equal_To, Adx_Down_Tick_Monthly_Less_Than_Equal_To, Adx_Up_Tick_Daily_Greater_Than_Equal_To, Adx_Down_Tick_Daily_Less_Than_Equal_To, Adx_Up_Tick_Weekly_Greater_Than_Equal_To, Adx_Down_Tick_Weekly_Less_Than_Equal_To, Adx_Up_Tick_4_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_4_Hourly_Less_Than_Equal_To, Adx_Up_Tick_1_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_1_Hourly_Less_Than_Equal_To, Adx_Up_Tick_15_Minutes_Greater_Than_Equal_To, Adx_Down_Tick_15_Minutes_Less_Than_Equal_To
from Analyse_Stocks
;

select	distinct isnull(cs.Batch_No+1,1),SYSDATETIME(),a.Symbol,a.Segments,a.Stock_Name
,cs.Percent_Change,cs.price,cs.volume
from dbo.Stocks_In_Segments a 
join dbo.Cash_Stocks cs on a.Symbol = cs.symbol
where cs.Batch_No = (select max(batch_no) from dbo.Cash_Stocks)
;
select * from dbo.Analyse_Stocks order by Batch_No desc
;
select distinct cs.symbol, ss.Symbol 
from dbo.Cash_Stocks cs
left join Stocks_In_Segments ss on cs.symbol = ss.Symbol
where Batch_No = 8 and ss.Symbol is null
;
select distinct symbol from Stocks_In_Segments
;
select distinct symbol from dbo.Cash_Stocks where Indicator = 'all'
order by Batch_No desc
;
------------------------
select * 
--update a set a.Bearish_Quarterly = 1 
from dbo.Analyse_Stocks a
where 1=1 and Batch_No = (select MAX(Batch_No) from dbo.Analyse_Stocks)
and Macd_Yearly_Crosses_Below = 1 and Macd_Quarterly_Crosses_Below = 1 and Macd_Quarterly_Crosses_Below = 1
and Rsi_Quarterly_Crosses_Below = 1 and Adx_Quarterly_Crosses_Below = 1 and Stochastic_Quarterly_Crosses_Below = 1
and Ema_5_13_Quarterly_Crosses_Below = 1 and Ema_13_26_Quarterly_Crosses_Below = 1
and Ema_50_100_Quarterly_Crosses_Below = 1 and Ema_100_200_Quarterly_Crosses_Below = 1
;
select * 
--update a set a.Bearish_Monthly = 1 
from dbo.Analyse_Stocks a
where 1=1 and Batch_No = (select MAX(Batch_No) from dbo.Analyse_Stocks)
and Macd_Monthly_Crosses_Below = 1 and Macd_Monthly_Crosses_Below = 1 and Macd_Monthly_Crosses_Below = 1
and Rsi_Monthly_Crosses_Below = 1 and Adx_Monthly_Crosses_Below = 1 and Stochastic_Monthly_Crosses_Below = 1
and Ema_5_13_Monthly_Crosses_Below = 1 and Ema_13_26_Monthly_Crosses_Below = 1
and Ema_50_100_Monthly_Crosses_Below = 1 and Ema_100_200_Monthly_Crosses_Below = 1
;








select *
--update a set a.Bulish_Weekly = 1 
from dbo.Analyse_Stocks a
where 1=1 and Batch_No = (select MAX(Batch_No) from dbo.Analyse_Stocks)
and Macd_Monthly_Crosses_Below = 1 and Macd_Weekly_Crosses_Below = 1 and Macd_Weekly_Crosses_Below = 1
and Rsi_Weekly_Crosses_Below = 1 and Adx_Weekly_Crosses_Below = 1 and Stochastic_Weekly_Crosses_Below = 1
and Ema_5_13_Weekly_Crosses_Below = 1 and Ema_13_26_Weekly_Crosses_Below = 1
and Ema_50_100_Weekly_Crosses_Below = 1 and Ema_100_200_Weekly_Crosses_Below = 1
;
select *
-- update a set a.Bearish_Daily = 1 
from dbo.Analyse_Stocks a
where 1=1 and Batch_No = (select MAX(Batch_No) from dbo.Analyse_Stocks)
and Macd_Monthly_Crosses_Below = 1 and Macd_Weekly_Crosses_Below = 1 and Macd_Daily_Crosses_Below = 1
and Rsi_Daily_Crosses_Below = 1 and Adx_Daily_Crosses_Below = 1 and Stochastic_Daily_Crosses_Below = 1
and Ema_5_13_Daily_Crosses_Below = 1 and Ema_13_26_Daily_Crosses_Below = 1
and Ema_50_100_Daily_Crosses_Below = 1 and Ema_100_200_Daily_Crosses_Below = 1
;
-- slightely bullish stocks on daily timeframe
-- side ways trending stocks on daily timeframe
----------------------------------
--insert into dbo.Analyse_Stocks(Batch_No, Created_Date, Stock_Name, Segments, Symbol, Percent_Change, price, volume, Macd_Yearly_Crosses_Above, Macd_Yearly_Crosses_Below, Macd_Quarterly_Crosses_Above, Macd_Quarterly_Crosses_Below, Macd_Monthly_Crosses_Above, Macd_Monthly_Crosses_Below, Macd_Weekly_Crosses_Above, Macd_Weekly_Crosses_Below, Macd_Daily_Crosses_Above, Macd_Daily_Crosses_Below, Macd_4_Hourly_Crosses_Above, Macd_4_Hourly_Crosses_Below, Macd_1_Hourly_Crosses_Above, Macd_1_Hourly_Crosses_Below, Macd_15_Minutes_Crosses_Above, Macd_15_Minutes_Crosses_Below, Stochastic_Yearly_Crosses_Above, Stochastic_Yearly_Crosses_Below, Stochastic_Quarterly_Crosses_Above, Stochastic_Quarterly_Crosses_Below, Stochastic_Monthly_Crosses_Above, Stochastic_Monthly_Crosses_Below, Stochastic_Weekly_Crosses_Above, Stochastic_Weekly_Crosses_Below, Stochastic_Daily_Crosses_Above, Stochastic_Daily_Crosses_Below, Stochastic_4_Hourly_Crosses_Above, Stochastic_4_Hourly_Crosses_Below, Stochastic_1_Hourly_Crosses_Above, Stochastic_1_Hourly_Crosses_Below, Stochastic_15_Minutes_Crosses_Above, Stochastic_15_Minutes_Crosses_Below, Ema_5_13_Yearly_Crosses_Above, Ema_5_13_Yearly_Crosses_Below, Ema_5_13_Quarterly_Crosses_Above, Ema_5_13_Quarterly_Crosses_Below, Ema_5_13_Monthly_Crosses_Above, Ema_5_13_Monthly_Crosses_Below, Ema_5_13_Weekly_Crosses_Above, Ema_5_13_Weekly_Crosses_Below, Ema_5_13_Daily_Crosses_Above, Ema_5_13_Daily_Crosses_Below, Ema_5_13_4_Hourly_Crosses_Above, Ema_5_13_4_Hourly_Crosses_Below, Ema_5_13_1_Hourly_Crosses_Above, Ema_5_13_1_Hourly_Crosses_Below, Ema_5_13_15_Minutes_Crosses_Above, Ema_5_13_15_Minutes_Crosses_Below, Ema_13_26_Yearly_Crosses_Above, Ema_13_26_Yearly_Crosses_Below, Ema_13_26_Quarterly_Crosses_Above, Ema_13_26_Quarterly_Crosses_Below, Ema_13_26_Monthly_Crosses_Above, Ema_13_26_Monthly_Crosses_Below, Ema_13_26_Weekly_Crosses_Above, Ema_13_26_Weekly_Crosses_Below, Ema_13_26_Daily_Crosses_Above, Ema_13_26_Daily_Crosses_Below, Ema_13_26_4_Hourly_Crosses_Above, Ema_13_26_4_Hourly_Crosses_Below, Ema_13_26_1_Hourly_Crosses_Above, Ema_13_26_1_Hourly_Crosses_Below, Ema_13_26_15_Minutes_Crosses_Above, Ema_13_26_15_Minutes_Crosses_Below, Ema_50_100_Yearly_Crosses_Above, Ema_50_100_Yearly_Crosses_Below, Ema_50_100_Quarterly_Crosses_Above, Ema_50_100_Quarterly_Crosses_Below, Ema_50_100_Monthly_Crosses_Above, Ema_50_100_Monthly_Crosses_Below, Ema_50_100_Weekly_Crosses_Above, Ema_50_100_Weekly_Crosses_Below, Ema_50_100_Daily_Crosses_Above, Ema_50_100_Daily_Crosses_Below, Ema_50_100_4_Hourly_Crosses_Above, Ema_50_100_4_Hourly_Crosses_Below, Ema_50_100_1_Hourly_Crosses_Above, Ema_50_100_1_Hourly_Crosses_Below, Ema_50_100_15_Minutes_Crosses_Above, Ema_50_100_15_Minutes_Crosses_Below, Ema_100_200_Yearly_Crosses_Above, Ema_100_200_Yearly_Crosses_Below, Ema_100_200_Quarterly_Crosses_Above, Ema_100_200_Quarterly_Crosses_Below, Ema_100_200_Monthly_Crosses_Above, Ema_100_200_Monthly_Crosses_Below, Ema_100_200_Weekly_Crosses_Above, Ema_100_200_Weekly_Crosses_Below, Ema_100_200_Daily_Crosses_Above, Ema_100_200_Daily_Crosses_Below, Ema_100_200_4_Hourly_Crosses_Above, Ema_100_200_4_Hourly_Crosses_Below, Ema_100_200_1_Hourly_Crosses_Above, Ema_100_200_1_Hourly_Crosses_Below, Ema_100_200_15_Minutes_Crosses_Above, Ema_100_200_15_Minutes_Crosses_Below, Adx_Yearly_Crosses_Above, Adx_Yearly_Crosses_Below, Adx_Quarterly_Crosses_Above, Adx_Quarterly_Crosses_Below, Adx_Monthly_Crosses_Above, Adx_Monthly_Crosses_Below, Adx_Weekly_Crosses_Above, Adx_Weekly_Crosses_Below, Adx_Daily_Crosses_Above, Adx_Daily_Crosses_Below, Adx_4_Hourly_Crosses_Above, Adx_4_Hourly_Crosses_Below, Adx_1_Hourly_Crosses_Above, Adx_1_Hourly_Crosses_Below, Adx_15_Minutes_Crosses_Above, Adx_15_Minutes_Crosses_Below, Rsi_Yearly_Crosses_Above, Rsi_Yearly_Crosses_Below, Rsi_Quarterly_Crosses_Above, Rsi_Quarterly_Crosses_Below, Rsi_Monthly_Crosses_Above, Rsi_Monthly_Crosses_Below, Rsi_Weekly_Crosses_Above, Rsi_Weekly_Crosses_Below, Rsi_Daily_Crosses_Above, Rsi_Daily_Crosses_Below, Rsi_4_Hourly_Crosses_Above, Rsi_4_Hourly_Crosses_Below, Rsi_1_Hourly_Crosses_Above, Rsi_1_Hourly_Crosses_Below, Rsi_15_Minutes_Crosses_Above, Rsi_15_Minutes_Crosses_Below, Upper_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band3_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band3_Daily_Less_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band3_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band3_Daily_Less_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band2_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band2_Daily_Less_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band2_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band2_Daily_Less_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Volume_Yearly_Greater_Than_Equal_To, Volume_Yearly_Less_Than_Equal_To, Volume_Quarterly_Greater_Than_Equal_To, Volume_Quarterly_Less_Than_Equal_To, Volume_Monthly_Greater_Than_Equal_To, Volume_Monthly_Less_Than_Equal_To, Volume_Weekly_Greater_Than_Equal_To, Volume_Weekly_Less_Than_Equal_To, Volume_Daily_Greater_Than_Equal_To, Volume_Daily_Less_Than_Equal_To, Volume_4_Hourly_Greater_Than_Equal_To, Volume_4_Hourly_Less_Than_Equal_To, Volume_1_Hourly_Greater_Than_Equal_To, Volume_1_Hourly_Less_Than_Equal_To, Volume_15_Minutes_Greater_Than_Equal_To, Volume_15_Minutes_Less_Than_Equal_To, Adx_Up_Tick_Yearly_Greater_Than_Equal_To, Adx_Down_Tick_Yearly_Less_Than_Equal_To, Adx_Up_Tick_Quarterly_Greater_Than_Equal_To, Adx_Down_Tick_Quarterly_Less_Than_Equal_To, Adx_Up_Tick_Monthly_Greater_Than_Equal_To, Adx_Down_Tick_Monthly_Less_Than_Equal_To, Adx_Up_Tick_Weekly_Greater_Than_Equal_To, Adx_Down_Tick_Weekly_Less_Than_Equal_To, Adx_Up_Tick_Daily_Greater_Than_Equal_To, Adx_Down_Tick_Daily_Less_Than_Equal_To, Adx_Up_Tick_4_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_4_Hourly_Less_Than_Equal_To, Adx_Up_Tick_1_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_1_Hourly_Less_Than_Equal_To, Adx_Up_Tick_15_Minutes_Greater_Than_Equal_To, Adx_Down_Tick_15_Minutes_Less_Than_Equal_To)
--select Batch_No, Created_Date, Stock_Name, Segments, Symbol, Percent_Change, price, volume, Macd_Yearly_Crosses_Above, Macd_Yearly_Crosses_Below, Macd_Quarterly_Crosses_Above, Macd_Quarterly_Crosses_Below, Macd_Monthly_Crosses_Above, Macd_Monthly_Crosses_Below, Macd_Weekly_Crosses_Above, Macd_Weekly_Crosses_Below, Macd_Daily_Crosses_Above, Macd_Daily_Crosses_Below, Macd_4_Hourly_Crosses_Above, Macd_4_Hourly_Crosses_Below, Macd_1_Hourly_Crosses_Above, Macd_1_Hourly_Crosses_Below, Macd_15_Minutes_Crosses_Above, Macd_15_Minutes_Crosses_Below, Stochastic_Yearly_Crosses_Above, Stochastic_Yearly_Crosses_Below, Stochastic_Quarterly_Crosses_Above, Stochastic_Quarterly_Crosses_Below, Stochastic_Monthly_Crosses_Above, Stochastic_Monthly_Crosses_Below, Stochastic_Weekly_Crosses_Above, Stochastic_Weekly_Crosses_Below, Stochastic_Daily_Crosses_Above, Stochastic_Daily_Crosses_Below, Stochastic_4_Hourly_Crosses_Above, Stochastic_4_Hourly_Crosses_Below, Stochastic_1_Hourly_Crosses_Above, Stochastic_1_Hourly_Crosses_Below, Stochastic_15_Minutes_Crosses_Above, Stochastic_15_Minutes_Crosses_Below, Ema_5_13_Yearly_Crosses_Above, Ema_5_13_Yearly_Crosses_Below, Ema_5_13_Quarterly_Crosses_Above, Ema_5_13_Quarterly_Crosses_Below, Ema_5_13_Monthly_Crosses_Above, Ema_5_13_Monthly_Crosses_Below, Ema_5_13_Weekly_Crosses_Above, Ema_5_13_Weekly_Crosses_Below, Ema_5_13_Daily_Crosses_Above, Ema_5_13_Daily_Crosses_Below, Ema_5_13_4_Hourly_Crosses_Above, Ema_5_13_4_Hourly_Crosses_Below, Ema_5_13_1_Hourly_Crosses_Above, Ema_5_13_1_Hourly_Crosses_Below, Ema_5_13_15_Minutes_Crosses_Above, Ema_5_13_15_Minutes_Crosses_Below, Ema_13_26_Yearly_Crosses_Above, Ema_13_26_Yearly_Crosses_Below, Ema_13_26_Quarterly_Crosses_Above, Ema_13_26_Quarterly_Crosses_Below, Ema_13_26_Monthly_Crosses_Above, Ema_13_26_Monthly_Crosses_Below, Ema_13_26_Weekly_Crosses_Above, Ema_13_26_Weekly_Crosses_Below, Ema_13_26_Daily_Crosses_Above, Ema_13_26_Daily_Crosses_Below, Ema_13_26_4_Hourly_Crosses_Above, Ema_13_26_4_Hourly_Crosses_Below, Ema_13_26_1_Hourly_Crosses_Above, Ema_13_26_1_Hourly_Crosses_Below, Ema_13_26_15_Minutes_Crosses_Above, Ema_13_26_15_Minutes_Crosses_Below, Ema_50_100_Yearly_Crosses_Above, Ema_50_100_Yearly_Crosses_Below, Ema_50_100_Quarterly_Crosses_Above, Ema_50_100_Quarterly_Crosses_Below, Ema_50_100_Monthly_Crosses_Above, Ema_50_100_Monthly_Crosses_Below, Ema_50_100_Weekly_Crosses_Above, Ema_50_100_Weekly_Crosses_Below, Ema_50_100_Daily_Crosses_Above, Ema_50_100_Daily_Crosses_Below, Ema_50_100_4_Hourly_Crosses_Above, Ema_50_100_4_Hourly_Crosses_Below, Ema_50_100_1_Hourly_Crosses_Above, Ema_50_100_1_Hourly_Crosses_Below, Ema_50_100_15_Minutes_Crosses_Above, Ema_50_100_15_Minutes_Crosses_Below, Ema_100_200_Yearly_Crosses_Above, Ema_100_200_Yearly_Crosses_Below, Ema_100_200_Quarterly_Crosses_Above, Ema_100_200_Quarterly_Crosses_Below, Ema_100_200_Monthly_Crosses_Above, Ema_100_200_Monthly_Crosses_Below, Ema_100_200_Weekly_Crosses_Above, Ema_100_200_Weekly_Crosses_Below, Ema_100_200_Daily_Crosses_Above, Ema_100_200_Daily_Crosses_Below, Ema_100_200_4_Hourly_Crosses_Above, Ema_100_200_4_Hourly_Crosses_Below, Ema_100_200_1_Hourly_Crosses_Above, Ema_100_200_1_Hourly_Crosses_Below, Ema_100_200_15_Minutes_Crosses_Above, Ema_100_200_15_Minutes_Crosses_Below, Adx_Yearly_Crosses_Above, Adx_Yearly_Crosses_Below, Adx_Quarterly_Crosses_Above, Adx_Quarterly_Crosses_Below, Adx_Monthly_Crosses_Above, Adx_Monthly_Crosses_Below, Adx_Weekly_Crosses_Above, Adx_Weekly_Crosses_Below, Adx_Daily_Crosses_Above, Adx_Daily_Crosses_Below, Adx_4_Hourly_Crosses_Above, Adx_4_Hourly_Crosses_Below, Adx_1_Hourly_Crosses_Above, Adx_1_Hourly_Crosses_Below, Adx_15_Minutes_Crosses_Above, Adx_15_Minutes_Crosses_Below, Rsi_Yearly_Crosses_Above, Rsi_Yearly_Crosses_Below, Rsi_Quarterly_Crosses_Above, Rsi_Quarterly_Crosses_Below, Rsi_Monthly_Crosses_Above, Rsi_Monthly_Crosses_Below, Rsi_Weekly_Crosses_Above, Rsi_Weekly_Crosses_Below, Rsi_Daily_Crosses_Above, Rsi_Daily_Crosses_Below, Rsi_4_Hourly_Crosses_Above, Rsi_4_Hourly_Crosses_Below, Rsi_1_Hourly_Crosses_Above, Rsi_1_Hourly_Crosses_Below, Rsi_15_Minutes_Crosses_Above, Rsi_15_Minutes_Crosses_Below, Upper_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band3_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band3_Daily_Less_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band3_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band3_Daily_Less_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band2_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band2_Daily_Less_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band2_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band2_Daily_Less_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Volume_Yearly_Greater_Than_Equal_To, Volume_Yearly_Less_Than_Equal_To, Volume_Quarterly_Greater_Than_Equal_To, Volume_Quarterly_Less_Than_Equal_To, Volume_Monthly_Greater_Than_Equal_To, Volume_Monthly_Less_Than_Equal_To, Volume_Weekly_Greater_Than_Equal_To, Volume_Weekly_Less_Than_Equal_To, Volume_Daily_Greater_Than_Equal_To, Volume_Daily_Less_Than_Equal_To, Volume_4_Hourly_Greater_Than_Equal_To, Volume_4_Hourly_Less_Than_Equal_To, Volume_1_Hourly_Greater_Than_Equal_To, Volume_1_Hourly_Less_Than_Equal_To, Volume_15_Minutes_Greater_Than_Equal_To, Volume_15_Minutes_Less_Than_Equal_To, Adx_Up_Tick_Yearly_Greater_Than_Equal_To, Adx_Down_Tick_Yearly_Less_Than_Equal_To, Adx_Up_Tick_Quarterly_Greater_Than_Equal_To, Adx_Down_Tick_Quarterly_Less_Than_Equal_To, Adx_Up_Tick_Monthly_Greater_Than_Equal_To, Adx_Down_Tick_Monthly_Less_Than_Equal_To, Adx_Up_Tick_Weekly_Greater_Than_Equal_To, Adx_Down_Tick_Weekly_Less_Than_Equal_To, Adx_Up_Tick_Daily_Greater_Than_Equal_To, Adx_Down_Tick_Daily_Less_Than_Equal_To, Adx_Up_Tick_4_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_4_Hourly_Less_Than_Equal_To, Adx_Up_Tick_1_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_1_Hourly_Less_Than_Equal_To, Adx_Up_Tick_15_Minutes_Greater_Than_Equal_To, Adx_Down_Tick_15_Minutes_Less_Than_Equal_To
--from dbo.Analyse_Stocks_1

insert into dbo.Analyse_Stocks(Batch_No, Created_Date, Stock_Name, Segments, Symbol, Percent_Change, price, volume, Macd_Yearly_Crosses_Above, Macd_Yearly_Crosses_Below, Macd_Quarterly_Crosses_Above, Macd_Quarterly_Crosses_Below, Macd_Monthly_Crosses_Above, Macd_Monthly_Crosses_Below, Macd_Weekly_Crosses_Above, Macd_Weekly_Crosses_Below, Macd_Daily_Crosses_Above, Macd_Daily_Crosses_Below, Macd_4_Hourly_Crosses_Above, Macd_4_Hourly_Crosses_Below, Macd_1_Hourly_Crosses_Above, Macd_1_Hourly_Crosses_Below, Macd_15_Minutes_Crosses_Above, Macd_15_Minutes_Crosses_Below, Stochastic_Yearly_Crosses_Above, Stochastic_Yearly_Crosses_Below, Stochastic_Quarterly_Crosses_Above, Stochastic_Quarterly_Crosses_Below, Stochastic_Monthly_Crosses_Above, Stochastic_Monthly_Crosses_Below, Stochastic_Weekly_Crosses_Above, Stochastic_Weekly_Crosses_Below, Stochastic_Daily_Crosses_Above, Stochastic_Daily_Crosses_Below, Stochastic_4_Hourly_Crosses_Above, Stochastic_4_Hourly_Crosses_Below, Stochastic_1_Hourly_Crosses_Above, Stochastic_1_Hourly_Crosses_Below, Stochastic_15_Minutes_Crosses_Above, Stochastic_15_Minutes_Crosses_Below, Ema_5_13_Yearly_Crosses_Above, Ema_5_13_Yearly_Crosses_Below, Ema_5_13_Quarterly_Crosses_Above, Ema_5_13_Quarterly_Crosses_Below, Ema_5_13_Monthly_Crosses_Above, Ema_5_13_Monthly_Crosses_Below, Ema_5_13_Weekly_Crosses_Above, Ema_5_13_Weekly_Crosses_Below, Ema_5_13_Daily_Crosses_Above, Ema_5_13_Daily_Crosses_Below, Ema_5_13_4_Hourly_Crosses_Above, Ema_5_13_4_Hourly_Crosses_Below, Ema_5_13_1_Hourly_Crosses_Above, Ema_5_13_1_Hourly_Crosses_Below, Ema_5_13_15_Minutes_Crosses_Above, Ema_5_13_15_Minutes_Crosses_Below, Ema_13_26_Yearly_Crosses_Above, Ema_13_26_Yearly_Crosses_Below, Ema_13_26_Quarterly_Crosses_Above, Ema_13_26_Quarterly_Crosses_Below, Ema_13_26_Monthly_Crosses_Above, Ema_13_26_Monthly_Crosses_Below, Ema_13_26_Weekly_Crosses_Above, Ema_13_26_Weekly_Crosses_Below, Ema_13_26_Daily_Crosses_Above, Ema_13_26_Daily_Crosses_Below, Ema_13_26_4_Hourly_Crosses_Above, Ema_13_26_4_Hourly_Crosses_Below, Ema_13_26_1_Hourly_Crosses_Above, Ema_13_26_1_Hourly_Crosses_Below, Ema_13_26_15_Minutes_Crosses_Above, Ema_13_26_15_Minutes_Crosses_Below, Ema_50_100_Yearly_Crosses_Above, Ema_50_100_Yearly_Crosses_Below, Ema_50_100_Quarterly_Crosses_Above, Ema_50_100_Quarterly_Crosses_Below, Ema_50_100_Monthly_Crosses_Above, Ema_50_100_Monthly_Crosses_Below, Ema_50_100_Weekly_Crosses_Above, Ema_50_100_Weekly_Crosses_Below, Ema_50_100_Daily_Crosses_Above, Ema_50_100_Daily_Crosses_Below, Ema_50_100_4_Hourly_Crosses_Above, Ema_50_100_4_Hourly_Crosses_Below, Ema_50_100_1_Hourly_Crosses_Above, Ema_50_100_1_Hourly_Crosses_Below, Ema_50_100_15_Minutes_Crosses_Above, Ema_50_100_15_Minutes_Crosses_Below, Ema_100_200_Yearly_Crosses_Above, Ema_100_200_Yearly_Crosses_Below, Ema_100_200_Quarterly_Crosses_Above, Ema_100_200_Quarterly_Crosses_Below, Ema_100_200_Monthly_Crosses_Above, Ema_100_200_Monthly_Crosses_Below, Ema_100_200_Weekly_Crosses_Above, Ema_100_200_Weekly_Crosses_Below, Ema_100_200_Daily_Crosses_Above, Ema_100_200_Daily_Crosses_Below, Ema_100_200_4_Hourly_Crosses_Above, Ema_100_200_4_Hourly_Crosses_Below, Ema_100_200_1_Hourly_Crosses_Above, Ema_100_200_1_Hourly_Crosses_Below, Ema_100_200_15_Minutes_Crosses_Above, Ema_100_200_15_Minutes_Crosses_Below, Adx_Yearly_Crosses_Above, Adx_Yearly_Crosses_Below, Adx_Quarterly_Crosses_Above, Adx_Quarterly_Crosses_Below, Adx_Monthly_Crosses_Above, Adx_Monthly_Crosses_Below, Adx_Weekly_Crosses_Above, Adx_Weekly_Crosses_Below, Adx_Daily_Crosses_Above, Adx_Daily_Crosses_Below, Adx_4_Hourly_Crosses_Above, Adx_4_Hourly_Crosses_Below, Adx_1_Hourly_Crosses_Above, Adx_1_Hourly_Crosses_Below, Adx_15_Minutes_Crosses_Above, Adx_15_Minutes_Crosses_Below, Rsi_Yearly_Crosses_Above, Rsi_Yearly_Crosses_Below, Rsi_Quarterly_Crosses_Above, Rsi_Quarterly_Crosses_Below, Rsi_Monthly_Crosses_Above, Rsi_Monthly_Crosses_Below, Rsi_Weekly_Crosses_Above, Rsi_Weekly_Crosses_Below, Rsi_Daily_Crosses_Above, Rsi_Daily_Crosses_Below, Rsi_4_Hourly_Crosses_Above, Rsi_4_Hourly_Crosses_Below, Rsi_1_Hourly_Crosses_Above, Rsi_1_Hourly_Crosses_Below, Rsi_15_Minutes_Crosses_Above, Rsi_15_Minutes_Crosses_Below, Upper_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band3_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band3_Daily_Less_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band3_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band3_Daily_Less_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band2_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band2_Daily_Less_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band2_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band2_Daily_Less_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Volume_Yearly_Greater_Than_Equal_To, Volume_Yearly_Less_Than_Equal_To, Volume_Quarterly_Greater_Than_Equal_To, Volume_Quarterly_Less_Than_Equal_To, Volume_Monthly_Greater_Than_Equal_To, Volume_Monthly_Less_Than_Equal_To, Volume_Weekly_Greater_Than_Equal_To, Volume_Weekly_Less_Than_Equal_To, Volume_Daily_Greater_Than_Equal_To, Volume_Daily_Less_Than_Equal_To, Volume_4_Hourly_Greater_Than_Equal_To, Volume_4_Hourly_Less_Than_Equal_To, Volume_1_Hourly_Greater_Than_Equal_To, Volume_1_Hourly_Less_Than_Equal_To, Volume_15_Minutes_Greater_Than_Equal_To, Volume_15_Minutes_Less_Than_Equal_To, Adx_Up_Tick_Yearly_Greater_Than_Equal_To, Adx_Down_Tick_Yearly_Less_Than_Equal_To, Adx_Up_Tick_Quarterly_Greater_Than_Equal_To, Adx_Down_Tick_Quarterly_Less_Than_Equal_To, Adx_Up_Tick_Monthly_Greater_Than_Equal_To, Adx_Down_Tick_Monthly_Less_Than_Equal_To, Adx_Up_Tick_Weekly_Greater_Than_Equal_To, Adx_Down_Tick_Weekly_Less_Than_Equal_To, Adx_Up_Tick_Daily_Greater_Than_Equal_To, Adx_Down_Tick_Daily_Less_Than_Equal_To, Adx_Up_Tick_4_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_4_Hourly_Less_Than_Equal_To, Adx_Up_Tick_1_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_1_Hourly_Less_Than_Equal_To, Adx_Up_Tick_15_Minutes_Greater_Than_Equal_To, Adx_Down_Tick_15_Minutes_Less_Than_Equal_To)
select Batch_No, Created_Date, Stock_Name, Segments, Symbol, Percent_Change, price, volume, Macd_Yearly_Crosses_Above, Macd_Yearly_Crosses_Below, Macd_Quarterly_Crosses_Above, Macd_Quarterly_Crosses_Below, Macd_Monthly_Crosses_Above, Macd_Monthly_Crosses_Below, Macd_Weekly_Crosses_Above, Macd_Weekly_Crosses_Below, Macd_Daily_Crosses_Above, Macd_Daily_Crosses_Below, Macd_4_Hourly_Crosses_Above, Macd_4_Hourly_Crosses_Below, Macd_1_Hourly_Crosses_Above, Macd_1_Hourly_Crosses_Below, Macd_15_Minutes_Crosses_Above, Macd_15_Minutes_Crosses_Below, Stochastic_Yearly_Crosses_Above, Stochastic_Yearly_Crosses_Below, Stochastic_Quarterly_Crosses_Above, Stochastic_Quarterly_Crosses_Below, Stochastic_Monthly_Crosses_Above, Stochastic_Monthly_Crosses_Below, Stochastic_Weekly_Crosses_Above, Stochastic_Weekly_Crosses_Below, Stochastic_Daily_Crosses_Above, Stochastic_Daily_Crosses_Below, Stochastic_4_Hourly_Crosses_Above, Stochastic_4_Hourly_Crosses_Below, Stochastic_1_Hourly_Crosses_Above, Stochastic_1_Hourly_Crosses_Below, Stochastic_15_Minutes_Crosses_Above, Stochastic_15_Minutes_Crosses_Below, Ema_5_13_Yearly_Crosses_Above, Ema_5_13_Yearly_Crosses_Below, Ema_5_13_Quarterly_Crosses_Above, Ema_5_13_Quarterly_Crosses_Below, Ema_5_13_Monthly_Crosses_Above, Ema_5_13_Monthly_Crosses_Below, Ema_5_13_Weekly_Crosses_Above, Ema_5_13_Weekly_Crosses_Below, Ema_5_13_Daily_Crosses_Above, Ema_5_13_Daily_Crosses_Below, Ema_5_13_4_Hourly_Crosses_Above, Ema_5_13_4_Hourly_Crosses_Below, Ema_5_13_1_Hourly_Crosses_Above, Ema_5_13_1_Hourly_Crosses_Below, Ema_5_13_15_Minutes_Crosses_Above, Ema_5_13_15_Minutes_Crosses_Below, Ema_13_26_Yearly_Crosses_Above, Ema_13_26_Yearly_Crosses_Below, Ema_13_26_Quarterly_Crosses_Above, Ema_13_26_Quarterly_Crosses_Below, Ema_13_26_Monthly_Crosses_Above, Ema_13_26_Monthly_Crosses_Below, Ema_13_26_Weekly_Crosses_Above, Ema_13_26_Weekly_Crosses_Below, Ema_13_26_Daily_Crosses_Above, Ema_13_26_Daily_Crosses_Below, Ema_13_26_4_Hourly_Crosses_Above, Ema_13_26_4_Hourly_Crosses_Below, Ema_13_26_1_Hourly_Crosses_Above, Ema_13_26_1_Hourly_Crosses_Below, Ema_13_26_15_Minutes_Crosses_Above, Ema_13_26_15_Minutes_Crosses_Below, Ema_50_100_Yearly_Crosses_Above, Ema_50_100_Yearly_Crosses_Below, Ema_50_100_Quarterly_Crosses_Above, Ema_50_100_Quarterly_Crosses_Below, Ema_50_100_Monthly_Crosses_Above, Ema_50_100_Monthly_Crosses_Below, Ema_50_100_Weekly_Crosses_Above, Ema_50_100_Weekly_Crosses_Below, Ema_50_100_Daily_Crosses_Above, Ema_50_100_Daily_Crosses_Below, Ema_50_100_4_Hourly_Crosses_Above, Ema_50_100_4_Hourly_Crosses_Below, Ema_50_100_1_Hourly_Crosses_Above, Ema_50_100_1_Hourly_Crosses_Below, Ema_50_100_15_Minutes_Crosses_Above, Ema_50_100_15_Minutes_Crosses_Below, Ema_100_200_Yearly_Crosses_Above, Ema_100_200_Yearly_Crosses_Below, Ema_100_200_Quarterly_Crosses_Above, Ema_100_200_Quarterly_Crosses_Below, Ema_100_200_Monthly_Crosses_Above, Ema_100_200_Monthly_Crosses_Below, Ema_100_200_Weekly_Crosses_Above, Ema_100_200_Weekly_Crosses_Below, Ema_100_200_Daily_Crosses_Above, Ema_100_200_Daily_Crosses_Below, Ema_100_200_4_Hourly_Crosses_Above, Ema_100_200_4_Hourly_Crosses_Below, Ema_100_200_1_Hourly_Crosses_Above, Ema_100_200_1_Hourly_Crosses_Below, Ema_100_200_15_Minutes_Crosses_Above, Ema_100_200_15_Minutes_Crosses_Below, Adx_Yearly_Crosses_Above, Adx_Yearly_Crosses_Below, Adx_Quarterly_Crosses_Above, Adx_Quarterly_Crosses_Below, Adx_Monthly_Crosses_Above, Adx_Monthly_Crosses_Below, Adx_Weekly_Crosses_Above, Adx_Weekly_Crosses_Below, Adx_Daily_Crosses_Above, Adx_Daily_Crosses_Below, Adx_4_Hourly_Crosses_Above, Adx_4_Hourly_Crosses_Below, Adx_1_Hourly_Crosses_Above, Adx_1_Hourly_Crosses_Below, Adx_15_Minutes_Crosses_Above, Adx_15_Minutes_Crosses_Below, Rsi_Yearly_Crosses_Above, Rsi_Yearly_Crosses_Below, Rsi_Quarterly_Crosses_Above, Rsi_Quarterly_Crosses_Below, Rsi_Monthly_Crosses_Above, Rsi_Monthly_Crosses_Below, Rsi_Weekly_Crosses_Above, Rsi_Weekly_Crosses_Below, Rsi_Daily_Crosses_Above, Rsi_Daily_Crosses_Below, Rsi_4_Hourly_Crosses_Above, Rsi_4_Hourly_Crosses_Below, Rsi_1_Hourly_Crosses_Above, Rsi_1_Hourly_Crosses_Below, Rsi_15_Minutes_Crosses_Above, Rsi_15_Minutes_Crosses_Below, Upper_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band3_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band3_Daily_Less_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band3_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band3_Daily_Less_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band2_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band2_Daily_Less_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band2_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band2_Daily_Less_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Volume_Yearly_Greater_Than_Equal_To, Volume_Yearly_Less_Than_Equal_To, Volume_Quarterly_Greater_Than_Equal_To, Volume_Quarterly_Less_Than_Equal_To, Volume_Monthly_Greater_Than_Equal_To, Volume_Monthly_Less_Than_Equal_To, Volume_Weekly_Greater_Than_Equal_To, Volume_Weekly_Less_Than_Equal_To, Volume_Daily_Greater_Than_Equal_To, Volume_Daily_Less_Than_Equal_To, Volume_4_Hourly_Greater_Than_Equal_To, Volume_4_Hourly_Less_Than_Equal_To, Volume_1_Hourly_Greater_Than_Equal_To, Volume_1_Hourly_Less_Than_Equal_To, Volume_15_Minutes_Greater_Than_Equal_To, Volume_15_Minutes_Less_Than_Equal_To, Adx_Up_Tick_Yearly_Greater_Than_Equal_To, Adx_Down_Tick_Yearly_Less_Than_Equal_To, Adx_Up_Tick_Quarterly_Greater_Than_Equal_To, Adx_Down_Tick_Quarterly_Less_Than_Equal_To, Adx_Up_Tick_Monthly_Greater_Than_Equal_To, Adx_Down_Tick_Monthly_Less_Than_Equal_To, Adx_Up_Tick_Weekly_Greater_Than_Equal_To, Adx_Down_Tick_Weekly_Less_Than_Equal_To, Adx_Up_Tick_Daily_Greater_Than_Equal_To, Adx_Down_Tick_Daily_Less_Than_Equal_To, Adx_Up_Tick_4_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_4_Hourly_Less_Than_Equal_To, Adx_Up_Tick_1_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_1_Hourly_Less_Than_Equal_To, Adx_Up_Tick_15_Minutes_Greater_Than_Equal_To, Adx_Down_Tick_15_Minutes_Less_Than_Equal_To
from dbo.Analyse_Stocks_1
;
select * from dbo.Master_Stocks_In_Segments order by sno;

select *
-- update sis set Sno = rn 
from dbo.Master_Stocks_In_Segments sis inner join (
select row_number() over(order by len(segments) desc) as rn, 
len(segments) as maxsegments,* 
from dbo.Master_Stocks_In_Segments
) b
on sis.Symbol = b.Symbol
;

insert into dbo.Analyse_Stocks_1
( Batch_No, Created_Date, Stock_Name, Segments, Symbol, Percent_Change, Price, Volume, Bullish_Triple_Screen_Strong_Monthly, Bullish_Triple_Screen_Strong_Weekly, Bullish_Triple_Screen_Strong_Daily, Bullish_Triple_Screen_Strong_4_Hourly, Bullish_Triple_Screen_Strong_1_Hourly, Bullish_Triple_Screen_Strong_15_Minutes, Bullish_Triple_Screen_Strong_Correction_Monthly, Bullish_Triple_Screen_Strong_Correction_Weekly, Bullish_Triple_Screen_Strong_Correction_Daily, Bullish_Triple_Screen_Strong_Correction_4_Hourly, Bullish_Triple_Screen_Strong_Correction_1_Hourly, Bullish_Triple_Screen_Strong_Correction_15_Minutes, Bullish_Double_Screen_Strong_Quarterly, Bullish_Double_Screen_Strong_Monthly, Bullish_Double_Screen_Strong_Weekly, Bullish_Double_Screen_Strong_Daily, Bullish_Double_Screen_Strong_4_Hourly, Bullish_Double_Screen_Strong_1_Hourly, Bullish_Double_Screen_Strong_15_Minutes, Bullish_Double_Screen_Strong_Correction_Quarterly, Bullish_Double_Screen_Strong_Correction_Monthly, Bullish_Double_Screen_Strong_Correction_Weekly, Bullish_Double_Screen_Strong_Correction_Daily, Bullish_Double_Screen_Strong_Correction_4_Hourly, Bullish_Double_Screen_Strong_Correction_1_Hourly, Bullish_Double_Screen_Strong_Correction_15_Minutes, Bullish_Single_Screen_Yearly, Bullish_Single_Screen_Quarterly, Bullish_Single_Screen_Monthly, Bullish_Single_Screen_Weekly, Bullish_Single_Screen_Daily, Bullish_Single_Screen_4_Hourly, Bullish_Single_Screen_1_Hourly, Bullish_Single_Screen_15_Minutes, Bearish_Triple_Screen_Strong_Monthly, Bearish_Triple_Screen_Strong_Weekly, Bearish_Triple_Screen_Strong_Daily, Bearish_Triple_Screen_Strong_4_Hourly, Bearish_Triple_Screen_Strong_1_Hourly, Bearish_Triple_Screen_Strong_15_Minutes, Bearish_Triple_Screen_Strong_Correction_Monthly, Bearish_Triple_Screen_Strong_Correction_Weekly, Bearish_Triple_Screen_Strong_Correction_Daily, Bearish_Triple_Screen_Strong_Correction_4_Hourly, Bearish_Triple_Screen_Strong_Correction_1_Hourly, Bearish_Triple_Screen_Strong_Correction_15_Minutes, Bearish_Double_Screen_Strong_Quarterly, Bearish_Double_Screen_Strong_Monthly, Bearish_Double_Screen_Strong_Weekly, Bearish_Double_Screen_Strong_Daily, Bearish_Double_Screen_Strong_4_Hourly, Bearish_Double_Screen_Strong_1_Hourly, Bearish_Double_Screen_Strong_15_Minutes, Bearish_Double_Screen_Strong_Correction_Quarterly, Bearish_Double_Screen_Strong_Correction_Monthly, Bearish_Double_Screen_Strong_Correction_Weekly, Bearish_Double_Screen_Strong_Correction_Daily, Bearish_Double_Screen_Strong_Correction_4_Hourly, Bearish_Double_Screen_Strong_Correction_1_Hourly, Bearish_Double_Screen_Strong_Correction_15_Minutes, Bearish_Single_Screen_Yearly, Bearish_Single_Screen_Quarterly, Bearish_Single_Screen_Monthly, Bearish_Single_Screen_Weekly, Bearish_Single_Screen_Daily, Bearish_Single_Screen_4_Hourly, Bearish_Single_Screen_1_Hourly, Bearish_Single_Screen_15_Minutes, Macd_Yearly_Crosses_Above, Macd_Yearly_Crosses_Below, Macd_Quarterly_Crosses_Above, Macd_Quarterly_Crosses_Below, Macd_Monthly_Crosses_Above, Macd_Monthly_Crosses_Below, Macd_Weekly_Crosses_Above, Macd_Weekly_Crosses_Below, Macd_Daily_Crosses_Above, Macd_Daily_Crosses_Below, Macd_4_Hourly_Crosses_Above, Macd_4_Hourly_Crosses_Below, Macd_1_Hourly_Crosses_Above, Macd_1_Hourly_Crosses_Below, Macd_15_Minutes_Crosses_Above, Macd_15_Minutes_Crosses_Below, Stochastic_Yearly_Crosses_Above, Stochastic_Yearly_Crosses_Below, Stochastic_Quarterly_Crosses_Above, Stochastic_Quarterly_Crosses_Below, Stochastic_Monthly_Crosses_Above, Stochastic_Monthly_Crosses_Below, Stochastic_Weekly_Crosses_Above, Stochastic_Weekly_Crosses_Below, Stochastic_Daily_Crosses_Above, Stochastic_Daily_Crosses_Below, Stochastic_4_Hourly_Crosses_Above, Stochastic_4_Hourly_Crosses_Below, Stochastic_1_Hourly_Crosses_Above, Stochastic_1_Hourly_Crosses_Below, Stochastic_15_Minutes_Crosses_Above, Stochastic_15_Minutes_Crosses_Below, Ema_5_13_Yearly_Crosses_Above, Ema_5_13_Yearly_Crosses_Below, Ema_5_13_Quarterly_Crosses_Above, Ema_5_13_Quarterly_Crosses_Below, Ema_5_13_Monthly_Crosses_Above, Ema_5_13_Monthly_Crosses_Below, Ema_5_13_Weekly_Crosses_Above, Ema_5_13_Weekly_Crosses_Below, Ema_5_13_Daily_Crosses_Above, Ema_5_13_Daily_Crosses_Below, Ema_5_13_4_Hourly_Crosses_Above, Ema_5_13_4_Hourly_Crosses_Below, Ema_5_13_1_Hourly_Crosses_Above, Ema_5_13_1_Hourly_Crosses_Below, Ema_5_13_15_Minutes_Crosses_Above, Ema_5_13_15_Minutes_Crosses_Below, Ema_13_26_Yearly_Crosses_Above, Ema_13_26_Yearly_Crosses_Below, Ema_13_26_Quarterly_Crosses_Above, Ema_13_26_Quarterly_Crosses_Below, Ema_13_26_Monthly_Crosses_Above, Ema_13_26_Monthly_Crosses_Below, Ema_13_26_Weekly_Crosses_Above, Ema_13_26_Weekly_Crosses_Below, Ema_13_26_Daily_Crosses_Above, Ema_13_26_Daily_Crosses_Below, Ema_13_26_4_Hourly_Crosses_Above, Ema_13_26_4_Hourly_Crosses_Below, Ema_13_26_1_Hourly_Crosses_Above, Ema_13_26_1_Hourly_Crosses_Below, Ema_13_26_15_Minutes_Crosses_Above, Ema_13_26_15_Minutes_Crosses_Below, Ema_50_100_Yearly_Crosses_Above, Ema_50_100_Yearly_Crosses_Below, Ema_50_100_Quarterly_Crosses_Above, Ema_50_100_Quarterly_Crosses_Below, Ema_50_100_Monthly_Crosses_Above, Ema_50_100_Monthly_Crosses_Below, Ema_50_100_Weekly_Crosses_Above, Ema_50_100_Weekly_Crosses_Below, Ema_50_100_Daily_Crosses_Above, Ema_50_100_Daily_Crosses_Below, Ema_50_100_4_Hourly_Crosses_Above, Ema_50_100_4_Hourly_Crosses_Below, Ema_50_100_1_Hourly_Crosses_Above, Ema_50_100_1_Hourly_Crosses_Below, Ema_50_100_15_Minutes_Crosses_Above, Ema_50_100_15_Minutes_Crosses_Below, Ema_100_200_Yearly_Crosses_Above, Ema_100_200_Yearly_Crosses_Below, Ema_100_200_Quarterly_Crosses_Above, Ema_100_200_Quarterly_Crosses_Below, Ema_100_200_Monthly_Crosses_Above, Ema_100_200_Monthly_Crosses_Below, Ema_100_200_Weekly_Crosses_Above, Ema_100_200_Weekly_Crosses_Below, Ema_100_200_Daily_Crosses_Above, Ema_100_200_Daily_Crosses_Below, Ema_100_200_4_Hourly_Crosses_Above, Ema_100_200_4_Hourly_Crosses_Below, Ema_100_200_1_Hourly_Crosses_Above, Ema_100_200_1_Hourly_Crosses_Below, Ema_100_200_15_Minutes_Crosses_Above, Ema_100_200_15_Minutes_Crosses_Below, Adx_Yearly_Crosses_Above, Adx_Yearly_Crosses_Below, Adx_Quarterly_Crosses_Above, Adx_Quarterly_Crosses_Below, Adx_Monthly_Crosses_Above, Adx_Monthly_Crosses_Below, Adx_Weekly_Crosses_Above, Adx_Weekly_Crosses_Below, Adx_Daily_Crosses_Above, Adx_Daily_Crosses_Below, Adx_4_Hourly_Crosses_Above, Adx_4_Hourly_Crosses_Below, Adx_1_Hourly_Crosses_Above, Adx_1_Hourly_Crosses_Below, Adx_15_Minutes_Crosses_Above, Adx_15_Minutes_Crosses_Below, Rsi_Yearly_Crosses_Above, Rsi_Yearly_Crosses_Below, Rsi_Quarterly_Crosses_Above, Rsi_Quarterly_Crosses_Below, Rsi_Monthly_Crosses_Above, Rsi_Monthly_Crosses_Below, Rsi_Weekly_Crosses_Above, Rsi_Weekly_Crosses_Below, Rsi_Daily_Crosses_Above, Rsi_Daily_Crosses_Below, Rsi_4_Hourly_Crosses_Above, Rsi_4_Hourly_Crosses_Below, Rsi_1_Hourly_Crosses_Above, Rsi_1_Hourly_Crosses_Below, Rsi_15_Minutes_Crosses_Above, Rsi_15_Minutes_Crosses_Below, Upper_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band3_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band3_Daily_Less_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band3_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band3_Daily_Less_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band2_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band2_Daily_Less_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band2_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band2_Daily_Less_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Volume_Yearly_Greater_Than_Equal_To, Volume_Yearly_Less_Than_Equal_To, Volume_Quarterly_Greater_Than_Equal_To, Volume_Quarterly_Less_Than_Equal_To, Volume_Monthly_Greater_Than_Equal_To, Volume_Monthly_Less_Than_Equal_To, Volume_Weekly_Greater_Than_Equal_To, Volume_Weekly_Less_Than_Equal_To, Volume_Daily_Greater_Than_Equal_To, Volume_Daily_Less_Than_Equal_To, Volume_4_Hourly_Greater_Than_Equal_To, Volume_4_Hourly_Less_Than_Equal_To, Volume_1_Hourly_Greater_Than_Equal_To, Volume_1_Hourly_Less_Than_Equal_To, Volume_15_Minutes_Greater_Than_Equal_To, Volume_15_Minutes_Less_Than_Equal_To, Adx_Up_Tick_Yearly_Greater_Than_Equal_To, Adx_Down_Tick_Yearly_Less_Than_Equal_To, Adx_Up_Tick_Quarterly_Greater_Than_Equal_To, Adx_Down_Tick_Quarterly_Less_Than_Equal_To, Adx_Up_Tick_Monthly_Greater_Than_Equal_To, Adx_Down_Tick_Monthly_Less_Than_Equal_To, Adx_Up_Tick_Weekly_Greater_Than_Equal_To, Adx_Down_Tick_Weekly_Less_Than_Equal_To, Adx_Up_Tick_Daily_Greater_Than_Equal_To, Adx_Down_Tick_Daily_Less_Than_Equal_To, Adx_Up_Tick_4_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_4_Hourly_Less_Than_Equal_To, Adx_Up_Tick_1_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_1_Hourly_Less_Than_Equal_To, Adx_Up_Tick_15_Minutes_Greater_Than_Equal_To, Adx_Down_Tick_15_Minutes_Less_Than_Equal_To)
select Batch_No, Created_Date, Stock_Name, Segments, Symbol, Percent_Change, Price, Volume, Bullish_Triple_Screen_Strong_Monthly, Bullish_Triple_Screen_Strong_Weekly, Bullish_Triple_Screen_Strong_Daily, Bullish_Triple_Screen_Strong_4_Hourly, Bullish_Triple_Screen_Strong_1_Hourly, Bullish_Triple_Screen_Strong_15_Minutes, Bullish_Triple_Screen_Strong_Correction_Monthly, Bullish_Triple_Screen_Strong_Correction_Weekly, Bullish_Triple_Screen_Strong_Correction_Daily, Bullish_Triple_Screen_Strong_Correction_4_Hourly, Bullish_Triple_Screen_Strong_Correction_1_Hourly, Bullish_Triple_Screen_Strong_Correction_15_Minutes, Bullish_Double_Screen_Strong_Quarterly, Bullish_Double_Screen_Strong_Monthly, Bullish_Double_Screen_Strong_Weekly, Bullish_Double_Screen_Strong_Daily, Bullish_Double_Screen_Strong_4_Hourly, Bullish_Double_Screen_Strong_1_Hourly, Bullish_Double_Screen_Strong_15_Minutes, Bullish_Double_Screen_Strong_Correction_Quarterly, Bullish_Double_Screen_Strong_Correction_Monthly, Bullish_Double_Screen_Strong_Correction_Weekly, Bullish_Double_Screen_Strong_Correction_Daily, Bullish_Double_Screen_Strong_Correction_4_Hourly, Bullish_Double_Screen_Strong_Correction_1_Hourly, Bullish_Double_Screen_Strong_Correction_15_Minutes, Bullish_Single_Screen_Yearly, Bullish_Single_Screen_Quarterly, Bullish_Single_Screen_Monthly, Bullish_Single_Screen_Weekly, Bullish_Single_Screen_Daily, Bullish_Single_Screen_4_Hourly, Bullish_Single_Screen_1_Hourly, Bullish_Single_Screen_15_Minutes, Bearish_Triple_Screen_Strong_Monthly, Bearish_Triple_Screen_Strong_Weekly, Bearish_Triple_Screen_Strong_Daily, Bearish_Triple_Screen_Strong_4_Hourly, Bearish_Triple_Screen_Strong_1_Hourly, Bearish_Triple_Screen_Strong_15_Minutes, Bearish_Triple_Screen_Strong_Correction_Monthly, Bearish_Triple_Screen_Strong_Correction_Weekly, Bearish_Triple_Screen_Strong_Correction_Daily, Bearish_Triple_Screen_Strong_Correction_4_Hourly, Bearish_Triple_Screen_Strong_Correction_1_Hourly, Bearish_Triple_Screen_Strong_Correction_15_Minutes, Bearish_Double_Screen_Strong_Quarterly, Bearish_Double_Screen_Strong_Monthly, Bearish_Double_Screen_Strong_Weekly, Bearish_Double_Screen_Strong_Daily, Bearish_Double_Screen_Strong_4_Hourly, Bearish_Double_Screen_Strong_1_Hourly, Bearish_Double_Screen_Strong_15_Minutes, Bearish_Double_Screen_Strong_Correction_Quarterly, Bearish_Double_Screen_Strong_Correction_Monthly, Bearish_Double_Screen_Strong_Correction_Weekly, Bearish_Double_Screen_Strong_Correction_Daily, Bearish_Double_Screen_Strong_Correction_4_Hourly, Bearish_Double_Screen_Strong_Correction_1_Hourly, Bearish_Double_Screen_Strong_Correction_15_Minutes, Bearish_Single_Screen_Yearly, Bearish_Single_Screen_Quarterly, Bearish_Single_Screen_Monthly, Bearish_Single_Screen_Weekly, Bearish_Single_Screen_Daily, Bearish_Single_Screen_4_Hourly, Bearish_Single_Screen_1_Hourly, Bearish_Single_Screen_15_Minutes, Macd_Yearly_Crosses_Above, Macd_Yearly_Crosses_Below, Macd_Quarterly_Crosses_Above, Macd_Quarterly_Crosses_Below, Macd_Monthly_Crosses_Above, Macd_Monthly_Crosses_Below, Macd_Weekly_Crosses_Above, Macd_Weekly_Crosses_Below, Macd_Daily_Crosses_Above, Macd_Daily_Crosses_Below, Macd_4_Hourly_Crosses_Above, Macd_4_Hourly_Crosses_Below, Macd_1_Hourly_Crosses_Above, Macd_1_Hourly_Crosses_Below, Macd_15_Minutes_Crosses_Above, Macd_15_Minutes_Crosses_Below, Stochastic_Yearly_Crosses_Above, Stochastic_Yearly_Crosses_Below, Stochastic_Quarterly_Crosses_Above, Stochastic_Quarterly_Crosses_Below, Stochastic_Monthly_Crosses_Above, Stochastic_Monthly_Crosses_Below, Stochastic_Weekly_Crosses_Above, Stochastic_Weekly_Crosses_Below, Stochastic_Daily_Crosses_Above, Stochastic_Daily_Crosses_Below, Stochastic_4_Hourly_Crosses_Above, Stochastic_4_Hourly_Crosses_Below, Stochastic_1_Hourly_Crosses_Above, Stochastic_1_Hourly_Crosses_Below, Stochastic_15_Minutes_Crosses_Above, Stochastic_15_Minutes_Crosses_Below, Ema_5_13_Yearly_Crosses_Above, Ema_5_13_Yearly_Crosses_Below, Ema_5_13_Quarterly_Crosses_Above, Ema_5_13_Quarterly_Crosses_Below, Ema_5_13_Monthly_Crosses_Above, Ema_5_13_Monthly_Crosses_Below, Ema_5_13_Weekly_Crosses_Above, Ema_5_13_Weekly_Crosses_Below, Ema_5_13_Daily_Crosses_Above, Ema_5_13_Daily_Crosses_Below, Ema_5_13_4_Hourly_Crosses_Above, Ema_5_13_4_Hourly_Crosses_Below, Ema_5_13_1_Hourly_Crosses_Above, Ema_5_13_1_Hourly_Crosses_Below, Ema_5_13_15_Minutes_Crosses_Above, Ema_5_13_15_Minutes_Crosses_Below, Ema_13_26_Yearly_Crosses_Above, Ema_13_26_Yearly_Crosses_Below, Ema_13_26_Quarterly_Crosses_Above, Ema_13_26_Quarterly_Crosses_Below, Ema_13_26_Monthly_Crosses_Above, Ema_13_26_Monthly_Crosses_Below, Ema_13_26_Weekly_Crosses_Above, Ema_13_26_Weekly_Crosses_Below, Ema_13_26_Daily_Crosses_Above, Ema_13_26_Daily_Crosses_Below, Ema_13_26_4_Hourly_Crosses_Above, Ema_13_26_4_Hourly_Crosses_Below, Ema_13_26_1_Hourly_Crosses_Above, Ema_13_26_1_Hourly_Crosses_Below, Ema_13_26_15_Minutes_Crosses_Above, Ema_13_26_15_Minutes_Crosses_Below, Ema_50_100_Yearly_Crosses_Above, Ema_50_100_Yearly_Crosses_Below, Ema_50_100_Quarterly_Crosses_Above, Ema_50_100_Quarterly_Crosses_Below, Ema_50_100_Monthly_Crosses_Above, Ema_50_100_Monthly_Crosses_Below, Ema_50_100_Weekly_Crosses_Above, Ema_50_100_Weekly_Crosses_Below, Ema_50_100_Daily_Crosses_Above, Ema_50_100_Daily_Crosses_Below, Ema_50_100_4_Hourly_Crosses_Above, Ema_50_100_4_Hourly_Crosses_Below, Ema_50_100_1_Hourly_Crosses_Above, Ema_50_100_1_Hourly_Crosses_Below, Ema_50_100_15_Minutes_Crosses_Above, Ema_50_100_15_Minutes_Crosses_Below, Ema_100_200_Yearly_Crosses_Above, Ema_100_200_Yearly_Crosses_Below, Ema_100_200_Quarterly_Crosses_Above, Ema_100_200_Quarterly_Crosses_Below, Ema_100_200_Monthly_Crosses_Above, Ema_100_200_Monthly_Crosses_Below, Ema_100_200_Weekly_Crosses_Above, Ema_100_200_Weekly_Crosses_Below, Ema_100_200_Daily_Crosses_Above, Ema_100_200_Daily_Crosses_Below, Ema_100_200_4_Hourly_Crosses_Above, Ema_100_200_4_Hourly_Crosses_Below, Ema_100_200_1_Hourly_Crosses_Above, Ema_100_200_1_Hourly_Crosses_Below, Ema_100_200_15_Minutes_Crosses_Above, Ema_100_200_15_Minutes_Crosses_Below, Adx_Yearly_Crosses_Above, Adx_Yearly_Crosses_Below, Adx_Quarterly_Crosses_Above, Adx_Quarterly_Crosses_Below, Adx_Monthly_Crosses_Above, Adx_Monthly_Crosses_Below, Adx_Weekly_Crosses_Above, Adx_Weekly_Crosses_Below, Adx_Daily_Crosses_Above, Adx_Daily_Crosses_Below, Adx_4_Hourly_Crosses_Above, Adx_4_Hourly_Crosses_Below, Adx_1_Hourly_Crosses_Above, Adx_1_Hourly_Crosses_Below, Adx_15_Minutes_Crosses_Above, Adx_15_Minutes_Crosses_Below, Rsi_Yearly_Crosses_Above, Rsi_Yearly_Crosses_Below, Rsi_Quarterly_Crosses_Above, Rsi_Quarterly_Crosses_Below, Rsi_Monthly_Crosses_Above, Rsi_Monthly_Crosses_Below, Rsi_Weekly_Crosses_Above, Rsi_Weekly_Crosses_Below, Rsi_Daily_Crosses_Above, Rsi_Daily_Crosses_Below, Rsi_4_Hourly_Crosses_Above, Rsi_4_Hourly_Crosses_Below, Rsi_1_Hourly_Crosses_Above, Rsi_1_Hourly_Crosses_Below, Rsi_15_Minutes_Crosses_Above, Rsi_15_Minutes_Crosses_Below, Upper_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band3_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band3_Daily_Less_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band3_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band3_Daily_Less_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band2_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band2_Daily_Less_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band2_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band2_Daily_Less_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Volume_Yearly_Greater_Than_Equal_To, Volume_Yearly_Less_Than_Equal_To, Volume_Quarterly_Greater_Than_Equal_To, Volume_Quarterly_Less_Than_Equal_To, Volume_Monthly_Greater_Than_Equal_To, Volume_Monthly_Less_Than_Equal_To, Volume_Weekly_Greater_Than_Equal_To, Volume_Weekly_Less_Than_Equal_To, Volume_Daily_Greater_Than_Equal_To, Volume_Daily_Less_Than_Equal_To, Volume_4_Hourly_Greater_Than_Equal_To, Volume_4_Hourly_Less_Than_Equal_To, Volume_1_Hourly_Greater_Than_Equal_To, Volume_1_Hourly_Less_Than_Equal_To, Volume_15_Minutes_Greater_Than_Equal_To, Volume_15_Minutes_Less_Than_Equal_To, Adx_Up_Tick_Yearly_Greater_Than_Equal_To, Adx_Down_Tick_Yearly_Less_Than_Equal_To, Adx_Up_Tick_Quarterly_Greater_Than_Equal_To, Adx_Down_Tick_Quarterly_Less_Than_Equal_To, Adx_Up_Tick_Monthly_Greater_Than_Equal_To, Adx_Down_Tick_Monthly_Less_Than_Equal_To, Adx_Up_Tick_Weekly_Greater_Than_Equal_To, Adx_Down_Tick_Weekly_Less_Than_Equal_To, Adx_Up_Tick_Daily_Greater_Than_Equal_To, Adx_Down_Tick_Daily_Less_Than_Equal_To, Adx_Up_Tick_4_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_4_Hourly_Less_Than_Equal_To, Adx_Up_Tick_1_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_1_Hourly_Less_Than_Equal_To, Adx_Up_Tick_15_Minutes_Greater_Than_Equal_To, Adx_Down_Tick_15_Minutes_Less_Than_Equal_To
from dbo.Analyse_Stocks
;
-- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
select * from dbo.Analyse_Stocks
;
select * 
-- update a set a.Bullish_Triple_Screen_Strong_Monthly = 350 
from dbo.Analyse_Stocks a where a.Bullish_Triple_Screen_Strong_Monthly = 1
;
select * 
-- update a set a.Bullish_Triple_Screen_Strong_Weekly = 340 
from dbo.Analyse_Stocks a where a.Bullish_Triple_Screen_Strong_Weekly = 1
;
select * 
-- update a set a.Bullish_Triple_Screen_Strong_Daily = 330 
from dbo.Analyse_Stocks a where a.Bullish_Triple_Screen_Strong_Daily = 1
;
select * 
-- update a set a.Bullish_Triple_Screen_Strong_4_Hourly = 320 
from dbo.Analyse_Stocks a where a.Bullish_Triple_Screen_Strong_4_Hourly = 1
;
select * 
-- update a set a.Bullish_Triple_Screen_Strong_1_Hourly = 310 
from dbo.Analyse_Stocks a where a.Bullish_Triple_Screen_Strong_1_Hourly = 1
;
select * 
-- update a set a.Bullish_Triple_Screen_Strong_15_Minutes = 310 
from dbo.Analyse_Stocks a where a.Bullish_Triple_Screen_Strong_15_Minutes = 1
;
-- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
select * 
-- update a set a.Trade_Type_Details_Sum= isnull(Bullish_Triple_Screen_Strong_Monthly,0)+isnull(Bullish_Triple_Screen_Strong_Weekly,0)+isnull(Bullish_Triple_Screen_Strong_Daily,0)+isnull(Bullish_Triple_Screen_Strong_4_Hourly,0)+isnull(Bullish_Triple_Screen_Strong_1_Hourly,0)+isnull(Bullish_Triple_Screen_Strong_15_Minutes,0)
from dbo.Analyse_Stocks a ;
update a set a.Segments_Length = len(a.Segments) from dbo.Analyse_Stocks a ;
select * from dbo.Analyse_Stocks a 
where Batch_No >=10 and a.Trade_Type_Details_Sum > 0 and a.Segments_Length > 10
order by a.Trade_Type_Details_Sum desc,a.Segments_Length desc,Batch_No desc
;
-- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
select * 
from dbo.Analyse_Stocks
where Trade_Type_Details_Sum > 10 and Segments_Length > 10
and Batch_No = (select max(batch_no) from dbo.Analyse_Stocks)
order by Batch_No desc,Trade_Type_Details_Sum desc;

select distinct Batch_No,Trade_Type_Details_Sum,Stock_Name,Segments,Symbol,Percent_Change,Price,Volume
from dbo.Analyse_15Minutes_Stocks 
where Trade_Type_Details_Sum > 10 and Segments_Length > 10
and Batch_No = (select max(batch_no) from dbo.Analyse_15Minutes_Stocks)
order by Batch_No desc,Trade_Type_Details_Sum desc;


select * 
-- update a set Trade_Type = isnull(Trade_Type,'') + 'Bullish;', Trade_Type_Details = isnull(Trade_Type_Details,'') + 'Bullish - Strong Triple Screen;'
from dbo.Analyse_Stocks a where 
Bullish_Triple_Screen_Strong_Monthly > 0 or 
Bullish_Triple_Screen_Strong_Weekly > 0 or
Bullish_Triple_Screen_Strong_Daily > 0 or
Bullish_Triple_Screen_Strong_4_Hourly > 0 or
Bullish_Triple_Screen_Strong_1_Hourly > 0 or
Bullish_Triple_Screen_Strong_15_Minutes > 0
;

select * 
-- update a set Trade_Type = isnull(Trade_Type,'') + 'Bullish;', Trade_Type_Details = isnull(Trade_Type_Details,'') + 'Bullish - Strong Triple Screen Correction;'
from dbo.Analyse_Stocks a where 
Bullish_Triple_Screen_Strong_Correction_Monthly > 0 or
Bullish_Triple_Screen_Strong_Correction_Weekly > 0 or
Bullish_Triple_Screen_Strong_Correction_Daily > 0 or
Bullish_Triple_Screen_Strong_Correction_4_Hourly > 0 or
Bullish_Triple_Screen_Strong_Correction_1_Hourly > 0 or
Bullish_Triple_Screen_Strong_Correction_15_Minutes > 0
;
select * 
-- update a set Trade_Type = isnull(Trade_Type,'') + 'Bullish;', Trade_Type_Details = isnull(Trade_Type_Details,'') + 'Bullish - Strong Double Screen;'
from dbo.Analyse_Stocks a where 
Bullish_Double_Screen_Strong_Quarterly > 0 or
Bullish_Double_Screen_Strong_Monthly > 0 or
Bullish_Double_Screen_Strong_Weekly > 0 or
Bullish_Double_Screen_Strong_Daily > 0 or
Bullish_Double_Screen_Strong_4_Hourly > 0 or
Bullish_Double_Screen_Strong_1_Hourly > 0 or
Bullish_Double_Screen_Strong_15_Minutes > 0
;
select * 
-- update a set Trade_Type = isnull(Trade_Type,'') + 'Bullish;', Trade_Type_Details = isnull(Trade_Type_Details,'') + 'Bullish - Strong Double Screen Correction;'
from dbo.Analyse_Stocks a where 
Bullish_Double_Screen_Strong_Correction_Quarterly > 0 or
Bullish_Double_Screen_Strong_Correction_Monthly > 0 or
Bullish_Double_Screen_Strong_Correction_Weekly > 0 or
Bullish_Double_Screen_Strong_Correction_Daily > 0 or
Bullish_Double_Screen_Strong_Correction_4_Hourly > 0 or
Bullish_Double_Screen_Strong_Correction_1_Hourly > 0 or
Bullish_Double_Screen_Strong_Correction_15_Minutes > 0
;
select * 
-- update a set Trade_Type = isnull(Trade_Type,'') + 'Bullish;', Trade_Type_Details = isnull(Trade_Type_Details,'') + 'Bullish - Single Screen;'
from dbo.Analyse_Stocks a where 
Bullish_Single_Screen_Yearly > 0 or
Bullish_Single_Screen_Quarterly > 0 or
Bullish_Single_Screen_Monthly > 0 or
Bullish_Single_Screen_Weekly > 0 or
Bullish_Single_Screen_Daily > 0 or
Bullish_Single_Screen_4_Hourly > 0 or
Bullish_Single_Screen_1_Hourly > 0 or
Bullish_Single_Screen_15_Minutes > 0
;
select * 
-- update a set Trade_Type = isnull(Trade_Type,'') + 'Bearish;', Trade_Type_Details = isnull(Trade_Type_Details,'') + 'Bearish - Strong Triple Screen;'
from dbo.Analyse_Stocks a where 
Bearish_Triple_Screen_Strong_Monthly > 0 or
Bearish_Triple_Screen_Strong_Weekly > 0 or
Bearish_Triple_Screen_Strong_Daily > 0 or
Bearish_Triple_Screen_Strong_4_Hourly > 0 or
Bearish_Triple_Screen_Strong_1_Hourly > 0 or
Bearish_Triple_Screen_Strong_15_Minutes > 0
;
select * 
-- update a set Trade_Type = isnull(Trade_Type,'') + 'Bearish;', Trade_Type_Details = isnull(Trade_Type_Details,'') + 'Bearish - Strong Triple Screen Correction;'
from dbo.Analyse_Stocks a where 
Bearish_Triple_Screen_Strong_Correction_Monthly > 0 or
Bearish_Triple_Screen_Strong_Correction_Weekly > 0 or
Bearish_Triple_Screen_Strong_Correction_Daily > 0 or
Bearish_Triple_Screen_Strong_Correction_4_Hourly > 0 or
Bearish_Triple_Screen_Strong_Correction_1_Hourly > 0 or
Bearish_Triple_Screen_Strong_Correction_15_Minutes > 0
;
select * 
-- update a set Trade_Type = isnull(Trade_Type,'') + 'Bearish;',Trade_Type_Details = isnull(Trade_Type_Details,'') + 'Bearish - Strong Double Screen;'
from dbo.Analyse_Stocks a where 
Bearish_Double_Screen_Strong_Quarterly > 0 or
Bearish_Double_Screen_Strong_Monthly > 0 or
Bearish_Double_Screen_Strong_Weekly > 0 or
Bearish_Double_Screen_Strong_Daily > 0 or
Bearish_Double_Screen_Strong_4_Hourly > 0 or
Bearish_Double_Screen_Strong_1_Hourly > 0 or
Bearish_Double_Screen_Strong_15_Minutes > 0 
;
select * 
-- update a set Trade_Type = isnull(Trade_Type,'') + 'Bearish;',Trade_Type_Details = isnull(Trade_Type_Details,'') + 'Bearish - Strong Double Screen Correction;'
from dbo.Analyse_Stocks a where 
Bearish_Double_Screen_Strong_Correction_Quarterly > 0 or
Bearish_Double_Screen_Strong_Correction_Monthly > 0 or
Bearish_Double_Screen_Strong_Correction_Weekly > 0 or
Bearish_Double_Screen_Strong_Correction_Daily > 0 or
Bearish_Double_Screen_Strong_Correction_4_Hourly > 0 or
Bearish_Double_Screen_Strong_Correction_1_Hourly > 0 or
Bearish_Double_Screen_Strong_Correction_15_Minutes > 0
;
select * 
-- update a set Trade_Type = isnull(Trade_Type,'') + 'Bearish;',Trade_Type_Details = isnull(Trade_Type_Details,'') + 'Bearish - Single Screen;'
from dbo.Analyse_Stocks a where 
Bearish_Single_Screen_Yearly > 0 or
Bearish_Single_Screen_Quarterly > 0 or
Bearish_Single_Screen_Monthly > 0 or
Bearish_Single_Screen_Weekly > 0 or
Bearish_Single_Screen_Daily > 0 or
Bearish_Single_Screen_4_Hourly > 0 or
Bearish_Single_Screen_1_Hourly > 0 or
Bearish_Single_Screen_15_Minutes > 0 
;
-- insert into dbo.Analyse_15Minutes_Stocks ( Batch_No, Trade_Type_Details_Sum, Segments_Length,Trade_Type, Trade_Type_Details, Trade_Type_Length, Trade_Type_Details_Length, Created_Date, Stock_Name, Segments, Symbol, Percent_Change, Price, Volume, Bullish_Triple_Screen_Strong_Monthly, Bullish_Triple_Screen_Strong_Weekly, Bullish_Triple_Screen_Strong_Daily, Bullish_Triple_Screen_Strong_4_Hourly, Bullish_Triple_Screen_Strong_1_Hourly, Bullish_Triple_Screen_Strong_15_Minutes, Bullish_Triple_Screen_Strong_Correction_Monthly, Bullish_Triple_Screen_Strong_Correction_Weekly, Bullish_Triple_Screen_Strong_Correction_Daily, Bullish_Triple_Screen_Strong_Correction_4_Hourly, Bullish_Triple_Screen_Strong_Correction_1_Hourly, Bullish_Triple_Screen_Strong_Correction_15_Minutes, Bullish_Double_Screen_Strong_Quarterly, Bullish_Double_Screen_Strong_Monthly, Bullish_Double_Screen_Strong_Weekly, Bullish_Double_Screen_Strong_Daily, Bullish_Double_Screen_Strong_4_Hourly, Bullish_Double_Screen_Strong_1_Hourly, Bullish_Double_Screen_Strong_15_Minutes, Bullish_Double_Screen_Strong_Correction_Quarterly, Bullish_Double_Screen_Strong_Correction_Monthly, Bullish_Double_Screen_Strong_Correction_Weekly, Bullish_Double_Screen_Strong_Correction_Daily, Bullish_Double_Screen_Strong_Correction_4_Hourly, Bullish_Double_Screen_Strong_Correction_1_Hourly, Bullish_Double_Screen_Strong_Correction_15_Minutes, Bullish_Single_Screen_Yearly, Bullish_Single_Screen_Quarterly, Bullish_Single_Screen_Monthly, Bullish_Single_Screen_Weekly, Bullish_Single_Screen_Daily, Bullish_Single_Screen_4_Hourly, Bullish_Single_Screen_1_Hourly, Bullish_Single_Screen_15_Minutes, Bearish_Triple_Screen_Strong_Monthly, Bearish_Triple_Screen_Strong_Weekly, Bearish_Triple_Screen_Strong_Daily, Bearish_Triple_Screen_Strong_4_Hourly, Bearish_Triple_Screen_Strong_1_Hourly, Bearish_Triple_Screen_Strong_15_Minutes, Bearish_Triple_Screen_Strong_Correction_Monthly, Bearish_Triple_Screen_Strong_Correction_Weekly, Bearish_Triple_Screen_Strong_Correction_Daily, Bearish_Triple_Screen_Strong_Correction_4_Hourly, Bearish_Triple_Screen_Strong_Correction_1_Hourly, Bearish_Triple_Screen_Strong_Correction_15_Minutes, Bearish_Double_Screen_Strong_Quarterly, Bearish_Double_Screen_Strong_Monthly, Bearish_Double_Screen_Strong_Weekly, Bearish_Double_Screen_Strong_Daily, Bearish_Double_Screen_Strong_4_Hourly, Bearish_Double_Screen_Strong_1_Hourly, Bearish_Double_Screen_Strong_15_Minutes, Bearish_Double_Screen_Strong_Correction_Quarterly, Bearish_Double_Screen_Strong_Correction_Monthly, Bearish_Double_Screen_Strong_Correction_Weekly, Bearish_Double_Screen_Strong_Correction_Daily, Bearish_Double_Screen_Strong_Correction_4_Hourly, Bearish_Double_Screen_Strong_Correction_1_Hourly, Bearish_Double_Screen_Strong_Correction_15_Minutes, Bearish_Single_Screen_Yearly, Bearish_Single_Screen_Quarterly, Bearish_Single_Screen_Monthly, Bearish_Single_Screen_Weekly, Bearish_Single_Screen_Daily, Bearish_Single_Screen_4_Hourly, Bearish_Single_Screen_1_Hourly, Bearish_Single_Screen_15_Minutes, Macd_Yearly_Crosses_Above, Macd_Yearly_Crosses_Below, Macd_Quarterly_Crosses_Above, Macd_Quarterly_Crosses_Below, Macd_Monthly_Crosses_Above, Macd_Monthly_Crosses_Below, Macd_Weekly_Crosses_Above, Macd_Weekly_Crosses_Below, Macd_Daily_Crosses_Above, Macd_Daily_Crosses_Below, Macd_4_Hourly_Crosses_Above, Macd_4_Hourly_Crosses_Below, Macd_1_Hourly_Crosses_Above, Macd_1_Hourly_Crosses_Below, Macd_15_Minutes_Crosses_Above, Macd_15_Minutes_Crosses_Below, Stochastic_Yearly_Crosses_Above, Stochastic_Yearly_Crosses_Below, Stochastic_Quarterly_Crosses_Above, Stochastic_Quarterly_Crosses_Below, Stochastic_Monthly_Crosses_Above, Stochastic_Monthly_Crosses_Below, Stochastic_Weekly_Crosses_Above, Stochastic_Weekly_Crosses_Below, Stochastic_Daily_Crosses_Above, Stochastic_Daily_Crosses_Below, Stochastic_4_Hourly_Crosses_Above, Stochastic_4_Hourly_Crosses_Below, Stochastic_1_Hourly_Crosses_Above, Stochastic_1_Hourly_Crosses_Below, Stochastic_15_Minutes_Crosses_Above, Stochastic_15_Minutes_Crosses_Below, Ema_5_13_Yearly_Crosses_Above, Ema_5_13_Yearly_Crosses_Below, Ema_5_13_Quarterly_Crosses_Above, Ema_5_13_Quarterly_Crosses_Below, Ema_5_13_Monthly_Crosses_Above, Ema_5_13_Monthly_Crosses_Below, Ema_5_13_Weekly_Crosses_Above, Ema_5_13_Weekly_Crosses_Below, Ema_5_13_Daily_Crosses_Above, Ema_5_13_Daily_Crosses_Below, Ema_5_13_4_Hourly_Crosses_Above, Ema_5_13_4_Hourly_Crosses_Below, Ema_5_13_1_Hourly_Crosses_Above, Ema_5_13_1_Hourly_Crosses_Below, Ema_5_13_15_Minutes_Crosses_Above, Ema_5_13_15_Minutes_Crosses_Below, Ema_13_26_Yearly_Crosses_Above, Ema_13_26_Yearly_Crosses_Below, Ema_13_26_Quarterly_Crosses_Above, Ema_13_26_Quarterly_Crosses_Below, Ema_13_26_Monthly_Crosses_Above, Ema_13_26_Monthly_Crosses_Below, Ema_13_26_Weekly_Crosses_Above, Ema_13_26_Weekly_Crosses_Below, Ema_13_26_Daily_Crosses_Above, Ema_13_26_Daily_Crosses_Below, Ema_13_26_4_Hourly_Crosses_Above, Ema_13_26_4_Hourly_Crosses_Below, Ema_13_26_1_Hourly_Crosses_Above, Ema_13_26_1_Hourly_Crosses_Below, Ema_13_26_15_Minutes_Crosses_Above, Ema_13_26_15_Minutes_Crosses_Below, Ema_50_100_Yearly_Crosses_Above, Ema_50_100_Yearly_Crosses_Below, Ema_50_100_Quarterly_Crosses_Above, Ema_50_100_Quarterly_Crosses_Below, Ema_50_100_Monthly_Crosses_Above, Ema_50_100_Monthly_Crosses_Below, Ema_50_100_Weekly_Crosses_Above, Ema_50_100_Weekly_Crosses_Below, Ema_50_100_Daily_Crosses_Above, Ema_50_100_Daily_Crosses_Below, Ema_50_100_4_Hourly_Crosses_Above, Ema_50_100_4_Hourly_Crosses_Below, Ema_50_100_1_Hourly_Crosses_Above, Ema_50_100_1_Hourly_Crosses_Below, Ema_50_100_15_Minutes_Crosses_Above, Ema_50_100_15_Minutes_Crosses_Below, Ema_100_200_Yearly_Crosses_Above, Ema_100_200_Yearly_Crosses_Below, Ema_100_200_Quarterly_Crosses_Above, Ema_100_200_Quarterly_Crosses_Below, Ema_100_200_Monthly_Crosses_Above, Ema_100_200_Monthly_Crosses_Below, Ema_100_200_Weekly_Crosses_Above, Ema_100_200_Weekly_Crosses_Below, Ema_100_200_Daily_Crosses_Above, Ema_100_200_Daily_Crosses_Below, Ema_100_200_4_Hourly_Crosses_Above, Ema_100_200_4_Hourly_Crosses_Below, Ema_100_200_1_Hourly_Crosses_Above, Ema_100_200_1_Hourly_Crosses_Below, Ema_100_200_15_Minutes_Crosses_Above, Ema_100_200_15_Minutes_Crosses_Below, Adx_Yearly_Crosses_Above, Adx_Yearly_Crosses_Below, Adx_Quarterly_Crosses_Above, Adx_Quarterly_Crosses_Below, Adx_Monthly_Crosses_Above, Adx_Monthly_Crosses_Below, Adx_Weekly_Crosses_Above, Adx_Weekly_Crosses_Below, Adx_Daily_Crosses_Above, Adx_Daily_Crosses_Below, Adx_4_Hourly_Crosses_Above, Adx_4_Hourly_Crosses_Below, Adx_1_Hourly_Crosses_Above, Adx_1_Hourly_Crosses_Below, Adx_15_Minutes_Crosses_Above, Adx_15_Minutes_Crosses_Below, Rsi_Yearly_Crosses_Above, Rsi_Yearly_Crosses_Below, Rsi_Quarterly_Crosses_Above, Rsi_Quarterly_Crosses_Below, Rsi_Monthly_Crosses_Above, Rsi_Monthly_Crosses_Below, Rsi_Weekly_Crosses_Above, Rsi_Weekly_Crosses_Below, Rsi_Daily_Crosses_Above, Rsi_Daily_Crosses_Below, Rsi_4_Hourly_Crosses_Above, Rsi_4_Hourly_Crosses_Below, Rsi_1_Hourly_Crosses_Above, Rsi_1_Hourly_Crosses_Below, Rsi_15_Minutes_Crosses_Above, Rsi_15_Minutes_Crosses_Below, Upper_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band3_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band3_Daily_Less_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band3_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band3_Daily_Less_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band2_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band2_Daily_Less_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band2_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band2_Daily_Less_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Volume_Yearly_Greater_Than_Equal_To, Volume_Yearly_Less_Than_Equal_To, Volume_Quarterly_Greater_Than_Equal_To, Volume_Quarterly_Less_Than_Equal_To, Volume_Monthly_Greater_Than_Equal_To, Volume_Monthly_Less_Than_Equal_To, Volume_Weekly_Greater_Than_Equal_To, Volume_Weekly_Less_Than_Equal_To, Volume_Daily_Greater_Than_Equal_To, Volume_Daily_Less_Than_Equal_To, Volume_4_Hourly_Greater_Than_Equal_To, Volume_4_Hourly_Less_Than_Equal_To, Volume_1_Hourly_Greater_Than_Equal_To, Volume_1_Hourly_Less_Than_Equal_To, Volume_15_Minutes_Greater_Than_Equal_To, Volume_15_Minutes_Less_Than_Equal_To, Adx_Up_Tick_Yearly_Greater_Than_Equal_To, Adx_Down_Tick_Yearly_Less_Than_Equal_To, Adx_Up_Tick_Quarterly_Greater_Than_Equal_To, Adx_Down_Tick_Quarterly_Less_Than_Equal_To, Adx_Up_Tick_Monthly_Greater_Than_Equal_To, Adx_Down_Tick_Monthly_Less_Than_Equal_To, Adx_Up_Tick_Weekly_Greater_Than_Equal_To, Adx_Down_Tick_Weekly_Less_Than_Equal_To, Adx_Up_Tick_Daily_Greater_Than_Equal_To, Adx_Down_Tick_Daily_Less_Than_Equal_To, Adx_Up_Tick_4_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_4_Hourly_Less_Than_Equal_To, Adx_Up_Tick_1_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_1_Hourly_Less_Than_Equal_To, Adx_Up_Tick_15_Minutes_Greater_Than_Equal_To, Adx_Down_Tick_15_Minutes_Less_Than_Equal_To)
select Batch_No, Trade_Type_Details_Sum, Segments_Length,Trade_Type, Trade_Type_Details, Trade_Type_Length, Trade_Type_Details_Length, Created_Date, Stock_Name, Segments, Symbol, Percent_Change, Price, Volume, Bullish_Triple_Screen_Strong_Monthly, Bullish_Triple_Screen_Strong_Weekly, Bullish_Triple_Screen_Strong_Daily, Bullish_Triple_Screen_Strong_4_Hourly, Bullish_Triple_Screen_Strong_1_Hourly, Bullish_Triple_Screen_Strong_15_Minutes, Bullish_Triple_Screen_Strong_Correction_Monthly, Bullish_Triple_Screen_Strong_Correction_Weekly, Bullish_Triple_Screen_Strong_Correction_Daily, Bullish_Triple_Screen_Strong_Correction_4_Hourly, Bullish_Triple_Screen_Strong_Correction_1_Hourly, Bullish_Triple_Screen_Strong_Correction_15_Minutes, Bullish_Double_Screen_Strong_Quarterly, Bullish_Double_Screen_Strong_Monthly, Bullish_Double_Screen_Strong_Weekly, Bullish_Double_Screen_Strong_Daily, Bullish_Double_Screen_Strong_4_Hourly, Bullish_Double_Screen_Strong_1_Hourly, Bullish_Double_Screen_Strong_15_Minutes, Bullish_Double_Screen_Strong_Correction_Quarterly, Bullish_Double_Screen_Strong_Correction_Monthly, Bullish_Double_Screen_Strong_Correction_Weekly, Bullish_Double_Screen_Strong_Correction_Daily, Bullish_Double_Screen_Strong_Correction_4_Hourly, Bullish_Double_Screen_Strong_Correction_1_Hourly, Bullish_Double_Screen_Strong_Correction_15_Minutes, Bullish_Single_Screen_Yearly, Bullish_Single_Screen_Quarterly, Bullish_Single_Screen_Monthly, Bullish_Single_Screen_Weekly, Bullish_Single_Screen_Daily, Bullish_Single_Screen_4_Hourly, Bullish_Single_Screen_1_Hourly, Bullish_Single_Screen_15_Minutes, Bearish_Triple_Screen_Strong_Monthly, Bearish_Triple_Screen_Strong_Weekly, Bearish_Triple_Screen_Strong_Daily, Bearish_Triple_Screen_Strong_4_Hourly, Bearish_Triple_Screen_Strong_1_Hourly, Bearish_Triple_Screen_Strong_15_Minutes, Bearish_Triple_Screen_Strong_Correction_Monthly, Bearish_Triple_Screen_Strong_Correction_Weekly, Bearish_Triple_Screen_Strong_Correction_Daily, Bearish_Triple_Screen_Strong_Correction_4_Hourly, Bearish_Triple_Screen_Strong_Correction_1_Hourly, Bearish_Triple_Screen_Strong_Correction_15_Minutes, Bearish_Double_Screen_Strong_Quarterly, Bearish_Double_Screen_Strong_Monthly, Bearish_Double_Screen_Strong_Weekly, Bearish_Double_Screen_Strong_Daily, Bearish_Double_Screen_Strong_4_Hourly, Bearish_Double_Screen_Strong_1_Hourly, Bearish_Double_Screen_Strong_15_Minutes, Bearish_Double_Screen_Strong_Correction_Quarterly, Bearish_Double_Screen_Strong_Correction_Monthly, Bearish_Double_Screen_Strong_Correction_Weekly, Bearish_Double_Screen_Strong_Correction_Daily, Bearish_Double_Screen_Strong_Correction_4_Hourly, Bearish_Double_Screen_Strong_Correction_1_Hourly, Bearish_Double_Screen_Strong_Correction_15_Minutes, Bearish_Single_Screen_Yearly, Bearish_Single_Screen_Quarterly, Bearish_Single_Screen_Monthly, Bearish_Single_Screen_Weekly, Bearish_Single_Screen_Daily, Bearish_Single_Screen_4_Hourly, Bearish_Single_Screen_1_Hourly, Bearish_Single_Screen_15_Minutes, Macd_Yearly_Crosses_Above, Macd_Yearly_Crosses_Below, Macd_Quarterly_Crosses_Above, Macd_Quarterly_Crosses_Below, Macd_Monthly_Crosses_Above, Macd_Monthly_Crosses_Below, Macd_Weekly_Crosses_Above, Macd_Weekly_Crosses_Below, Macd_Daily_Crosses_Above, Macd_Daily_Crosses_Below, Macd_4_Hourly_Crosses_Above, Macd_4_Hourly_Crosses_Below, Macd_1_Hourly_Crosses_Above, Macd_1_Hourly_Crosses_Below, Macd_15_Minutes_Crosses_Above, Macd_15_Minutes_Crosses_Below, Stochastic_Yearly_Crosses_Above, Stochastic_Yearly_Crosses_Below, Stochastic_Quarterly_Crosses_Above, Stochastic_Quarterly_Crosses_Below, Stochastic_Monthly_Crosses_Above, Stochastic_Monthly_Crosses_Below, Stochastic_Weekly_Crosses_Above, Stochastic_Weekly_Crosses_Below, Stochastic_Daily_Crosses_Above, Stochastic_Daily_Crosses_Below, Stochastic_4_Hourly_Crosses_Above, Stochastic_4_Hourly_Crosses_Below, Stochastic_1_Hourly_Crosses_Above, Stochastic_1_Hourly_Crosses_Below, Stochastic_15_Minutes_Crosses_Above, Stochastic_15_Minutes_Crosses_Below, Ema_5_13_Yearly_Crosses_Above, Ema_5_13_Yearly_Crosses_Below, Ema_5_13_Quarterly_Crosses_Above, Ema_5_13_Quarterly_Crosses_Below, Ema_5_13_Monthly_Crosses_Above, Ema_5_13_Monthly_Crosses_Below, Ema_5_13_Weekly_Crosses_Above, Ema_5_13_Weekly_Crosses_Below, Ema_5_13_Daily_Crosses_Above, Ema_5_13_Daily_Crosses_Below, Ema_5_13_4_Hourly_Crosses_Above, Ema_5_13_4_Hourly_Crosses_Below, Ema_5_13_1_Hourly_Crosses_Above, Ema_5_13_1_Hourly_Crosses_Below, Ema_5_13_15_Minutes_Crosses_Above, Ema_5_13_15_Minutes_Crosses_Below, Ema_13_26_Yearly_Crosses_Above, Ema_13_26_Yearly_Crosses_Below, Ema_13_26_Quarterly_Crosses_Above, Ema_13_26_Quarterly_Crosses_Below, Ema_13_26_Monthly_Crosses_Above, Ema_13_26_Monthly_Crosses_Below, Ema_13_26_Weekly_Crosses_Above, Ema_13_26_Weekly_Crosses_Below, Ema_13_26_Daily_Crosses_Above, Ema_13_26_Daily_Crosses_Below, Ema_13_26_4_Hourly_Crosses_Above, Ema_13_26_4_Hourly_Crosses_Below, Ema_13_26_1_Hourly_Crosses_Above, Ema_13_26_1_Hourly_Crosses_Below, Ema_13_26_15_Minutes_Crosses_Above, Ema_13_26_15_Minutes_Crosses_Below, Ema_50_100_Yearly_Crosses_Above, Ema_50_100_Yearly_Crosses_Below, Ema_50_100_Quarterly_Crosses_Above, Ema_50_100_Quarterly_Crosses_Below, Ema_50_100_Monthly_Crosses_Above, Ema_50_100_Monthly_Crosses_Below, Ema_50_100_Weekly_Crosses_Above, Ema_50_100_Weekly_Crosses_Below, Ema_50_100_Daily_Crosses_Above, Ema_50_100_Daily_Crosses_Below, Ema_50_100_4_Hourly_Crosses_Above, Ema_50_100_4_Hourly_Crosses_Below, Ema_50_100_1_Hourly_Crosses_Above, Ema_50_100_1_Hourly_Crosses_Below, Ema_50_100_15_Minutes_Crosses_Above, Ema_50_100_15_Minutes_Crosses_Below, Ema_100_200_Yearly_Crosses_Above, Ema_100_200_Yearly_Crosses_Below, Ema_100_200_Quarterly_Crosses_Above, Ema_100_200_Quarterly_Crosses_Below, Ema_100_200_Monthly_Crosses_Above, Ema_100_200_Monthly_Crosses_Below, Ema_100_200_Weekly_Crosses_Above, Ema_100_200_Weekly_Crosses_Below, Ema_100_200_Daily_Crosses_Above, Ema_100_200_Daily_Crosses_Below, Ema_100_200_4_Hourly_Crosses_Above, Ema_100_200_4_Hourly_Crosses_Below, Ema_100_200_1_Hourly_Crosses_Above, Ema_100_200_1_Hourly_Crosses_Below, Ema_100_200_15_Minutes_Crosses_Above, Ema_100_200_15_Minutes_Crosses_Below, Adx_Yearly_Crosses_Above, Adx_Yearly_Crosses_Below, Adx_Quarterly_Crosses_Above, Adx_Quarterly_Crosses_Below, Adx_Monthly_Crosses_Above, Adx_Monthly_Crosses_Below, Adx_Weekly_Crosses_Above, Adx_Weekly_Crosses_Below, Adx_Daily_Crosses_Above, Adx_Daily_Crosses_Below, Adx_4_Hourly_Crosses_Above, Adx_4_Hourly_Crosses_Below, Adx_1_Hourly_Crosses_Above, Adx_1_Hourly_Crosses_Below, Adx_15_Minutes_Crosses_Above, Adx_15_Minutes_Crosses_Below, Rsi_Yearly_Crosses_Above, Rsi_Yearly_Crosses_Below, Rsi_Quarterly_Crosses_Above, Rsi_Quarterly_Crosses_Below, Rsi_Monthly_Crosses_Above, Rsi_Monthly_Crosses_Below, Rsi_Weekly_Crosses_Above, Rsi_Weekly_Crosses_Below, Rsi_Daily_Crosses_Above, Rsi_Daily_Crosses_Below, Rsi_4_Hourly_Crosses_Above, Rsi_4_Hourly_Crosses_Below, Rsi_1_Hourly_Crosses_Above, Rsi_1_Hourly_Crosses_Below, Rsi_15_Minutes_Crosses_Above, Rsi_15_Minutes_Crosses_Below, Upper_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band3_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band3_Daily_Less_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band3_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band3_Daily_Less_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band2_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band2_Daily_Less_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band2_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band2_Daily_Less_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Volume_Yearly_Greater_Than_Equal_To, Volume_Yearly_Less_Than_Equal_To, Volume_Quarterly_Greater_Than_Equal_To, Volume_Quarterly_Less_Than_Equal_To, Volume_Monthly_Greater_Than_Equal_To, Volume_Monthly_Less_Than_Equal_To, Volume_Weekly_Greater_Than_Equal_To, Volume_Weekly_Less_Than_Equal_To, Volume_Daily_Greater_Than_Equal_To, Volume_Daily_Less_Than_Equal_To, Volume_4_Hourly_Greater_Than_Equal_To, Volume_4_Hourly_Less_Than_Equal_To, Volume_1_Hourly_Greater_Than_Equal_To, Volume_1_Hourly_Less_Than_Equal_To, Volume_15_Minutes_Greater_Than_Equal_To, Volume_15_Minutes_Less_Than_Equal_To, Adx_Up_Tick_Yearly_Greater_Than_Equal_To, Adx_Down_Tick_Yearly_Less_Than_Equal_To, Adx_Up_Tick_Quarterly_Greater_Than_Equal_To, Adx_Down_Tick_Quarterly_Less_Than_Equal_To, Adx_Up_Tick_Monthly_Greater_Than_Equal_To, Adx_Down_Tick_Monthly_Less_Than_Equal_To, Adx_Up_Tick_Weekly_Greater_Than_Equal_To, Adx_Down_Tick_Weekly_Less_Than_Equal_To, Adx_Up_Tick_Daily_Greater_Than_Equal_To, Adx_Down_Tick_Daily_Less_Than_Equal_To, Adx_Up_Tick_4_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_4_Hourly_Less_Than_Equal_To, Adx_Up_Tick_1_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_1_Hourly_Less_Than_Equal_To, Adx_Up_Tick_15_Minutes_Greater_Than_Equal_To, Adx_Down_Tick_15_Minutes_Less_Than_Equal_To
from dbo.Analyse_15Minutes_Stocks
;
select 
((LEN(Trade_Type) - LEN(REPLACE(Trade_Type, 'Bullish', ''))) / LEN('Bullish')) as Bullish_Type
,((LEN(Trade_Type) - LEN(REPLACE(Trade_Type, 'Bearish', ''))) / LEN('Bearish')) as Bearish_Type
,case when ((LEN(Trade_Type) - LEN(REPLACE(Trade_Type, 'Bullish', ''))) / LEN('Bullish') ) -
((LEN(Trade_Type) - LEN(REPLACE(Trade_Type, 'Bearish', ''))) / LEN('Bearish')) > 0 then 'Bullish' else 'Bearish' end as TradingView
,*
from dbo.Analyse_Stocks
where Trade_Type_Details_Sum > 10 and Segments_Length > 10
and Batch_No = (select max(batch_no) from dbo.Analyse_Stocks)
order by Batch_No desc,Trade_Type_Details_Sum desc,Trade_Type_Length desc, Trade_Type_Details_Length desc;
;

-- insert into dbo.Analyse_Stocks (Batch_No, Trade_Type_Details_Sum, Segments_Length, Trade_Type, Trade_Type_Length, Trade_Type_Details, Trade_Type_Details_Length, Created_Date, Stock_Name, Segments, Symbol, Percent_Change, Price, Volume, Bullish_Triple_Screen_Strong_Monthly, Bullish_Triple_Screen_Strong_Weekly, Bullish_Triple_Screen_Strong_Daily, Bullish_Triple_Screen_Strong_4_Hourly, Bullish_Triple_Screen_Strong_1_Hourly, Bullish_Triple_Screen_Strong_15_Minutes, Bullish_Triple_Screen_Strong_Correction_Monthly, Bullish_Triple_Screen_Strong_Correction_Weekly, Bullish_Triple_Screen_Strong_Correction_Daily, Bullish_Triple_Screen_Strong_Correction_4_Hourly, Bullish_Triple_Screen_Strong_Correction_1_Hourly, Bullish_Triple_Screen_Strong_Correction_15_Minutes, Bullish_Double_Screen_Strong_Quarterly, Bullish_Double_Screen_Strong_Monthly, Bullish_Double_Screen_Strong_Weekly, Bullish_Double_Screen_Strong_Daily, Bullish_Double_Screen_Strong_4_Hourly, Bullish_Double_Screen_Strong_1_Hourly, Bullish_Double_Screen_Strong_15_Minutes, Bullish_Double_Screen_Strong_Correction_Quarterly, Bullish_Double_Screen_Strong_Correction_Monthly, Bullish_Double_Screen_Strong_Correction_Weekly, Bullish_Double_Screen_Strong_Correction_Daily, Bullish_Double_Screen_Strong_Correction_4_Hourly, Bullish_Double_Screen_Strong_Correction_1_Hourly, Bullish_Double_Screen_Strong_Correction_15_Minutes, Bullish_Single_Screen_Yearly, Bullish_Single_Screen_Quarterly, Bullish_Single_Screen_Monthly, Bullish_Single_Screen_Weekly, Bullish_Single_Screen_Daily, Bullish_Single_Screen_4_Hourly, Bullish_Single_Screen_1_Hourly, Bullish_Single_Screen_15_Minutes, Bearish_Triple_Screen_Strong_Monthly, Bearish_Triple_Screen_Strong_Weekly, Bearish_Triple_Screen_Strong_Daily, Bearish_Triple_Screen_Strong_4_Hourly, Bearish_Triple_Screen_Strong_1_Hourly, Bearish_Triple_Screen_Strong_15_Minutes, Bearish_Triple_Screen_Strong_Correction_Monthly, Bearish_Triple_Screen_Strong_Correction_Weekly, Bearish_Triple_Screen_Strong_Correction_Daily, Bearish_Triple_Screen_Strong_Correction_4_Hourly, Bearish_Triple_Screen_Strong_Correction_1_Hourly, Bearish_Triple_Screen_Strong_Correction_15_Minutes, Bearish_Double_Screen_Strong_Quarterly, Bearish_Double_Screen_Strong_Monthly, Bearish_Double_Screen_Strong_Weekly, Bearish_Double_Screen_Strong_Daily, Bearish_Double_Screen_Strong_4_Hourly, Bearish_Double_Screen_Strong_1_Hourly, Bearish_Double_Screen_Strong_15_Minutes, Bearish_Double_Screen_Strong_Correction_Quarterly, Bearish_Double_Screen_Strong_Correction_Monthly, Bearish_Double_Screen_Strong_Correction_Weekly, Bearish_Double_Screen_Strong_Correction_Daily, Bearish_Double_Screen_Strong_Correction_4_Hourly, Bearish_Double_Screen_Strong_Correction_1_Hourly, Bearish_Double_Screen_Strong_Correction_15_Minutes, Bearish_Single_Screen_Yearly, Bearish_Single_Screen_Quarterly, Bearish_Single_Screen_Monthly, Bearish_Single_Screen_Weekly, Bearish_Single_Screen_Daily, Bearish_Single_Screen_4_Hourly, Bearish_Single_Screen_1_Hourly, Bearish_Single_Screen_15_Minutes, Macd_Yearly_Crosses_Above, Macd_Yearly_Crosses_Below, Macd_Quarterly_Crosses_Above, Macd_Quarterly_Crosses_Below, Macd_Monthly_Crosses_Above, Macd_Monthly_Crosses_Below, Macd_Weekly_Crosses_Above, Macd_Weekly_Crosses_Below, Macd_Daily_Crosses_Above, Macd_Daily_Crosses_Below, Macd_4_Hourly_Crosses_Above, Macd_4_Hourly_Crosses_Below, Macd_1_Hourly_Crosses_Above, Macd_1_Hourly_Crosses_Below, Macd_15_Minutes_Crosses_Above, Macd_15_Minutes_Crosses_Below, Stochastic_Yearly_Crosses_Above, Stochastic_Yearly_Crosses_Below, Stochastic_Quarterly_Crosses_Above, Stochastic_Quarterly_Crosses_Below, Stochastic_Monthly_Crosses_Above, Stochastic_Monthly_Crosses_Below, Stochastic_Weekly_Crosses_Above, Stochastic_Weekly_Crosses_Below, Stochastic_Daily_Crosses_Above, Stochastic_Daily_Crosses_Below, Stochastic_4_Hourly_Crosses_Above, Stochastic_4_Hourly_Crosses_Below, Stochastic_1_Hourly_Crosses_Above, Stochastic_1_Hourly_Crosses_Below, Stochastic_15_Minutes_Crosses_Above, Stochastic_15_Minutes_Crosses_Below, Ema_5_13_Yearly_Crosses_Above, Ema_5_13_Yearly_Crosses_Below, Ema_5_13_Quarterly_Crosses_Above, Ema_5_13_Quarterly_Crosses_Below, Ema_5_13_Monthly_Crosses_Above, Ema_5_13_Monthly_Crosses_Below, Ema_5_13_Weekly_Crosses_Above, Ema_5_13_Weekly_Crosses_Below, Ema_5_13_Daily_Crosses_Above, Ema_5_13_Daily_Crosses_Below, Ema_5_13_4_Hourly_Crosses_Above, Ema_5_13_4_Hourly_Crosses_Below, Ema_5_13_1_Hourly_Crosses_Above, Ema_5_13_1_Hourly_Crosses_Below, Ema_5_13_15_Minutes_Crosses_Above, Ema_5_13_15_Minutes_Crosses_Below, Ema_13_26_Yearly_Crosses_Above, Ema_13_26_Yearly_Crosses_Below, Ema_13_26_Quarterly_Crosses_Above, Ema_13_26_Quarterly_Crosses_Below, Ema_13_26_Monthly_Crosses_Above, Ema_13_26_Monthly_Crosses_Below, Ema_13_26_Weekly_Crosses_Above, Ema_13_26_Weekly_Crosses_Below, Ema_13_26_Daily_Crosses_Above, Ema_13_26_Daily_Crosses_Below, Ema_13_26_4_Hourly_Crosses_Above, Ema_13_26_4_Hourly_Crosses_Below, Ema_13_26_1_Hourly_Crosses_Above, Ema_13_26_1_Hourly_Crosses_Below, Ema_13_26_15_Minutes_Crosses_Above, Ema_13_26_15_Minutes_Crosses_Below, Ema_50_100_Yearly_Crosses_Above, Ema_50_100_Yearly_Crosses_Below, Ema_50_100_Quarterly_Crosses_Above, Ema_50_100_Quarterly_Crosses_Below, Ema_50_100_Monthly_Crosses_Above, Ema_50_100_Monthly_Crosses_Below, Ema_50_100_Weekly_Crosses_Above, Ema_50_100_Weekly_Crosses_Below, Ema_50_100_Daily_Crosses_Above, Ema_50_100_Daily_Crosses_Below, Ema_50_100_4_Hourly_Crosses_Above, Ema_50_100_4_Hourly_Crosses_Below, Ema_50_100_1_Hourly_Crosses_Above, Ema_50_100_1_Hourly_Crosses_Below, Ema_50_100_15_Minutes_Crosses_Above, Ema_50_100_15_Minutes_Crosses_Below, Ema_100_200_Yearly_Crosses_Above, Ema_100_200_Yearly_Crosses_Below, Ema_100_200_Quarterly_Crosses_Above, Ema_100_200_Quarterly_Crosses_Below, Ema_100_200_Monthly_Crosses_Above, Ema_100_200_Monthly_Crosses_Below, Ema_100_200_Weekly_Crosses_Above, Ema_100_200_Weekly_Crosses_Below, Ema_100_200_Daily_Crosses_Above, Ema_100_200_Daily_Crosses_Below, Ema_100_200_4_Hourly_Crosses_Above, Ema_100_200_4_Hourly_Crosses_Below, Ema_100_200_1_Hourly_Crosses_Above, Ema_100_200_1_Hourly_Crosses_Below, Ema_100_200_15_Minutes_Crosses_Above, Ema_100_200_15_Minutes_Crosses_Below, Adx_Yearly_Crosses_Above, Adx_Yearly_Crosses_Below, Adx_Quarterly_Crosses_Above, Adx_Quarterly_Crosses_Below, Adx_Monthly_Crosses_Above, Adx_Monthly_Crosses_Below, Adx_Weekly_Crosses_Above, Adx_Weekly_Crosses_Below, Adx_Daily_Crosses_Above, Adx_Daily_Crosses_Below, Adx_4_Hourly_Crosses_Above, Adx_4_Hourly_Crosses_Below, Adx_1_Hourly_Crosses_Above, Adx_1_Hourly_Crosses_Below, Adx_15_Minutes_Crosses_Above, Adx_15_Minutes_Crosses_Below, Rsi_Yearly_Crosses_Above, Rsi_Yearly_Crosses_Below, Rsi_Quarterly_Crosses_Above, Rsi_Quarterly_Crosses_Below, Rsi_Monthly_Crosses_Above, Rsi_Monthly_Crosses_Below, Rsi_Weekly_Crosses_Above, Rsi_Weekly_Crosses_Below, Rsi_Daily_Crosses_Above, Rsi_Daily_Crosses_Below, Rsi_4_Hourly_Crosses_Above, Rsi_4_Hourly_Crosses_Below, Rsi_1_Hourly_Crosses_Above, Rsi_1_Hourly_Crosses_Below, Rsi_15_Minutes_Crosses_Above, Rsi_15_Minutes_Crosses_Below, Upper_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band3_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band3_Daily_Less_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band3_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band3_Daily_Less_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band2_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band2_Daily_Less_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band2_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band2_Daily_Less_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Volume_Yearly_Greater_Than_Equal_To, Volume_Yearly_Less_Than_Equal_To, Volume_Quarterly_Greater_Than_Equal_To, Volume_Quarterly_Less_Than_Equal_To, Volume_Monthly_Greater_Than_Equal_To, Volume_Monthly_Less_Than_Equal_To, Volume_Weekly_Greater_Than_Equal_To, Volume_Weekly_Less_Than_Equal_To, Volume_Daily_Greater_Than_Equal_To, Volume_Daily_Less_Than_Equal_To, Volume_4_Hourly_Greater_Than_Equal_To, Volume_4_Hourly_Less_Than_Equal_To, Volume_1_Hourly_Greater_Than_Equal_To, Volume_1_Hourly_Less_Than_Equal_To, Volume_15_Minutes_Greater_Than_Equal_To, Volume_15_Minutes_Less_Than_Equal_To, Adx_Up_Tick_Yearly_Greater_Than_Equal_To, Adx_Down_Tick_Yearly_Less_Than_Equal_To, Adx_Up_Tick_Quarterly_Greater_Than_Equal_To, Adx_Down_Tick_Quarterly_Less_Than_Equal_To, Adx_Up_Tick_Monthly_Greater_Than_Equal_To, Adx_Down_Tick_Monthly_Less_Than_Equal_To, Adx_Up_Tick_Weekly_Greater_Than_Equal_To, Adx_Down_Tick_Weekly_Less_Than_Equal_To, Adx_Up_Tick_Daily_Greater_Than_Equal_To, Adx_Down_Tick_Daily_Less_Than_Equal_To, Adx_Up_Tick_4_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_4_Hourly_Less_Than_Equal_To, Adx_Up_Tick_1_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_1_Hourly_Less_Than_Equal_To, Adx_Up_Tick_15_Minutes_Greater_Than_Equal_To, Adx_Down_Tick_15_Minutes_Less_Than_Equal_To, Trading_View)
select Batch_No, Trade_Type_Details_Sum, Segments_Length, Trade_Type, Trade_Type_Length, Trade_Type_Details, Trade_Type_Details_Length, Created_Date, Stock_Name, Segments, Symbol, Percent_Change, Price, Volume, Bullish_Triple_Screen_Strong_Monthly, Bullish_Triple_Screen_Strong_Weekly, Bullish_Triple_Screen_Strong_Daily, Bullish_Triple_Screen_Strong_4_Hourly, Bullish_Triple_Screen_Strong_1_Hourly, Bullish_Triple_Screen_Strong_15_Minutes, Bullish_Triple_Screen_Strong_Correction_Monthly, Bullish_Triple_Screen_Strong_Correction_Weekly, Bullish_Triple_Screen_Strong_Correction_Daily, Bullish_Triple_Screen_Strong_Correction_4_Hourly, Bullish_Triple_Screen_Strong_Correction_1_Hourly, Bullish_Triple_Screen_Strong_Correction_15_Minutes, Bullish_Double_Screen_Strong_Quarterly, Bullish_Double_Screen_Strong_Monthly, Bullish_Double_Screen_Strong_Weekly, Bullish_Double_Screen_Strong_Daily, Bullish_Double_Screen_Strong_4_Hourly, Bullish_Double_Screen_Strong_1_Hourly, Bullish_Double_Screen_Strong_15_Minutes, Bullish_Double_Screen_Strong_Correction_Quarterly, Bullish_Double_Screen_Strong_Correction_Monthly, Bullish_Double_Screen_Strong_Correction_Weekly, Bullish_Double_Screen_Strong_Correction_Daily, Bullish_Double_Screen_Strong_Correction_4_Hourly, Bullish_Double_Screen_Strong_Correction_1_Hourly, Bullish_Double_Screen_Strong_Correction_15_Minutes, Bullish_Single_Screen_Yearly, Bullish_Single_Screen_Quarterly, Bullish_Single_Screen_Monthly, Bullish_Single_Screen_Weekly, Bullish_Single_Screen_Daily, Bullish_Single_Screen_4_Hourly, Bullish_Single_Screen_1_Hourly, Bullish_Single_Screen_15_Minutes, Bearish_Triple_Screen_Strong_Monthly, Bearish_Triple_Screen_Strong_Weekly, Bearish_Triple_Screen_Strong_Daily, Bearish_Triple_Screen_Strong_4_Hourly, Bearish_Triple_Screen_Strong_1_Hourly, Bearish_Triple_Screen_Strong_15_Minutes, Bearish_Triple_Screen_Strong_Correction_Monthly, Bearish_Triple_Screen_Strong_Correction_Weekly, Bearish_Triple_Screen_Strong_Correction_Daily, Bearish_Triple_Screen_Strong_Correction_4_Hourly, Bearish_Triple_Screen_Strong_Correction_1_Hourly, Bearish_Triple_Screen_Strong_Correction_15_Minutes, Bearish_Double_Screen_Strong_Quarterly, Bearish_Double_Screen_Strong_Monthly, Bearish_Double_Screen_Strong_Weekly, Bearish_Double_Screen_Strong_Daily, Bearish_Double_Screen_Strong_4_Hourly, Bearish_Double_Screen_Strong_1_Hourly, Bearish_Double_Screen_Strong_15_Minutes, Bearish_Double_Screen_Strong_Correction_Quarterly, Bearish_Double_Screen_Strong_Correction_Monthly, Bearish_Double_Screen_Strong_Correction_Weekly, Bearish_Double_Screen_Strong_Correction_Daily, Bearish_Double_Screen_Strong_Correction_4_Hourly, Bearish_Double_Screen_Strong_Correction_1_Hourly, Bearish_Double_Screen_Strong_Correction_15_Minutes, Bearish_Single_Screen_Yearly, Bearish_Single_Screen_Quarterly, Bearish_Single_Screen_Monthly, Bearish_Single_Screen_Weekly, Bearish_Single_Screen_Daily, Bearish_Single_Screen_4_Hourly, Bearish_Single_Screen_1_Hourly, Bearish_Single_Screen_15_Minutes, Macd_Yearly_Crosses_Above, Macd_Yearly_Crosses_Below, Macd_Quarterly_Crosses_Above, Macd_Quarterly_Crosses_Below, Macd_Monthly_Crosses_Above, Macd_Monthly_Crosses_Below, Macd_Weekly_Crosses_Above, Macd_Weekly_Crosses_Below, Macd_Daily_Crosses_Above, Macd_Daily_Crosses_Below, Macd_4_Hourly_Crosses_Above, Macd_4_Hourly_Crosses_Below, Macd_1_Hourly_Crosses_Above, Macd_1_Hourly_Crosses_Below, Macd_15_Minutes_Crosses_Above, Macd_15_Minutes_Crosses_Below, Stochastic_Yearly_Crosses_Above, Stochastic_Yearly_Crosses_Below, Stochastic_Quarterly_Crosses_Above, Stochastic_Quarterly_Crosses_Below, Stochastic_Monthly_Crosses_Above, Stochastic_Monthly_Crosses_Below, Stochastic_Weekly_Crosses_Above, Stochastic_Weekly_Crosses_Below, Stochastic_Daily_Crosses_Above, Stochastic_Daily_Crosses_Below, Stochastic_4_Hourly_Crosses_Above, Stochastic_4_Hourly_Crosses_Below, Stochastic_1_Hourly_Crosses_Above, Stochastic_1_Hourly_Crosses_Below, Stochastic_15_Minutes_Crosses_Above, Stochastic_15_Minutes_Crosses_Below, Ema_5_13_Yearly_Crosses_Above, Ema_5_13_Yearly_Crosses_Below, Ema_5_13_Quarterly_Crosses_Above, Ema_5_13_Quarterly_Crosses_Below, Ema_5_13_Monthly_Crosses_Above, Ema_5_13_Monthly_Crosses_Below, Ema_5_13_Weekly_Crosses_Above, Ema_5_13_Weekly_Crosses_Below, Ema_5_13_Daily_Crosses_Above, Ema_5_13_Daily_Crosses_Below, Ema_5_13_4_Hourly_Crosses_Above, Ema_5_13_4_Hourly_Crosses_Below, Ema_5_13_1_Hourly_Crosses_Above, Ema_5_13_1_Hourly_Crosses_Below, Ema_5_13_15_Minutes_Crosses_Above, Ema_5_13_15_Minutes_Crosses_Below, Ema_13_26_Yearly_Crosses_Above, Ema_13_26_Yearly_Crosses_Below, Ema_13_26_Quarterly_Crosses_Above, Ema_13_26_Quarterly_Crosses_Below, Ema_13_26_Monthly_Crosses_Above, Ema_13_26_Monthly_Crosses_Below, Ema_13_26_Weekly_Crosses_Above, Ema_13_26_Weekly_Crosses_Below, Ema_13_26_Daily_Crosses_Above, Ema_13_26_Daily_Crosses_Below, Ema_13_26_4_Hourly_Crosses_Above, Ema_13_26_4_Hourly_Crosses_Below, Ema_13_26_1_Hourly_Crosses_Above, Ema_13_26_1_Hourly_Crosses_Below, Ema_13_26_15_Minutes_Crosses_Above, Ema_13_26_15_Minutes_Crosses_Below, Ema_50_100_Yearly_Crosses_Above, Ema_50_100_Yearly_Crosses_Below, Ema_50_100_Quarterly_Crosses_Above, Ema_50_100_Quarterly_Crosses_Below, Ema_50_100_Monthly_Crosses_Above, Ema_50_100_Monthly_Crosses_Below, Ema_50_100_Weekly_Crosses_Above, Ema_50_100_Weekly_Crosses_Below, Ema_50_100_Daily_Crosses_Above, Ema_50_100_Daily_Crosses_Below, Ema_50_100_4_Hourly_Crosses_Above, Ema_50_100_4_Hourly_Crosses_Below, Ema_50_100_1_Hourly_Crosses_Above, Ema_50_100_1_Hourly_Crosses_Below, Ema_50_100_15_Minutes_Crosses_Above, Ema_50_100_15_Minutes_Crosses_Below, Ema_100_200_Yearly_Crosses_Above, Ema_100_200_Yearly_Crosses_Below, Ema_100_200_Quarterly_Crosses_Above, Ema_100_200_Quarterly_Crosses_Below, Ema_100_200_Monthly_Crosses_Above, Ema_100_200_Monthly_Crosses_Below, Ema_100_200_Weekly_Crosses_Above, Ema_100_200_Weekly_Crosses_Below, Ema_100_200_Daily_Crosses_Above, Ema_100_200_Daily_Crosses_Below, Ema_100_200_4_Hourly_Crosses_Above, Ema_100_200_4_Hourly_Crosses_Below, Ema_100_200_1_Hourly_Crosses_Above, Ema_100_200_1_Hourly_Crosses_Below, Ema_100_200_15_Minutes_Crosses_Above, Ema_100_200_15_Minutes_Crosses_Below, Adx_Yearly_Crosses_Above, Adx_Yearly_Crosses_Below, Adx_Quarterly_Crosses_Above, Adx_Quarterly_Crosses_Below, Adx_Monthly_Crosses_Above, Adx_Monthly_Crosses_Below, Adx_Weekly_Crosses_Above, Adx_Weekly_Crosses_Below, Adx_Daily_Crosses_Above, Adx_Daily_Crosses_Below, Adx_4_Hourly_Crosses_Above, Adx_4_Hourly_Crosses_Below, Adx_1_Hourly_Crosses_Above, Adx_1_Hourly_Crosses_Below, Adx_15_Minutes_Crosses_Above, Adx_15_Minutes_Crosses_Below, Rsi_Yearly_Crosses_Above, Rsi_Yearly_Crosses_Below, Rsi_Quarterly_Crosses_Above, Rsi_Quarterly_Crosses_Below, Rsi_Monthly_Crosses_Above, Rsi_Monthly_Crosses_Below, Rsi_Weekly_Crosses_Above, Rsi_Weekly_Crosses_Below, Rsi_Daily_Crosses_Above, Rsi_Daily_Crosses_Below, Rsi_4_Hourly_Crosses_Above, Rsi_4_Hourly_Crosses_Below, Rsi_1_Hourly_Crosses_Above, Rsi_1_Hourly_Crosses_Below, Rsi_15_Minutes_Crosses_Above, Rsi_15_Minutes_Crosses_Below, Upper_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band3_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band3_Daily_Less_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band3_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band3_Daily_Less_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band2_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band2_Daily_Less_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band2_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band2_Daily_Less_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Volume_Yearly_Greater_Than_Equal_To, Volume_Yearly_Less_Than_Equal_To, Volume_Quarterly_Greater_Than_Equal_To, Volume_Quarterly_Less_Than_Equal_To, Volume_Monthly_Greater_Than_Equal_To, Volume_Monthly_Less_Than_Equal_To, Volume_Weekly_Greater_Than_Equal_To, Volume_Weekly_Less_Than_Equal_To, Volume_Daily_Greater_Than_Equal_To, Volume_Daily_Less_Than_Equal_To, Volume_4_Hourly_Greater_Than_Equal_To, Volume_4_Hourly_Less_Than_Equal_To, Volume_1_Hourly_Greater_Than_Equal_To, Volume_1_Hourly_Less_Than_Equal_To, Volume_15_Minutes_Greater_Than_Equal_To, Volume_15_Minutes_Less_Than_Equal_To, Adx_Up_Tick_Yearly_Greater_Than_Equal_To, Adx_Down_Tick_Yearly_Less_Than_Equal_To, Adx_Up_Tick_Quarterly_Greater_Than_Equal_To, Adx_Down_Tick_Quarterly_Less_Than_Equal_To, Adx_Up_Tick_Monthly_Greater_Than_Equal_To, Adx_Down_Tick_Monthly_Less_Than_Equal_To, Adx_Up_Tick_Weekly_Greater_Than_Equal_To, Adx_Down_Tick_Weekly_Less_Than_Equal_To, Adx_Up_Tick_Daily_Greater_Than_Equal_To, Adx_Down_Tick_Daily_Less_Than_Equal_To, Adx_Up_Tick_4_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_4_Hourly_Less_Than_Equal_To, Adx_Up_Tick_1_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_1_Hourly_Less_Than_Equal_To, Adx_Up_Tick_15_Minutes_Greater_Than_Equal_To, Adx_Down_Tick_15_Minutes_Less_Than_Equal_To, Trading_View
from dbo.Analyse_Stocks
;

select a.Sno, b.rn, a.Batch_No,b.batchno
-- update a set Batch_No = b.batchno
from dbo.Analyse_15Minutes_Stocks a
inner join (
select ROW_NUMBER() over(partition by created_date order by created_date,Sno) as rn,
dense_rank() over(order by created_date) as batchno, Created_Date,Symbol,Sno
from dbo.Analyse_15Minutes_Stocks order by Created_Date
) b on a.Sno = b.Sno
;
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
select * -- rn,Batch_No,Trading_View,Trade_Type_Details, Stock_Name,Segments,Symbol,Percent_Change,Price,Volume
from (
	select row_number() over(partition by Batch_No, Trading_View, Trade_Type_Details,Stock_Name, Segments, Symbol order by Sno desc) as rn,*
	from dbo.Analyse_15Minutes_Stocks where Batch_No = (select max(batch_no) from dbo.Analyse_15Minutes_Stocks) 
	and Segments_Length > 10 and Trade_Type_Details_Sum > 10
) a where rn = 1
order by Trading_View desc,Trade_Type_Details_Sum desc, Trade_Type_Details_Length desc,Segments_Length desc,Trade_Type_Length desc
;
select rn,Batch_No,Trading_View,Trade_Type_Details, Stock_Name,Segments,Symbol,Percent_Change,Price,Volume
from (
	select row_number() over(partition by Batch_No, Trading_View, Trade_Type_Details,Stock_Name, Segments, Symbol order by Sno desc) as rn ,*
	from dbo.Analyse_Stocks where Batch_No = (select max(batch_no) from dbo.Analyse_Stocks) 
	and Segments_Length > 5 and Trade_Type_Details_Sum > 10 and volume >10000
) a where rn = 1
order by Trading_View desc,Trade_Type_Details_Sum desc, Trade_Type_Details_Length desc,Segments_Length desc,Trade_Type_Length desc
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

select * 
-- update a set Trading_View = case
-- when (((LEN(Trade_Type) - LEN(REPLACE(Trade_Type, 'Bullish', ''))) / LEN('Bullish') ) - ((LEN(Trade_Type) - LEN(REPLACE(Trade_Type, 'Bearish', ''))) / LEN('Bearish')))
-- > 0 then 'Bullish' 
-- when (((LEN(Trade_Type) - LEN(REPLACE(Trade_Type, 'Bullish', ''))) / LEN('Bullish') ) - ((LEN(Trade_Type) - LEN(REPLACE(Trade_Type, 'Bearish', ''))) / LEN('Bearish')))
-- < 0 then 'Bearish' else NULL end
from dbo.Analyse_15Minutes_Stocks a
;
--------------------------------------------------------------------------------------------------------------------------------
select a.Symbol,b.sno,c.Sector,d.Industry,e.ISIN_Code,f.Company_Name,g.Series
from (select distinct symbol from dbo.Stocks_Industry_Sector_Wise) a
left join (
	select Symbol, STRING_AGG(sno, '; ') as sno 
	from (select distinct symbol,sno from dbo.Stocks_Industry_Sector_Wise) a
	group by Symbol) b
on a.Symbol = b.Symbol
left join (
	select Symbol, STRING_AGG(Sector, '; ') as Sector
	from (select distinct symbol,Sector from dbo.Stocks_Industry_Sector_Wise) a
	group by Symbol) c
on a.Symbol = c.Symbol
left join (
	select Symbol, STRING_AGG(Industry, '; ') as Industry
	from (select distinct symbol,Industry from dbo.Stocks_Industry_Sector_Wise) a
	group by Symbol) d
on a.Symbol = d.Symbol
left join (
	select Symbol, STRING_AGG(ISIN_Code, '; ') as ISIN_Code
	from (select distinct symbol,ISIN_Code from dbo.Stocks_Industry_Sector_Wise) a
	group by Symbol) e
on a.Symbol = e.Symbol
left join (
	select Symbol, STRING_AGG(Company_Name, '; ') as Company_Name
	from (select distinct symbol,Company_Name from dbo.Stocks_Industry_Sector_Wise) a
	group by Symbol) f
on a.Symbol = f.Symbol
left join (
	select Symbol, STRING_AGG(Series, '; ') as Series
	from (select distinct symbol,Series from dbo.Stocks_Industry_Sector_Wise) a
	group by Symbol) g
on a.Symbol = g.Symbol
--------------------------------------------------------------------------------------------------------------------------------
-- Example Usage:
SELECT dbo.InitCap('this is a test string');
--------------------------------------------------------------------------------------------------------------------------------
-- CREATE or REPLACE FUNCTION dbo.InitCapWithSpaces_temp(@InputString VARCHAR(MAX))
-- RETURNS VARCHAR(MAX)
-- AS
BEGIN
    DECLARE @Result VARCHAR(MAX) = '';
    DECLARE @WordStart INT = 1;
    DECLARE @WordEnd INT;
    DECLARE @SpacePosition INT;

    IF @InputString IS NULL
        RETURN NULL;

    WHILE @WordStart <= LEN(@InputString)
    BEGIN
        -- Find the next space or end of string
        SET @SpacePosition = ISNULL(NULLIF(CHARINDEX(' ', @InputString, @WordStart), 0), LEN(@InputString) + 1);

        -- Extract the word (or part before space)
        SET @WordEnd = @SpacePosition - 1;

        -- Capitalize the first letter and append
        IF @WordStart <= @WordEnd
        BEGIN
            SET @Result = @Result + UPPER(SUBSTRING(@InputString, @WordStart, 1)) + LOWER(SUBSTRING(@InputString, @WordStart + 1, @WordEnd - @WordStart));
        END

        -- Append the space if there is one
        IF @SpacePosition <= LEN(@InputString)
        BEGIN
            SET @Result = @Result + ' ';
        END

        -- Move to the next word
        SET @WordStart = @SpacePosition + 1;
    END;

    RETURN @Result;
END;

-- Example Usage:
SELECT dbo.InitCapWithSpaces('this  is a  test string');
/*
output
This  Is A  Test String
this  is a  test string
*/
--------------------------------------------------------------------------------------------------------------------------------
SELECT value FROM STRING_SPLIT('apple,banana,orange', ',');
--------------------------------------------------------------------------------------------------------------------------------
select distinct replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace
(replace(replace(replace(replace(replace(replace(
replace(sector,'nifty',' nifty ')
,'_',' '),'birla',' Birla '),'bank',' Bank '),'large',' Large '),'mid',' Mid '),'small',' Small '),'cap',' Cap ')
,'equal',' Equal '),'weighted',' Weighted '),'markets',' Markets '),'select',' Select '),'financail',' Financail ')
,'india',' India '),'manufacturing ',' Manufacturing '),'infrastructure',' Infrastructure '),'service',' Service ')
,'health',' Health '),'care',' Care '),'',''),'Cap ital','capital'),'Groups',' Groups')
-- replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(sector,'nifty','Nifty '),'aditya','Aditya ')
from dbo.Stocks_Industry_Sector_Wise;

select distinct 
dbo.InitCapWithSpaces(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(sector,'5',' 5'),'20',' 20'),'25',' 25'),'30',' 30'),'15',' 15'),'50',' 50'),'100',' 100'),'150',' 150'),'200',' 200'),'250',' 250'),'400',' 400'),'500',' 500'),'aditya',' aditya'),'Age',' Age'),'and',' and'),'auto',' auto'),'Automotive',' Automotive'),'bank',' bank'),'birla',' birla'),'cap',' cap'),'Capital',' Capital'),'care',' care'),'Chemicals',' Chemicals'),'commodities',' commodities'),'consumer',' consumer'),'Consumption',' Consumption'),'Core',' Core'),'Corporate',' Corporate'),'cpse',' cpse'),'durables',' durables'),'E-Commerce',' E-Commerce'),'energy',' energy'),'Equal',' Equal'),'Ev',' Ev'),'exbank',' exbank'),'financail',' financail'),'finance',' finance'),'financial',' financial'),'fmcg',' fmcg'),'gas',' gas'),'Groups',' Groups'),'health',' health'),'Housing',' Housing'),'India',' India'),'indiadigital',' indiadigital'),'infra',' infra'),'Infrastructure',' Infrastructure'),'Internet',' Internet'),'InvITs',' InvITs'),'IPO',' IPO'),'it',' it'),'large',' large'),'Liquid',' Liquid'),'logistics',' logistics'),'MAATR',' MAATR'),'mahindra',' mahindra'),'Manufacturing',' Manufacturing'),'market',' market'),'Markets',' Markets'),'media',' media'),'metal',' metal'),'micro',' micro'),'mid',' mid'),'midcap',' midcap'),'mnc',' mnc'),'mobility',' mobility'),'Multi',' Multi'),'Multicap',' Multicap'),'New',' New'),'next',' next'),'nifty',' nifty'),'non-cyclical',' non-cyclical'),'oil',' oil'),'pharma',' pharma'),'private',' private'),'pse',' pse'),'PSU',' PSU'),'Railways',' Railways'),'realty',' realty'),'REITs',' REITs'),'Rural',' Rural'),'Select',' Select'),'Service',' Service'),'services',' services'),'small',' small'),'sme',' sme'),'tata',' tata'),'telecom',' telecom'),'total',' total'),'Tourism',' Tourism'),'transportation',' transportation'),'Weighted',' Weighted'),'  ',' '))
from dbo.Stocks_Industry_Sector_Wise
--------------------------------------------------------------------------------------------------------------------------------
select a.Symbol,c.Sector,d.Industry,e.ISIN_Code,f.Company_Name,g.Series
-- into dbo.Stocks_Industry_Sector_Wise_distinct
from (select distinct symbol from dbo.Stocks_Industry_Sector_Wise) a
left join (
	select Symbol, STRING_AGG(dbo.InitCapWithSpaces(replace(Sector,'nifty','Nifty ')), '; ') as Sector
	from (select distinct symbol,Sector from dbo.Stocks_Industry_Sector_Wise) a
	group by Symbol) c
on a.Symbol = c.Symbol
left join (
	select Symbol, STRING_AGG(dbo.InitCapWithSpaces(Industry), '; ') as Industry
	from (select distinct symbol,Industry from dbo.Stocks_Industry_Sector_Wise) a
	group by Symbol) d
on a.Symbol = d.Symbol
left join (
	select Symbol, STRING_AGG(ISIN_Code, '; ') as ISIN_Code
	from (select distinct symbol,ISIN_Code from dbo.Stocks_Industry_Sector_Wise) a
	group by Symbol) e
on a.Symbol = e.Symbol
left join (
	select Symbol, STRING_AGG(Company_Name, '; ') as Company_Name
	from (select distinct symbol,Company_Name from dbo.Stocks_Industry_Sector_Wise) a
	group by Symbol) f
on a.Symbol = f.Symbol
left join (
	select Symbol, STRING_AGG(Series, '; ') as Series
	from (select distinct symbol,Series from dbo.Stocks_Industry_Sector_Wise) a
	group by Symbol) g
on a.Symbol = g.Symbol
;
--------------------------------------------------------------------------------------------------------------------------------
select a.Symbol,a.Segments,a.Stock_Name,b.Sector,b.Industry,b.ISIN_Code,b.Company_Name,b.Series
into dbo.Master_Stocks_In_Segments1
from dbo.Master_Stocks_In_Segments a
left join dbo.Stocks_Industry_Sector_Wise_distinct b
on a.Symbol = b.Symbol;
--------------------------------------------------------------------------------------------------------------------------------
;WITH CTE AS (
    SELECT
		symbol,
        ROW_NUMBER() OVER (ORDER BY len(Segments) desc) AS sno
    FROM dbo.Master_Stocks_In_Segments
)
-- UPDATE dbo.Master_Stocks_In_Segments SET sno = CTE.sno
select *
FROM dbo.Master_Stocks_In_Segments
JOIN CTE
ON dbo.Master_Stocks_In_Segments.Symbol = CTE.Symbol;
--------------------------------------------------------------------------------------------------------------------------------
-- update a set Industry = b.Industry ,ISIN_Code = b.ISIN_Code ,Series = b.Series
select * 
from dbo.Analyse_15Minutes_Stocks a
inner join dbo.Master_Stocks_In_Segments b
on a.Symbol = b.Symbol;
--------------------------------------------------------------------------------------------------------------------------------
select distinct segments from (
	select symbol,segments
	,STRING_AGG(segments, ';') WITHIN GROUP (ORDER BY segments) AS SortedString 
	,len(segments) as len_of_segments
	from dbo.Master_Stocks_In_Segments
	where len(segments)  > 14
	group by symbol,segments
-- order by 4
) a ;

--------------------------------------------------------------------------------------------------------------------------------
select distinct segments,len(segments)
-- ,ltrim(rtrim(STUFF(segments, 1, 1, ''))) as SegmentedFormated
from dbo.Master_Stocks_In_Segments
where len(segments) > 5 
order by len(segments);
--------------------------------------------------------------------------------------------------------------------------------
SELECT STUFF(segments, 1, 1, '') AS ModifiedString FROM YourTable;
--------------------------------------------------------------------------------------------------------------------------------
SELECT distinct trim(value) AS SplitValue
FROM dbo.Master_Stocks_In_Segments
CROSS APPLY STRING_SPLIT(segments, ';')
order by 1;
--------------------------------------------------------------------------------------------------------------------------------
select a.Sno,a.Sector,a.Sector Value
from dbo.Sector_Table a
inner join (
	SELECT distinct trim(value) AS sector
	FROM dbo.Master_Stocks_In_Segments
	CROSS APPLY STRING_SPLIT(segments, ';')
) b on a.sector = b.sector
order by 1
;
--------------------------------------------------------------------------------------------------------------------------------
select * 
-- update a set Segments = b.Segments 
from dbo.Analyse_Stocks a
inner join dbo.Master_Stocks_In_Segments b
on a.Symbol = b.Symbol;

--------------------------------------------------------------------------------------------------------------------------------
-- update dbo.Master_Stocks_In_Segments set Segments = replace(segments,'  ',' ');
--------------------------------------------------------------------------------------------------------------------------------
--select * from dbo.Master_Stocks_In_Segments
;with cte as 
(	select b.Symbol,a.Sno,a.Sector,a.Sector Value as sector_value
	from dbo.Sector_Table a
	inner join 
	(	SELECT distinct trim(value) AS sector,Symbol
		FROM dbo.Master_Stocks_In_Segments
		CROSS APPLY STRING_SPLIT(segments, ';')
	) b on a.sector = b.sector -- order by b.Symbol,a.Sno
)
select a.Symbol,a.sector_aggerate,b.Segments,b.sector_order,a.sector_max,b.sector_sum,a.sector_sum
-- update b set b.Segments = a.sector_aggerate,b.sector_order = a.sector_max,b.sector_sum = a.sector_sum
from (
select symbol
,STRING_AGG(Sector, ';') WITHIN GROUP (ORDER BY sno) as sector_aggerate
,max(sector_value) as sector_max
,sum(sector_value) as sector_sum
from cte
group by symbol
) a
inner join dbo.Master_Stocks_In_Segments b
on a.Symbol = b.Symbol
;
--------------------------------------------------------------------------------------------------------------------------------
select a.Symbol,a.Segments,b.Segments,a.sector_order,b.sector_order,a.sector_sum,b.sector_sum
-- update a set a.Segments = b.Segments,a.sector_order = b.sector_order,a.sector_sum = b.sector_sum
from dbo.Analyse_Stocks a
inner join dbo.Master_Stocks_In_Segments b
on a.Symbol = b.Symbol;
--------------------------------------------------------------------------------------------------------------------------------
select distinct symbol,indicator,timeline,direction, segment,batch_no 
from dbo.Cash_Stocks 
where Batch_No = (select max(batch_no) from dbo.Cash_Stocks)
and indicator like 'Price action%' and timeline = 'daily'
order by symbol,timeline, indicator,direction
;

select STRING_AGG(cast(replace(replace(indicator,'price action ',''),' candle','') as int), '; ') 
within group (order by symbol,cast(replace(replace(indicator,'price action ',''),' candle','') as int),
timeline,direction,segment,batch_no) as indicator_aggregate
,symbol,timeline,direction,segment,batch_no
from dbo.Cash_Stocks 
where  Batch_No = (select max(batch_no) from dbo.Cash_Stocks) 
and indicator like '%price action%' 
and timeline = 'yearly' 
and Direction like 'greater than%'
group by symbol,timeline,direction,segment,batch_no

-- update a set indicator = replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(Indicator,'year','candle'),'quarter','candle'),'month','candle'),'week','candle'),'day','candle'),'hour','candle'),'minute','candle'),'4 candle','candle'),'1 candle','candle'),'15 candle','candle')
select *
from dbo.Cash_Stocks
where  1=1 
and batch_no = ( select max(Batch_No) from dbo.Cash_Stocks )
and indicator like 'Price Action%'
-- and (indicator like '0%' or indicator like '1%' or indicator like '2%' or indicator like '3%' or indicator like '4%' or indicator like '5%' or indicator like '6%' or indicator like '7%' or indicator like '8%' or indicator like '9%')
-- and direction like '%than equal to%' 
order by 1;

select * from dbo.Cash_15Minutes_Stocks
where batch_no = ( select max(Batch_No) from dbo.Cash_15Minutes_Stocks );

select * from dbo.Analyse_Stocks;
--------------------------------------------------------------------------------------------------------------------------------
;WITH AggregatedValues AS (
    SELECT 
        symbol,
        timeline,
        direction,
        segment,
        batch_no,
        CASE 
            WHEN direction LIKE 'less than equal to%' THEN 
                -1 * CAST(REPLACE(REPLACE(indicator, 'price action ', ''), ' candle', '') AS INT)
            ELSE 
                CAST(REPLACE(REPLACE(indicator, 'price action ', ''), ' candle', '') AS INT)
        END AS adjusted_value
    FROM 
        dbo.Cash_Stocks
    WHERE 
        batch_no = (SELECT MAX(batch_no) FROM dbo.Cash_Stocks)
        AND indicator LIKE '%price action%'
),
Grouped AS (
    SELECT 
        symbol,
        timeline,
        direction,
        segment,
        batch_no,
        adjusted_value
    FROM AggregatedValues
),
Formatted AS (
    SELECT 
        symbol,
        batch_no,
        timeline,
        direction,
        STRING_AGG(adjusted_value, ', ') 
            WITHIN GROUP (ORDER BY adjusted_value) AS value_list,
        CASE timeline
            WHEN 'yearly' THEN 1
            WHEN 'half-yearly' THEN 2
            WHEN 'quarterly' THEN 3
            WHEN 'monthly' THEN 4
            ELSE 5
        END AS timeline_order
    FROM Grouped
    GROUP BY symbol, batch_no, timeline, direction
)
SELECT 
    symbol,
    batch_no,
    STRING_AGG(
        CONCAT(
            '', 
            timeline, '-', 
            REPLACE(REPLACE(REPLACE(direction, 
                'greater than equal to', '>='), 
                'less than equal to', '<='), 
                'equal to', '='), 
            ' - ', value_list, ''
        ), 
        ' '
    ) WITHIN GROUP (ORDER BY timeline_order, direction) AS price_action_aggregate
FROM Formatted
GROUP BY symbol, batch_no;
--------------------------------------------------------------------------------------------------------------------------------
;WITH AdjustedValues AS (
    SELECT 
        symbol,
        timeline,
        direction,
        segment,
        batch_no,
        CASE 
            WHEN direction LIKE 'less than equal to%' THEN 
                -1 * CAST(REPLACE(REPLACE(indicator, 'price action ', ''), ' candle', '') AS INT)
            ELSE 
                CAST(REPLACE(REPLACE(indicator, 'price action ', ''), ' candle', '') AS INT)
        END AS adjusted_value
    FROM 
        dbo.Cash_Stocks
    WHERE 
        batch_no = (SELECT MAX(batch_no) FROM dbo.Cash_Stocks)
        AND indicator LIKE '%price action%'
),
Grouped AS (
    SELECT 
        symbol,
        timeline,
        direction,
        segment,
        batch_no,
        adjusted_value
    FROM AdjustedValues
),
Formatted AS (
    SELECT 
        symbol,
        batch_no,
        timeline,
        direction,
        STRING_AGG(adjusted_value, ', ') 
            WITHIN GROUP (ORDER BY adjusted_value) AS value_list,
        CASE timeline
            WHEN 'yearly' THEN 1
            WHEN 'half-yearly' THEN 2
            WHEN 'quarterly' THEN 3
            WHEN 'monthly' THEN 4
            ELSE 5
        END AS timeline_order
    FROM Grouped
    GROUP BY symbol, batch_no, timeline, direction
)
SELECT 
    symbol,
    batch_no,
    STRING_AGG(
        CONCAT(
            '', 
            timeline, ' ', 
            REPLACE(REPLACE(REPLACE(direction, 
                'greater than equal to', '>='), 
                'less than equal to', '<='), 
                'equal to', '='), 
            ' ', value_list, ''
        ), 
        ' '
    ) WITHIN GROUP (ORDER BY timeline_order, direction) AS price_action_aggregate
FROM Formatted
GROUP BY symbol, batch_no;
--------------------------------------------------------------------------------------------------------------------------------
/*combine the greater than and less than value at each timeline ie., yearly 1,2,3,-4,-5,6,-8,10,-11 here minus appended number will give me that less than or equal to and positive number will give me the greater than equal to*/
;WITH AdjustedValues AS (
    SELECT 
        symbol,
        timeline,
        batch_no,
        CASE 
            WHEN direction LIKE 'less than equal to%' THEN 
                -1 * CAST(REPLACE(REPLACE(indicator, 'price action ', ''), ' candle', '') AS INT)
            WHEN direction LIKE 'greater than equal to%' THEN 
                CAST(REPLACE(REPLACE(indicator, 'price action ', ''), ' candle', '') AS INT)
            ELSE NULL
        END AS adjusted_value
    FROM 
        dbo.Cash_Stocks
    WHERE 
        batch_no = (SELECT MAX(batch_no) FROM dbo.Cash_Stocks)
        AND indicator LIKE '%price action%'
        AND (direction LIKE 'greater than equal to%' OR direction LIKE 'less than equal to%')
),
Grouped AS (
    SELECT 
        symbol,
        timeline,
        batch_no,
        adjusted_value
    FROM AdjustedValues
    WHERE adjusted_value IS NOT NULL
),
Formatted AS (
    SELECT 
        symbol,
        timeline,
        batch_no,
        STRING_AGG(adjusted_value, ', ') 
            WITHIN GROUP (ORDER BY adjusted_value) AS value_list,
        CASE timeline
            WHEN 'yearly' THEN 1
            WHEN 'half-yearly' THEN 2
            WHEN 'quarterly' THEN 3
            WHEN 'monthly' THEN 4
            ELSE 5
        END AS timeline_order
    FROM Grouped
    GROUP BY symbol, timeline, batch_no
)
SELECT 
    symbol,
    batch_no,
    STRING_AGG(
        CONCAT('', timeline, ' ', value_list, ''), 
        ' '
    ) WITHIN GROUP (ORDER BY timeline_order) AS price_action_aggregate
FROM Formatted
GROUP BY symbol, batch_no;
--------------------------------------------------------------------------------------------------------------------------------
;WITH AdjustedValues AS (
    SELECT 
        symbol,
        timeline,
        batch_no,
        CASE 
            WHEN direction LIKE 'less than equal to%' THEN 
                -1 * CAST(REPLACE(REPLACE(indicator, 'price action ', ''), ' candle', '') AS INT)
            WHEN direction LIKE 'greater than equal to%' THEN 
                CAST(REPLACE(REPLACE(indicator, 'price action ', ''), ' candle', '') AS INT)
            ELSE NULL
        END AS adjusted_value
    FROM 
        dbo.Cash_Stocks
    WHERE 
        batch_no = (SELECT MAX(batch_no) FROM dbo.Cash_Stocks)
        AND indicator LIKE '%price action%'
        AND (direction LIKE 'greater than equal to%' OR direction LIKE 'less than equal to%')
),
Grouped AS (
    SELECT 
        symbol,
        timeline,
        batch_no,
        adjusted_value
    FROM AdjustedValues
    WHERE adjusted_value IS NOT NULL
),
Formatted AS (
    SELECT 
        symbol,
        timeline,
        batch_no,
        STRING_AGG(adjusted_value, ', ') 
            WITHIN GROUP (ORDER BY ABS(adjusted_value)) AS value_list,
        CASE timeline
            WHEN 'yearly' THEN 1
            WHEN 'half-yearly' THEN 2
            WHEN 'quarterly' THEN 3
            WHEN 'monthly' THEN 4
            WHEN 'weekly' THEN 5
            WHEN 'daily' THEN 6
            WHEN '4 hourly' THEN 7
            WHEN '1 hourly' THEN 8
            WHEN '15 minutes' THEN 9
            ELSE 10
        END AS timeline_order
    FROM Grouped
    GROUP BY symbol, timeline, batch_no
)
SELECT 
    symbol,
    batch_no,
    STRING_AGG(
        CONCAT('', timeline, ' ', value_list, ''), 
        ' '
    ) WITHIN GROUP (ORDER BY timeline_order) AS price_action_aggregate
FROM Formatted
GROUP BY symbol, batch_no;
--------------------------------------------------------------------------------------------------------------------------------
;WITH AdjustedValues AS (
    SELECT 
        symbol,
        timeline,
        batch_no,
        CASE 
            WHEN direction LIKE 'less than equal to%' THEN 'less'
            WHEN direction LIKE 'greater than equal to%' THEN 'greater'
            ELSE NULL
        END AS direction_type,
        CASE 
            WHEN direction LIKE 'less than equal to%' THEN 
                -1 * CAST(REPLACE(REPLACE(indicator, 'price action ', ''), ' candle', '') AS INT)
            WHEN direction LIKE 'greater than equal to%' THEN 
                CAST(REPLACE(REPLACE(indicator, 'price action ', ''), ' candle', '') AS INT)
            ELSE NULL
        END AS adjusted_value
    FROM 
        dbo.Cash_Stocks
    WHERE 
        batch_no = (SELECT MAX(batch_no) FROM dbo.Cash_Stocks)
        AND indicator LIKE '%price action%'
        AND (direction LIKE 'greater than equal to%' OR direction LIKE 'less than equal to%')
),
Grouped AS (
    SELECT 
        symbol,
        timeline,
        batch_no,
        direction_type,
        adjusted_value
    FROM AdjustedValues
    WHERE adjusted_value IS NOT NULL
),
Formatted AS (
    SELECT 
        symbol,
        timeline,
        batch_no,
        direction_type,
        STRING_AGG(adjusted_value, ', ') 
            WITHIN GROUP (ORDER BY ABS(adjusted_value)) AS value_list,
        CASE timeline
            WHEN 'yearly' THEN 1
            WHEN 'half-yearly' THEN 2
            WHEN 'quarterly' THEN 3
            WHEN 'monthly' THEN 4
            WHEN 'weekly' THEN 5
            WHEN 'daily' THEN 6
            WHEN '4 hourly' THEN 7
            WHEN '1 hourly' THEN 8
            WHEN '15 minutes' THEN 9
            ELSE 10
        END AS timeline_order
    FROM Grouped
    GROUP BY symbol, timeline, batch_no, direction_type
)
SELECT 
    symbol,
    batch_no,
    STRING_AGG(
        CONCAT('', timeline, ' ', direction_type, ' ', value_list, ''), 
        ' '
    ) WITHIN GROUP (ORDER BY timeline_order, direction_type) AS price_action_aggregate
FROM Formatted
GROUP BY symbol, batch_no;
--------------------------------------------------------------------------------------------------------------------------------
;WITH AdjustedValues AS (
    SELECT 
        symbol,
        timeline,
        batch_no,
        CASE 
            WHEN direction LIKE 'less than equal to%' THEN 'less'
            WHEN direction LIKE 'greater than equal to%' THEN 'greater'
            ELSE NULL
        END AS direction_type,
        CASE 
            WHEN direction LIKE 'less than equal to%' THEN 
                -1 * CAST(REPLACE(REPLACE(indicator, 'price action ', ''), ' candle', '') AS INT)
            WHEN direction LIKE 'greater than equal to%' THEN 
                CAST(REPLACE(REPLACE(indicator, 'price action ', ''), ' candle', '') AS INT)
            ELSE NULL
        END AS adjusted_value
    FROM dbo.Cash_Stocks
    WHERE 
        batch_no = (SELECT MAX(batch_no) FROM dbo.Cash_Stocks)
        AND indicator LIKE '%price action%'
        AND (direction LIKE 'greater than equal to%' OR direction LIKE 'less than equal to%')
),
Formatted AS (
    SELECT 
        symbol,
        batch_no,
        timeline,
        direction_type,
        COUNT(*) AS value_count,
        STRING_AGG(adjusted_value, ', ') 
            WITHIN GROUP (ORDER BY ABS(adjusted_value)) AS value_list,
        CASE timeline
            WHEN 'yearly' THEN 1
            WHEN 'half-yearly' THEN 2
            WHEN 'quarterly' THEN 3
            WHEN 'monthly' THEN 4
            WHEN 'weekly' THEN 5
            WHEN 'daily' THEN 6
            WHEN '4 hourly' THEN 7
            WHEN '1 hourly' THEN 8
            WHEN '15 minutes' THEN 9
            ELSE 10
        END AS timeline_order
    FROM AdjustedValues
    WHERE adjusted_value IS NOT NULL
    GROUP BY symbol, batch_no, timeline, direction_type
),
Combined AS (
    SELECT 
        symbol,
        batch_no,
        timeline_order,
        timeline,
        STRING_AGG(
            CONCAT(timeline, ' (', value_count, ') ', value_list), 
            ' ; '
        ) AS timeline_line
    FROM Formatted
    GROUP BY symbol, batch_no, timeline, timeline_order
)
SELECT 
    symbol,
    batch_no,
    STRING_AGG(timeline_line, CHAR(10)) 
        WITHIN GROUP (ORDER BY timeline_order) AS price_action_aggregate
FROM Combined
GROUP BY symbol, batch_no;
--------------------------------------------------------------------------------------------------------------------------------
-- ==============================================================================================================================
-- final query for price action
;WITH AdjustedValues AS (
    SELECT 
        symbol,
        timeline,
        batch_no,
        CASE 
            WHEN direction LIKE 'less than equal to%' THEN 'less'
            WHEN direction LIKE 'greater than equal to%' THEN 'greater'
            ELSE NULL
        END AS direction_type,
        CASE 
            WHEN direction LIKE 'less than equal to%' THEN 
                -1 * CAST(REPLACE(REPLACE(indicator, 'price action ', ''), ' candle', '') AS INT)
            WHEN direction LIKE 'greater than equal to%' THEN 
                CAST(REPLACE(REPLACE(indicator, 'price action ', ''), ' candle', '') AS INT)
            ELSE NULL
        END AS adjusted_value
    FROM dbo.Cash_Stocks
    WHERE 
        batch_no = (SELECT MAX(batch_no) FROM dbo.Cash_Stocks)
        AND indicator LIKE '%price action%'
        AND (direction LIKE 'greater than equal to%' OR direction LIKE 'less than equal to%')
),
Formatted AS (
    SELECT 
        symbol,
        batch_no,
        timeline,
        direction_type,
        COUNT(*) AS value_count,
        STRING_AGG(adjusted_value, ', ') 
            WITHIN GROUP (ORDER BY ABS(adjusted_value)) AS value_list,
        CASE timeline
            WHEN 'yearly' THEN 1
            WHEN 'half-yearly' THEN 2
            WHEN 'quarterly' THEN 3
            WHEN 'monthly' THEN 4
            WHEN 'weekly' THEN 5
            WHEN 'daily' THEN 6
            WHEN '4 hourly' THEN 7
            WHEN '1 hourly' THEN 8
            WHEN '15 minutes' THEN 9
            ELSE 10
        END AS timeline_order
    FROM AdjustedValues
    WHERE adjusted_value IS NOT NULL
    GROUP BY symbol, batch_no, timeline, direction_type
),
Pivoted AS (
    SELECT 
        symbol,
        batch_no,
        timeline,
        timeline_order,
        MAX(CASE WHEN direction_type = 'greater' THEN 
            CONCAT(timeline, ' +(', value_count, ') ', value_list) END) AS greater_line,
        MAX(CASE WHEN direction_type = 'less' THEN 
            CONCAT(timeline, ' -(', value_count, ') ', value_list) END) AS less_line
    FROM Formatted
    GROUP BY symbol, batch_no, timeline, timeline_order
),
Combined AS (
    SELECT 
        symbol,
        batch_no,
        timeline_order,
        CONCAT_WS(' ; ', greater_line, less_line) AS timeline_line
    FROM Pivoted
)
SELECT 
    symbol,
    batch_no,
    STRING_AGG(timeline_line, ' ;; ') 
        WITHIN GROUP (ORDER BY timeline_order) AS price_action_aggregate
FROM Combined
GROUP BY symbol, batch_no;
--==============================================================================================================================
-- alter table dbo.Analyse_15Minutes_Stocks add price_action varchar(max)
--------------------------------------------------------------------------------------------------------------------------------
-- price action 
;WITH AdjustedValues AS (
    SELECT 
        symbol,
        timeline,
        batch_no,
        CASE 
            WHEN direction LIKE 'less than equal to%' THEN 
                -1 * CAST(REPLACE(REPLACE(indicator, 'price action ', ''), ' candle', '') AS INT)
            WHEN direction LIKE 'greater than equal to%' THEN 
                CAST(REPLACE(REPLACE(indicator, 'price action ', ''), ' candle', '') AS INT)
            ELSE NULL
        END AS adjusted_value
    FROM 
        dbo.Cash_Stocks
    WHERE 1=1
        -- AND batch_no = (SELECT MAX(batch_no) FROM dbo.Cash_Stocks)
        AND indicator LIKE '%price action%'
        AND (direction LIKE 'greater than equal to%' OR direction LIKE 'less than equal to%')

),
Grouped AS (
    SELECT 
        symbol,
        timeline,
        batch_no,
        adjusted_value
    FROM AdjustedValues
    WHERE adjusted_value IS NOT NULL
),
Formatted AS (
    SELECT 
        symbol,
        timeline,
        batch_no,
        STRING_AGG(adjusted_value, ', ') 
            WITHIN GROUP (ORDER BY ABS(adjusted_value)) AS value_list,
        CASE timeline
            WHEN 'yearly' THEN 1
            WHEN 'half-yearly' THEN 2
            WHEN 'quarterly' THEN 3
            WHEN 'monthly' THEN 4
            WHEN 'weekly' THEN 5
            WHEN 'daily' THEN 6
            WHEN '4 hourly' THEN 7
            WHEN '1 hourly' THEN 8
            WHEN '15 minutes' THEN 9
            ELSE 10
        END AS timeline_order
    FROM Grouped
    GROUP BY symbol, timeline, batch_no
), 
Price_Action_Final as ( 
	SELECT 
		symbol,
		batch_no,
		replace('{' + STRING_AGG(
			CONCAT('"', timeline,'" : ', value_list, ','), 
			' '
		) WITHIN GROUP (ORDER BY timeline_order) + '}',',}','}') AS price_action_aggregate 
	FROM Formatted
	GROUP BY symbol, batch_no
)
select * 
-- Update a set a.price_action = price_action_aggregate
from dbo.Analyse_15Minutes_Stocks a join Price_Action_Final b 
on a.Symbol = b.symbol and a.Batch_No = b.batch_no
;
--------------------------------------------------------------------------------------------------------------------------------
-- select batch_no, symbol, created_date, price_action from dbo.Analyse_Stocks
DECLARE @json NVARCHAR(MAX) = '{"yearly" : 0, -1, 2, -3, 4, 5, -6, -7, 8, 9, -10, 11, -12, -13, -14, -15, 16, -17, 18, -19, "quarterly" : 0, -1, -2, -3, -4, -5, 6, 7, 8, -9, -10, 11, -12, -13, 14, -15, 16, 17, 18, 19, 20, -21, -22, -23, -24, 25, 26, -27, -28, -29, 30, "monthly" : 0, 1, 2, -3, -4, 5, -6, 7, -8, -9, -10, 11, 12, -13, -14, -15, -16, 17, 18, 19, -20, 21, -22, 23, 24, -25, 26, -27, -28, -29, -30, "weekly" : 0, 1, -2, -3, -4, 5, -6, -7, 8, 9, -10, 11, -12, 13, -14, 15, -16, -17, -18, 19, 20, -21, 22, -23, 24, -25, -26, 27, 28, 29, -30, "daily" : 0, -1, -2, -3, 4, -5, -6, 7, 8, 9, 10, -11, -12, -13, 14, -15, -16, 17, -18, 19, 20, -21, -22, -23, -24, -25, 26, 27, 28, 29, 30, "4 hourly" : 0, 1, -2, -3, -4, -5, 6, 7, 8, -9, 10, -11, -12, -13, -14, 15, -16, 17, -18, 19, 20, -21, -22, 23, 24, -25, -26, -27, -28, 29, 30, "1 hourly" : 0, 1, 2, -3, 4, 5, 6, -7, 8, 9, -10, -11, -12, -13, -14, 15, -16, -17, 18, -19, -20, 21, -22, -23, -24, -25, 26, 27, -28, 29, 30, "15 minute" : 0, 1, 2, -3, 4, 5, -6, 7, 8, -9, -10, -11, -12, -13, 14, 15, -16, 17, -18, -19, 20, 21, 22, -23, 24, -25, -26, 27, -28, 29, 30}';
SELECT 
    outerJson.key AS Timeframe,
    innerJson.value AS Value
FROM OPENJSON(@json) AS outerJson
CROSS APPLY OPENJSON(outerJson.value) AS innerJson;
;
--------------------------------------------------------------------------------------------------------------------------------
-- price action 
;WITH AdjustedValues AS (
    SELECT 
        symbol,
        timeline,
        batch_no,
        CASE 
            WHEN direction LIKE 'less than equal to%' THEN 
                -1 * CAST(REPLACE(REPLACE(indicator, 'price action ', ''), ' candle', '') AS INT)
            WHEN direction LIKE 'greater than equal to%' THEN 
                CAST(REPLACE(REPLACE(indicator, 'price action ', ''), ' candle', '') AS INT)
            ELSE NULL
        END AS adjusted_value
    FROM 
        dbo.Cash_Stocks
    WHERE 1=1
        -- AND batch_no = (SELECT MAX(batch_no) FROM dbo.Cash_Stocks)
        AND indicator LIKE '%price action%'
        AND (direction LIKE 'greater than equal to%' OR direction LIKE 'less than equal to%')

),
Grouped AS (
    SELECT 
        symbol,
        timeline,
        batch_no,
        adjusted_value
    FROM AdjustedValues
    WHERE adjusted_value IS NOT NULL
),
Formatted AS (
    SELECT 
        symbol,
        timeline,
        batch_no,
        STRING_AGG(adjusted_value, ', ') 
            WITHIN GROUP (ORDER BY ABS(adjusted_value)) AS value_list,
        CASE timeline
            WHEN 'yearly' THEN 1
            WHEN 'half-yearly' THEN 2
            WHEN 'quarterly' THEN 3
            WHEN 'monthly' THEN 4
            WHEN 'weekly' THEN 5
            WHEN 'daily' THEN 6
            WHEN '4 hourly' THEN 7
            WHEN '1 hourly' THEN 8
            WHEN '15 minutes' THEN 9
            ELSE 10
        END AS timeline_order
    FROM Grouped
    GROUP BY symbol, timeline, batch_no
), 
Price_Action_Final as ( 
	SELECT 
		symbol,
		batch_no,
		replace('{' + STRING_AGG(
			CONCAT('"', timeline,'" : ', value_list, ','), 
			' '
		) WITHIN GROUP (ORDER BY timeline_order) + '}',',}','}') AS price_action_aggregate 
	FROM Formatted
	GROUP BY symbol, batch_no
)
select * 
-- Update a set a.price_action = price_action_aggregate
from dbo.Analyse_15Minutes_Stocks a join Price_Action_Final b 
on a.Symbol = b.symbol and a.Batch_No = b.batch_no
;
--------------------------------------------------------------------------------------------------------------------------------
INSERT INTO dbo.Analyse_15Minutes_Stocks__Price_Action_table (Row_id,Batch_no,symbol, Timeframe, Value)
SELECT ROW_NUMBER() OVER (PARTITION BY s.batch_no,s.symbol ORDER BY outerJson.key,abs(innerJson.value)) AS Row_Id,
	s.Batch_no,s.symbol,
    outerJson.key AS Timeframe,
    innerJson.value AS Value
FROM dbo.Analyse_15Minutes_Stocks s
CROSS APPLY OPENJSON(s.price_action) AS outerJson
CROSS APPLY OPENJSON(outerJson.value) AS innerJson
order by 3,4,5,abs(innerJson.value)
;
--------------------------------------------------------------------------------------------------------------------------------
SELECT top 1000
    p.Batch_No,
	p.Trading_View,
	p.symbol,	
    p.Price,
	p.Percent_Change,
	p.Volume,
    c.timeframe,
    c.value,
	p.Stock_Name,
	p.created_date
FROM dbo.Analyse_15Minutes_Stocks p
INNER JOIN dbo.Analyse_15Minutes_Stocks__Price_Action_table c 
ON p.batch_no = c.batch_no AND p.symbol = c.symbol;
--------------------------------------------------------------------------------------------------------------------------------
SELECT * FROM dbo.Cash_15Minutes_Stocks
WHERE SYMBOL like 'ADANIPORTS'
;
select Symbol,Stock_Name,* from dbo.Master_Stocks_In_Segments
;
--------------------------------------------------------------------------------------------------------------------------------
;with cte as (
	select distinct Trade_Type_Details as ttd,trim(value) as value ,replace(replace(replace(Trade_Type_Details,'; ',';'),'(',''),')','') as ttds
	from dbo.Analyse_Stocks cross apply STRING_SPLIT(replace(replace(Trade_Type_Details,'(',''),')',''), ';')
	where Batch_No = 13 and Trade_Type_Details is not null
) 
select * from cte a left join dbo.ScreenSort b
on a.value = replace(b.name,'_',' ')
where trim(a.value) <> ''
order by a.ttd,b.order
;
--------------------------------------------------------------------------------------------------------------------------------
-- this is working as expected
;WITH SplitSignals AS (
    SELECT distinct
        batch_no,sno,Trade_Type_Details,
        TRIM(value) AS Signal
    FROM dbo.Analyse_Stocks
    CROSS APPLY STRING_SPLIT(replace(replace(replace(Trade_Type_Details,'; ',';'),'(',''),')',''), ';')
    WHERE value <> '' -- and Batch_No = 18 and sno = 43439
) 
,OrderedSignals AS (
    SELECT TOP 100 PERCENT
        batch_no,sno,ss.order,Trade_Type_Details,
        Signal
    FROM SplitSignals Ps -- ParsedSignals ps
    LEFT JOIN dbo.ScreenSort ss 
	ON ps.Signal = replace(ss.Name,'_',' ')
	order by batch_no,sno,ss.order
)
,final as (
SELECT 
    Batch_No,Sno,Trade_Type_Details,
    STRING_AGG(Signal, '; ') WITHIN GROUP (ORDER BY Batch_No,Sno,order ASC)  AS SortedSignalString
FROM OrderedSignals
GROUP BY Batch_No,Sno,Trade_Type_Details
) 
select * from final
;
--------------------------------------------------------------------------------------------------------------------------------
-- select * from dbo.ScreenSort; dbo.Analyse_Stocks
;WITH SplitSignals AS (
    SELECT distinct
        batch_no,sno,Trade_Type_Details,
        TRIM(value) AS Signal
    FROM dbo.Analyse_15Minutes_Stocks
    CROSS APPLY STRING_SPLIT(replace(replace(replace(Trade_Type_Details,'; ',';'),'(',''),')',''), ';')
    WHERE value <> '' -- and Batch_No = 18 and sno = 43439
) 
,OrderedSignals AS (
    SELECT TOP 100 PERCENT
        batch_no,sno,ss.order,Trade_Type_Details,
        Signal
    FROM SplitSignals Ps -- ParsedSignals ps
    LEFT JOIN dbo.ScreenSort ss 
	ON ps.Signal = replace(ss.Name,'_',' ')
	order by batch_no,sno,ss.order
)
,final as (
SELECT 
    Batch_No,Sno,Trade_Type_Details,
    STRING_AGG(Signal, '; ') WITHIN GROUP (ORDER BY Batch_No,Sno,order ASC)  AS SortedSignalString
FROM OrderedSignals
GROUP BY Batch_No,Sno,Trade_Type_Details
)
select * 
-- update a set Trade_Type_Details = SortedSignalString
from dbo.Analyse_15Minutes_Stocks a
inner join final b on a.Batch_No = b.Batch_No and a.Sno = b.Sno
;

select top 1000 * from dbo.Analyse_15Minutes_Stocks where Trade_Type_Details is not null
;

--------------------------------------------------------------------------------------------------------------------------------
select top 1000 * from dbo.Analyse_Stocks with (nolock) order by Batch_No desc;
select top 100 * from dbo.Analyse_Stocks
select * from dbo.Master_Screen_Name_Values

update  dbo.Analyse_Stocks
set Trade_Type = null
,Trade_Type_Details = null


select * from dbo.ScreenSort

select distinct Trade_Type_Details from dbo.Analyse_Stocks;
select  * from dbo.ScreenSort;
--------------------------------------------------------------------------------------------------------------------------------

select top 1000 * from dbo.Analyse_Stocks where Batch_No = 22;

order by Trade_Type_Details_Length desc;

--------------------------------------------------------------------------------------------------------------------------------
select top 10000 * from dbo.Analyse_Stocks 
where segments like '%Nifty 50%' 
and batch_no = (select max(batch_no) from dbo.Analyse_Stocks)
order by Batch_No desc,Trade_Type_Details_Sum desc;

select top 1000 * from dbo.cash_stocks 
where Direction = 'Shockers'
order by batch_no desc,sno ;

select * from dbo.Master_Screen_Name_Values;

select distinct top 10 batch_no,created_date from dbo.Analyse_Stocks order by 1 desc

select top 1000 * from dbo.Analyse_Stocks order by Batch_No desc

/*
alter table dbo.Analyse_Stocks add volume__shockers varchar(255);
alter table dbo.Analyse_15Minutes_Stocks add volume__quarterly__shockers bit null;
alter table dbo.Analyse_15Minutes_Stocks add volume__monthly__shockers bit null;
alter table dbo.Analyse_15Minutes_Stocks add volume__weekly__shockers bit null;
alter table dbo.Analyse_15Minutes_Stocks add volume__daily__shockers bit null;
alter table dbo.Analyse_15Minutes_Stocks add volume__4_hourly__shockers bit null;
alter table dbo.Analyse_15Minutes_Stocks add volume__1_hourly__shockers bit null;
alter table dbo.Analyse_15Minutes_Stocks add volume__15_minutes__shockers bit null;
*/
--------------------------------------------------------------------------------------------------------------------------------
--select top 1000 volume__shockers,* from dbo.Analyse_15Minutes_Stocks 
--where volume__shockers is not null
--order by Batch_No desc
;
select * from dbo.Master_Stocks_In_Segments 
order by sector_order desc,sector_sum desc
;
select * from dbo.Stocks_Industry_Sector_Wise
;
select * from dbo.Sector_Table
;
SELECT TOP (1000) 
	   Sno
      ,Batch_No
      ,Created_Date      
      ,Trading_View
	  ,Industry
      ,Segments
      ,Trade_Type_Details
      ,Trade_Type_Details_Sum
      ,Stock_Name
      ,Symbol
      ,Percent_Change
      ,Price
      ,Volume
      ,volume__shockers
      ,ISIN_Code
      ,price_action
      ,Trade_Type
      ,Trade_Type_Length
      ,Trade_Type_Details_Length
      ,Segments_Length
      ,Trade_Type_Bullish_Sum
      ,Trade_Type_Bearish_Sum
      ,sector_order
      ,sector_sum
      ,Series

	  ,*
  FROM Stocks_Analysis.dbo.Analyse_Stocks
  where volume__shockers is not null
order by Batch_No desc, Segments_Length desc, Trade_Type_Details_Sum desc

--------------------------------------------------------------------------------------------------------------------------------
select 
Sno,Batch_No,Created_Date,Trading_View,Trading_View_Order,Segments,Segments_Order,Volume_Shockers,Volume_Shockers_Sum,Trade_Type_Details,Trade_Type_Details_Sum,Industry,Stock_Name,Symbol,Percent_Change,Price,Volume,Series,Trade_Type,Trade_Type_Length,Trade_Type_Bullish_Sum,Trade_Type_Bearish_Sum,Trade_Type_Details_Length,Segments_Length,Segments_Sum,price_action,ISIN_Code
,Bullish_Triple_Screen_Strong_Monthly, Bullish_Triple_Screen_Strong_Weekly, Bullish_Triple_Screen_Strong_Daily, Bullish_Triple_Screen_Strong_4_Hourly, Bullish_Triple_Screen_Strong_1_Hourly, Bullish_Triple_Screen_Strong_15_Minutes, Bullish_Triple_Screen_Strong_Correction_Monthly, Bullish_Triple_Screen_Strong_Correction_Weekly, Bullish_Triple_Screen_Strong_Correction_Daily, Bullish_Triple_Screen_Strong_Correction_4_Hourly, Bullish_Triple_Screen_Strong_Correction_1_Hourly, Bullish_Triple_Screen_Strong_Correction_15_Minutes, Bullish_Double_Screen_Strong_Quarterly, Bullish_Double_Screen_Strong_Monthly, Bullish_Double_Screen_Strong_Weekly, Bullish_Double_Screen_Strong_Daily, Bullish_Double_Screen_Strong_4_Hourly, Bullish_Double_Screen_Strong_1_Hourly, Bullish_Double_Screen_Strong_15_Minutes, Bullish_Double_Screen_Strong_Correction_Quarterly, Bullish_Double_Screen_Strong_Correction_Monthly, Bullish_Double_Screen_Strong_Correction_Weekly, Bullish_Double_Screen_Strong_Correction_Daily, Bullish_Double_Screen_Strong_Correction_4_Hourly, Bullish_Double_Screen_Strong_Correction_1_Hourly, Bullish_Double_Screen_Strong_Correction_15_Minutes, Bullish_Single_Screen_Yearly, Bullish_Single_Screen_Quarterly, Bullish_Single_Screen_Monthly, Bullish_Single_Screen_Weekly, Bullish_Single_Screen_Daily, Bullish_Single_Screen_4_Hourly, Bullish_Single_Screen_1_Hourly, Bullish_Single_Screen_15_Minutes, Bearish_Triple_Screen_Strong_Monthly, Bearish_Triple_Screen_Strong_Weekly, Bearish_Triple_Screen_Strong_Daily, Bearish_Triple_Screen_Strong_4_Hourly, Bearish_Triple_Screen_Strong_1_Hourly, Bearish_Triple_Screen_Strong_15_Minutes, Bearish_Triple_Screen_Strong_Correction_Monthly, Bearish_Triple_Screen_Strong_Correction_Weekly, Bearish_Triple_Screen_Strong_Correction_Daily, Bearish_Triple_Screen_Strong_Correction_4_Hourly, Bearish_Triple_Screen_Strong_Correction_1_Hourly, Bearish_Triple_Screen_Strong_Correction_15_Minutes, Bearish_Double_Screen_Strong_Quarterly, Bearish_Double_Screen_Strong_Monthly, Bearish_Double_Screen_Strong_Weekly, Bearish_Double_Screen_Strong_Daily, Bearish_Double_Screen_Strong_4_Hourly, Bearish_Double_Screen_Strong_1_Hourly, Bearish_Double_Screen_Strong_15_Minutes, Bearish_Double_Screen_Strong_Correction_Quarterly, Bearish_Double_Screen_Strong_Correction_Monthly, Bearish_Double_Screen_Strong_Correction_Weekly, Bearish_Double_Screen_Strong_Correction_Daily, Bearish_Double_Screen_Strong_Correction_4_Hourly, Bearish_Double_Screen_Strong_Correction_1_Hourly, Bearish_Double_Screen_Strong_Correction_15_Minutes, Bearish_Single_Screen_Yearly, Bearish_Single_Screen_Quarterly, Bearish_Single_Screen_Monthly, Bearish_Single_Screen_Weekly, Bearish_Single_Screen_Daily, Bearish_Single_Screen_4_Hourly, Bearish_Single_Screen_1_Hourly, Bearish_Single_Screen_15_Minutes, Macd_Yearly_Crosses_Above, Macd_Yearly_Crosses_Below, Macd_Quarterly_Crosses_Above, Macd_Quarterly_Crosses_Below, Macd_Monthly_Crosses_Above, Macd_Monthly_Crosses_Below, Macd_Weekly_Crosses_Above, Macd_Weekly_Crosses_Below, Macd_Daily_Crosses_Above, Macd_Daily_Crosses_Below, Macd_4_Hourly_Crosses_Above, Macd_4_Hourly_Crosses_Below, Macd_1_Hourly_Crosses_Above, Macd_1_Hourly_Crosses_Below, Macd_15_Minutes_Crosses_Above, Macd_15_Minutes_Crosses_Below, Stochastic_Yearly_Crosses_Above, Stochastic_Yearly_Crosses_Below, Stochastic_Quarterly_Crosses_Above, Stochastic_Quarterly_Crosses_Below, Stochastic_Monthly_Crosses_Above, Stochastic_Monthly_Crosses_Below, Stochastic_Weekly_Crosses_Above, Stochastic_Weekly_Crosses_Below, Stochastic_Daily_Crosses_Above, Stochastic_Daily_Crosses_Below, Stochastic_4_Hourly_Crosses_Above, Stochastic_4_Hourly_Crosses_Below, Stochastic_1_Hourly_Crosses_Above, Stochastic_1_Hourly_Crosses_Below, Stochastic_15_Minutes_Crosses_Above, Stochastic_15_Minutes_Crosses_Below, Ema_5_13_Yearly_Crosses_Above, Ema_5_13_Yearly_Crosses_Below, Ema_5_13_Quarterly_Crosses_Above, Ema_5_13_Quarterly_Crosses_Below, Ema_5_13_Monthly_Crosses_Above, Ema_5_13_Monthly_Crosses_Below, Ema_5_13_Weekly_Crosses_Above, Ema_5_13_Weekly_Crosses_Below, Ema_5_13_Daily_Crosses_Above, Ema_5_13_Daily_Crosses_Below, Ema_5_13_4_Hourly_Crosses_Above, Ema_5_13_4_Hourly_Crosses_Below, Ema_5_13_1_Hourly_Crosses_Above, Ema_5_13_1_Hourly_Crosses_Below, Ema_5_13_15_Minutes_Crosses_Above, Ema_5_13_15_Minutes_Crosses_Below, Ema_13_26_Yearly_Crosses_Above, Ema_13_26_Yearly_Crosses_Below, Ema_13_26_Quarterly_Crosses_Above, Ema_13_26_Quarterly_Crosses_Below, Ema_13_26_Monthly_Crosses_Above, Ema_13_26_Monthly_Crosses_Below, Ema_13_26_Weekly_Crosses_Above, Ema_13_26_Weekly_Crosses_Below, Ema_13_26_Daily_Crosses_Above, Ema_13_26_Daily_Crosses_Below, Ema_13_26_4_Hourly_Crosses_Above, Ema_13_26_4_Hourly_Crosses_Below, Ema_13_26_1_Hourly_Crosses_Above, Ema_13_26_1_Hourly_Crosses_Below, Ema_13_26_15_Minutes_Crosses_Above, Ema_13_26_15_Minutes_Crosses_Below, Ema_50_100_Yearly_Crosses_Above, Ema_50_100_Yearly_Crosses_Below, Ema_50_100_Quarterly_Crosses_Above, Ema_50_100_Quarterly_Crosses_Below, Ema_50_100_Monthly_Crosses_Above, Ema_50_100_Monthly_Crosses_Below, Ema_50_100_Weekly_Crosses_Above, Ema_50_100_Weekly_Crosses_Below, Ema_50_100_Daily_Crosses_Above, Ema_50_100_Daily_Crosses_Below, Ema_50_100_4_Hourly_Crosses_Above, Ema_50_100_4_Hourly_Crosses_Below, Ema_50_100_1_Hourly_Crosses_Above, Ema_50_100_1_Hourly_Crosses_Below, Ema_50_100_15_Minutes_Crosses_Above, Ema_50_100_15_Minutes_Crosses_Below, Ema_100_200_Yearly_Crosses_Above, Ema_100_200_Yearly_Crosses_Below, Ema_100_200_Quarterly_Crosses_Above, Ema_100_200_Quarterly_Crosses_Below, Ema_100_200_Monthly_Crosses_Above, Ema_100_200_Monthly_Crosses_Below, Ema_100_200_Weekly_Crosses_Above, Ema_100_200_Weekly_Crosses_Below, Ema_100_200_Daily_Crosses_Above, Ema_100_200_Daily_Crosses_Below, Ema_100_200_4_Hourly_Crosses_Above, Ema_100_200_4_Hourly_Crosses_Below, Ema_100_200_1_Hourly_Crosses_Above, Ema_100_200_1_Hourly_Crosses_Below, Ema_100_200_15_Minutes_Crosses_Above, Ema_100_200_15_Minutes_Crosses_Below, Adx_Yearly_Crosses_Above, Adx_Yearly_Crosses_Below, Adx_Quarterly_Crosses_Above, Adx_Quarterly_Crosses_Below, Adx_Monthly_Crosses_Above, Adx_Monthly_Crosses_Below, Adx_Weekly_Crosses_Above, Adx_Weekly_Crosses_Below, Adx_Daily_Crosses_Above, Adx_Daily_Crosses_Below, Adx_4_Hourly_Crosses_Above, Adx_4_Hourly_Crosses_Below, Adx_1_Hourly_Crosses_Above, Adx_1_Hourly_Crosses_Below, Adx_15_Minutes_Crosses_Above, Adx_15_Minutes_Crosses_Below, Rsi_Yearly_Crosses_Above, Rsi_Yearly_Crosses_Below, Rsi_Quarterly_Crosses_Above, Rsi_Quarterly_Crosses_Below, Rsi_Monthly_Crosses_Above, Rsi_Monthly_Crosses_Below, Rsi_Weekly_Crosses_Above, Rsi_Weekly_Crosses_Below, Rsi_Daily_Crosses_Above, Rsi_Daily_Crosses_Below, Rsi_4_Hourly_Crosses_Above, Rsi_4_Hourly_Crosses_Below, Rsi_1_Hourly_Crosses_Above, Rsi_1_Hourly_Crosses_Below, Rsi_15_Minutes_Crosses_Above, Rsi_15_Minutes_Crosses_Below, Upper_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band3_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band3_Daily_Less_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band3_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band3_Daily_Less_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band2_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band2_Daily_Less_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band2_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band2_Daily_Less_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Volume_Yearly_Greater_Than_Equal_To, Volume_Yearly_Less_Than_Equal_To, Volume_Quarterly_Greater_Than_Equal_To, Volume_Quarterly_Less_Than_Equal_To, Volume_Monthly_Greater_Than_Equal_To, Volume_Monthly_Less_Than_Equal_To, Volume_Weekly_Greater_Than_Equal_To, Volume_Weekly_Less_Than_Equal_To, Volume_Daily_Greater_Than_Equal_To, Volume_Daily_Less_Than_Equal_To, Volume_4_Hourly_Greater_Than_Equal_To, Volume_4_Hourly_Less_Than_Equal_To, Volume_1_Hourly_Greater_Than_Equal_To, Volume_1_Hourly_Less_Than_Equal_To, Volume_15_Minutes_Greater_Than_Equal_To, Volume_15_Minutes_Less_Than_Equal_To, Adx_Up_Tick_Yearly_Greater_Than_Equal_To, Adx_Down_Tick_Yearly_Less_Than_Equal_To, Adx_Up_Tick_Quarterly_Greater_Than_Equal_To, Adx_Down_Tick_Quarterly_Less_Than_Equal_To, Adx_Up_Tick_Monthly_Greater_Than_Equal_To, Adx_Down_Tick_Monthly_Less_Than_Equal_To, Adx_Up_Tick_Weekly_Greater_Than_Equal_To, Adx_Down_Tick_Weekly_Less_Than_Equal_To, Adx_Up_Tick_Daily_Greater_Than_Equal_To, Adx_Down_Tick_Daily_Less_Than_Equal_To, Adx_Up_Tick_4_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_4_Hourly_Less_Than_Equal_To, Adx_Up_Tick_1_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_1_Hourly_Less_Than_Equal_To, Adx_Up_Tick_15_Minutes_Greater_Than_Equal_To, Adx_Down_Tick_15_Minutes_Less_Than_Equal_To, volume__yearly__shockers, volume__quarterly__shockers, volume__monthly__shockers, volume__weekly__shockers, volume__daily__shockers, volume__4_hourly__shockers, volume__1_hourly__shockers, volume__15_minutes__shockers
into dbo.Analyse_15Minutes_Stocks_new
from dbo.Analyse_15Minutes_Stocks
;
--------------------------------------------------------------------------------------------------------------------------------
select row_number() over (partition by Batch_No order by 
Batch_No desc, 
Trading_View_Order asc,
Volume_Shockers desc,
Segments_Order desc,
Trade_Type_Details_Sum desc
	) as report_sort_order
,Sno, Batch_No, Created_Date,Symbol, Trading_View, Trading_View_Order, Segments, Segments_Order, Volume_Shockers, Volume_Shockers_Sum, Trade_Type_Details, Trade_Type_Details_Sum, Industry, Stock_Name, Percent_Change, Price, Volume, Series, Trade_Type, Trade_Type_Length, Trade_Type_Bullish_Sum, Trade_Type_Bearish_Sum, Trade_Type_Details_Length, Segments_Length, Segments_Sum, price_action, ISIN_Code, Bullish_Triple_Screen_Strong_Monthly, Bullish_Triple_Screen_Strong_Weekly, Bullish_Triple_Screen_Strong_Daily, Bullish_Triple_Screen_Strong_4_Hourly, Bullish_Triple_Screen_Strong_1_Hourly, Bullish_Triple_Screen_Strong_15_Minutes, Bullish_Triple_Screen_Strong_Correction_Monthly, Bullish_Triple_Screen_Strong_Correction_Weekly, Bullish_Triple_Screen_Strong_Correction_Daily, Bullish_Triple_Screen_Strong_Correction_4_Hourly, Bullish_Triple_Screen_Strong_Correction_1_Hourly, Bullish_Triple_Screen_Strong_Correction_15_Minutes, Bullish_Double_Screen_Strong_Quarterly, Bullish_Double_Screen_Strong_Monthly, Bullish_Double_Screen_Strong_Weekly, Bullish_Double_Screen_Strong_Daily, Bullish_Double_Screen_Strong_4_Hourly, Bullish_Double_Screen_Strong_1_Hourly, Bullish_Double_Screen_Strong_15_Minutes, Bullish_Double_Screen_Strong_Correction_Quarterly, Bullish_Double_Screen_Strong_Correction_Monthly, Bullish_Double_Screen_Strong_Correction_Weekly, Bullish_Double_Screen_Strong_Correction_Daily, Bullish_Double_Screen_Strong_Correction_4_Hourly, Bullish_Double_Screen_Strong_Correction_1_Hourly, Bullish_Double_Screen_Strong_Correction_15_Minutes, Bullish_Single_Screen_Yearly, Bullish_Single_Screen_Quarterly, Bullish_Single_Screen_Monthly, Bullish_Single_Screen_Weekly, Bullish_Single_Screen_Daily, Bullish_Single_Screen_4_Hourly, Bullish_Single_Screen_1_Hourly, Bullish_Single_Screen_15_Minutes, Bearish_Triple_Screen_Strong_Monthly, Bearish_Triple_Screen_Strong_Weekly, Bearish_Triple_Screen_Strong_Daily, Bearish_Triple_Screen_Strong_4_Hourly, Bearish_Triple_Screen_Strong_1_Hourly, Bearish_Triple_Screen_Strong_15_Minutes, Bearish_Triple_Screen_Strong_Correction_Monthly, Bearish_Triple_Screen_Strong_Correction_Weekly, Bearish_Triple_Screen_Strong_Correction_Daily, Bearish_Triple_Screen_Strong_Correction_4_Hourly, Bearish_Triple_Screen_Strong_Correction_1_Hourly, Bearish_Triple_Screen_Strong_Correction_15_Minutes, Bearish_Double_Screen_Strong_Quarterly, Bearish_Double_Screen_Strong_Monthly, Bearish_Double_Screen_Strong_Weekly, Bearish_Double_Screen_Strong_Daily, Bearish_Double_Screen_Strong_4_Hourly, Bearish_Double_Screen_Strong_1_Hourly, Bearish_Double_Screen_Strong_15_Minutes, Bearish_Double_Screen_Strong_Correction_Quarterly, Bearish_Double_Screen_Strong_Correction_Monthly, Bearish_Double_Screen_Strong_Correction_Weekly, Bearish_Double_Screen_Strong_Correction_Daily, Bearish_Double_Screen_Strong_Correction_4_Hourly, Bearish_Double_Screen_Strong_Correction_1_Hourly, Bearish_Double_Screen_Strong_Correction_15_Minutes, Bearish_Single_Screen_Yearly, Bearish_Single_Screen_Quarterly, Bearish_Single_Screen_Monthly, Bearish_Single_Screen_Weekly, Bearish_Single_Screen_Daily, Bearish_Single_Screen_4_Hourly, Bearish_Single_Screen_1_Hourly, Bearish_Single_Screen_15_Minutes, Macd_Yearly_Crosses_Above, Macd_Yearly_Crosses_Below, Macd_Quarterly_Crosses_Above, Macd_Quarterly_Crosses_Below, Macd_Monthly_Crosses_Above, Macd_Monthly_Crosses_Below, Macd_Weekly_Crosses_Above, Macd_Weekly_Crosses_Below, Macd_Daily_Crosses_Above, Macd_Daily_Crosses_Below, Macd_4_Hourly_Crosses_Above, Macd_4_Hourly_Crosses_Below, Macd_1_Hourly_Crosses_Above, Macd_1_Hourly_Crosses_Below, Macd_15_Minutes_Crosses_Above, Macd_15_Minutes_Crosses_Below, Stochastic_Yearly_Crosses_Above, Stochastic_Yearly_Crosses_Below, Stochastic_Quarterly_Crosses_Above, Stochastic_Quarterly_Crosses_Below, Stochastic_Monthly_Crosses_Above, Stochastic_Monthly_Crosses_Below, Stochastic_Weekly_Crosses_Above, Stochastic_Weekly_Crosses_Below, Stochastic_Daily_Crosses_Above, Stochastic_Daily_Crosses_Below, Stochastic_4_Hourly_Crosses_Above, Stochastic_4_Hourly_Crosses_Below, Stochastic_1_Hourly_Crosses_Above, Stochastic_1_Hourly_Crosses_Below, Stochastic_15_Minutes_Crosses_Above, Stochastic_15_Minutes_Crosses_Below, Ema_5_13_Yearly_Crosses_Above, Ema_5_13_Yearly_Crosses_Below, Ema_5_13_Quarterly_Crosses_Above, Ema_5_13_Quarterly_Crosses_Below, Ema_5_13_Monthly_Crosses_Above, Ema_5_13_Monthly_Crosses_Below, Ema_5_13_Weekly_Crosses_Above, Ema_5_13_Weekly_Crosses_Below, Ema_5_13_Daily_Crosses_Above, Ema_5_13_Daily_Crosses_Below, Ema_5_13_4_Hourly_Crosses_Above, Ema_5_13_4_Hourly_Crosses_Below, Ema_5_13_1_Hourly_Crosses_Above, Ema_5_13_1_Hourly_Crosses_Below, Ema_5_13_15_Minutes_Crosses_Above, Ema_5_13_15_Minutes_Crosses_Below, Ema_13_26_Yearly_Crosses_Above, Ema_13_26_Yearly_Crosses_Below, Ema_13_26_Quarterly_Crosses_Above, Ema_13_26_Quarterly_Crosses_Below, Ema_13_26_Monthly_Crosses_Above, Ema_13_26_Monthly_Crosses_Below, Ema_13_26_Weekly_Crosses_Above, Ema_13_26_Weekly_Crosses_Below, Ema_13_26_Daily_Crosses_Above, Ema_13_26_Daily_Crosses_Below, Ema_13_26_4_Hourly_Crosses_Above, Ema_13_26_4_Hourly_Crosses_Below, Ema_13_26_1_Hourly_Crosses_Above, Ema_13_26_1_Hourly_Crosses_Below, Ema_13_26_15_Minutes_Crosses_Above, Ema_13_26_15_Minutes_Crosses_Below, Ema_50_100_Yearly_Crosses_Above, Ema_50_100_Yearly_Crosses_Below, Ema_50_100_Quarterly_Crosses_Above, Ema_50_100_Quarterly_Crosses_Below, Ema_50_100_Monthly_Crosses_Above, Ema_50_100_Monthly_Crosses_Below, Ema_50_100_Weekly_Crosses_Above, Ema_50_100_Weekly_Crosses_Below, Ema_50_100_Daily_Crosses_Above, Ema_50_100_Daily_Crosses_Below, Ema_50_100_4_Hourly_Crosses_Above, Ema_50_100_4_Hourly_Crosses_Below, Ema_50_100_1_Hourly_Crosses_Above, Ema_50_100_1_Hourly_Crosses_Below, Ema_50_100_15_Minutes_Crosses_Above, Ema_50_100_15_Minutes_Crosses_Below, Ema_100_200_Yearly_Crosses_Above, Ema_100_200_Yearly_Crosses_Below, Ema_100_200_Quarterly_Crosses_Above, Ema_100_200_Quarterly_Crosses_Below, Ema_100_200_Monthly_Crosses_Above, Ema_100_200_Monthly_Crosses_Below, Ema_100_200_Weekly_Crosses_Above, Ema_100_200_Weekly_Crosses_Below, Ema_100_200_Daily_Crosses_Above, Ema_100_200_Daily_Crosses_Below, Ema_100_200_4_Hourly_Crosses_Above, Ema_100_200_4_Hourly_Crosses_Below, Ema_100_200_1_Hourly_Crosses_Above, Ema_100_200_1_Hourly_Crosses_Below, Ema_100_200_15_Minutes_Crosses_Above, Ema_100_200_15_Minutes_Crosses_Below, Adx_Yearly_Crosses_Above, Adx_Yearly_Crosses_Below, Adx_Quarterly_Crosses_Above, Adx_Quarterly_Crosses_Below, Adx_Monthly_Crosses_Above, Adx_Monthly_Crosses_Below, Adx_Weekly_Crosses_Above, Adx_Weekly_Crosses_Below, Adx_Daily_Crosses_Above, Adx_Daily_Crosses_Below, Adx_4_Hourly_Crosses_Above, Adx_4_Hourly_Crosses_Below, Adx_1_Hourly_Crosses_Above, Adx_1_Hourly_Crosses_Below, Adx_15_Minutes_Crosses_Above, Adx_15_Minutes_Crosses_Below, Rsi_Yearly_Crosses_Above, Rsi_Yearly_Crosses_Below, Rsi_Quarterly_Crosses_Above, Rsi_Quarterly_Crosses_Below, Rsi_Monthly_Crosses_Above, Rsi_Monthly_Crosses_Below, Rsi_Weekly_Crosses_Above, Rsi_Weekly_Crosses_Below, Rsi_Daily_Crosses_Above, Rsi_Daily_Crosses_Below, Rsi_4_Hourly_Crosses_Above, Rsi_4_Hourly_Crosses_Below, Rsi_1_Hourly_Crosses_Above, Rsi_1_Hourly_Crosses_Below, Rsi_15_Minutes_Crosses_Above, Rsi_15_Minutes_Crosses_Below, Upper_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band3_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band3_Daily_Less_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band3_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band3_Daily_Less_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band2_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band2_Daily_Less_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band2_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band2_Daily_Less_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Volume_Yearly_Greater_Than_Equal_To, Volume_Yearly_Less_Than_Equal_To, Volume_Quarterly_Greater_Than_Equal_To, Volume_Quarterly_Less_Than_Equal_To, Volume_Monthly_Greater_Than_Equal_To, Volume_Monthly_Less_Than_Equal_To, Volume_Weekly_Greater_Than_Equal_To, Volume_Weekly_Less_Than_Equal_To, Volume_Daily_Greater_Than_Equal_To, Volume_Daily_Less_Than_Equal_To, Volume_4_Hourly_Greater_Than_Equal_To, Volume_4_Hourly_Less_Than_Equal_To, Volume_1_Hourly_Greater_Than_Equal_To, Volume_1_Hourly_Less_Than_Equal_To, Volume_15_Minutes_Greater_Than_Equal_To, Volume_15_Minutes_Less_Than_Equal_To, Adx_Up_Tick_Yearly_Greater_Than_Equal_To, Adx_Down_Tick_Yearly_Less_Than_Equal_To, Adx_Up_Tick_Quarterly_Greater_Than_Equal_To, Adx_Down_Tick_Quarterly_Less_Than_Equal_To, Adx_Up_Tick_Monthly_Greater_Than_Equal_To, Adx_Down_Tick_Monthly_Less_Than_Equal_To, Adx_Up_Tick_Weekly_Greater_Than_Equal_To, Adx_Down_Tick_Weekly_Less_Than_Equal_To, Adx_Up_Tick_Daily_Greater_Than_Equal_To, Adx_Down_Tick_Daily_Less_Than_Equal_To, Adx_Up_Tick_4_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_4_Hourly_Less_Than_Equal_To, Adx_Up_Tick_1_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_1_Hourly_Less_Than_Equal_To, Adx_Up_Tick_15_Minutes_Greater_Than_Equal_To, Adx_Down_Tick_15_Minutes_Less_Than_Equal_To, volume__yearly__shockers, volume__quarterly__shockers, volume__monthly__shockers, volume__weekly__shockers, volume__daily__shockers, volume__4_hourly__shockers, volume__1_hourly__shockers, volume__15_minutes__shockers
--into dbo.Analyse_Stocks_new
from dbo.Analyse_Stocks where Batch_No = 52 and volume_shockers is not null
order by batch_no desc
;
--------------------------------------------------------------------------------------------------------------------------------
select * 
-- update a set Volume_Shockers_Sum =
isnull(Volume_Shockers_Sum,0) +
(case when volume__yearly__shockers = 1 then 525600 else 0 end) +
(case when volume__quarterly__shockers = 1 then 131400 else 0 end)+
(case when volume__monthly__shockers = 1 then 43800 else 0 end)+
(case when volume__weekly__shockers = 1 then 10080 else 0 end)+
(case when volume__daily__shockers = 1 then 1440 else 0 end)+
(case when volume__4_hourly__shockers = 1 then 240 else 0 end)+
(case when volume__1_hourly__shockers = 1 then 60 else 0 end)+
(case when volume__15_minutes__shockers = 1 then 15 else 0 end)
from dbo.Analyse_15Minutes_Stocks a
where Batch_No = @Batch_No
;
--------------------------------------------------------------------------------------------------------------------------------
begin
select top 10000 Symbol from dbo.Analyse_Stocks_v order by Batch_No desc;
create view dbo.Analyse_15Minutes_Stocks_v_aklfdjak as 
select Batch_No, Trading_View,Trade-Type-Details,segment/*,Trade_Type_Details,Segments*/, Symbol, Percent_Change, Price, Volume
,rn,Stock_Name, Trade_Type_Details_Sum, Trade_Type_Bullish_Sum, Trade_Type_Bearish_Sum, Trade_Type, Trade_Type_Length, Segments_Length, Trade_Type_Details_Length, Created_Date
,Segments_Order,Segments_Sum,price_action
from (
	select row_number() over(partition by Batch_No, Trading_View,Trade_Type_Details,Stock_Name, Segments, Symbol order by Sno desc) as rn,
	Sno, Batch_No, Trade_Type_Details_Sum, Trade_Type_Bullish_Sum, Trade_Type_Bearish_Sum, Segments_Length, Trading_View, Trade_Type, Trade_Type_Length, replace(Trade_Type_Details,';',';'+char(13)+char(10)) as 'Trade-Type-Details',Trade_Type_Details, Trade_Type_Details_Length, Created_Date, Stock_Name,replace(Segments,';',';' + char(13)+ char(10))as segment, Segments, Symbol, Percent_Change, Price, Volume
	,Segments_Order,Segments_Sum,price_action
	from dbo.Analyse_15Minutes_Stocks where Batch_No = (select max(batch_no) from dbo.Analyse_15Minutes_Stocks)
	-- from dbo.Analyse_Stocks where Batch_No = (select max(batch_no) from dbo.Analyse_Stocks)	 	
	and Segments_Length > 5 and Trade_Type_Details_Sum > 10 and Segments_Length > 25 and volume >1000
	--and Symbol in ('BSE','ARE&M','AXISBANK','COALINDIA','HAL','IREDA','OLAELEC','RELIANCE','SHREEGANES-X','SWSOLAR','TVSSCS','VBL','NIFTY50-INDEX','DEEPAKNTR','DLF','MUKTAARTS','WEBELSOLAR','COLPAL','REDINGTON','BHARATFORG','MUTHOOTFIN')
) a where rn = 1
-- order by Trading_View desc,Trade_Type_Details_Sum desc, Trade_Type_Details_Length desc,Segments_Length desc,Trade_Type_Length desc
create view dbo.Analyse_Stocks_v as 
select Batch_No, Trading_View,Trade-Type-Details,segment/*,Trade_Type_Details,Segments*/, Symbol, Percent_Change, Price, Volume
,rn,Stock_Name, Trade_Type_Details_Sum, Trade_Type_Bullish_Sum, Trade_Type_Bearish_Sum, Trade_Type, Trade_Type_Length
,Segments_Length, Trade_Type_Details_Length, Created_Date
,Segments_Order,Segments_Sum,price_action
from (
	select row_number() over(partition by Batch_No, Trading_View,Trade_Type_Details,Stock_Name, Segments, Symbol order by Sno desc) as rn,
	Sno, Batch_No, Trade_Type_Details_Sum, Trade_Type_Bullish_Sum, Trade_Type_Bearish_Sum, Segments_Length, Trading_View
	, Trade_Type, Trade_Type_Length, replace(Trade_Type_Details,';',';'+char(13)+char(10)) as 'Trade-Type-Details',Trade_Type_Details
	, Trade_Type_Details_Length, Created_Date, Stock_Name,replace(Segments,';',';' + char(13)+ char(10))as segment, Segments, Symbol
	, Percent_Change, Price, Volume
	,Segments_Order,Segments_Sum,price_action
	--from dbo.Analyse_15Minutes_Stocks where Batch_No = (select max(batch_no) from dbo.Analyse_15Minutes_Stocks)
	 from dbo.Analyse_Stocks where Batch_No = (select max(batch_no) from dbo.Analyse_Stocks)
	 and Trade_Type_Length > 25 and Segments_Length > 10
	 and volume > 10000 and Trade_Type_Details_Sum > 10
	--and Symbol in ('BSE','ARE&M','AXISBANK','COALINDIA','HAL','IREDA','OLAELEC','RELIANCE','SHREEGANES-X','SWSOLAR','TVSSCS','VBL','NIFTY50-INDEX','DEEPAKNTR','DLF','MUKTAARTS','WEBELSOLAR','COLPAL','REDINGTON','BHARATFORG','MUTHOOTFIN')
) a where rn = 1
-- order by Trading_View desc,Trade_Type_Details_Sum desc, Trade_Type_Details_Length desc,Segments_Length desc,Trade_Type_Length desc
end
--------------------------------------------------------------------------------------------------------------------------------
begin -- updating the report sort order column
select row_number() over (partition by Batch_No order by Batch_No desc, Trading_View_Order asc, Segments_Order desc, Volume_Shockers desc, Trade_Type_Details_Sum desc ) as report_sort_order
,Sno, Batch_No, Created_Date,Symbol, Trading_View, Trading_View_Order, Segments, Segments_Order, Volume_Shockers, Volume_Shockers_Sum, Trade_Type_Details, Trade_Type_Details_Sum, Industry, Stock_Name, Percent_Change, Price, Volume, Series, Trade_Type, Trade_Type_Length, Trade_Type_Bullish_Sum, Trade_Type_Bearish_Sum, Trade_Type_Details_Length, Segments_Length, Segments_Sum, price_action, ISIN_Code, Bullish_Triple_Screen_Strong_Monthly, Bullish_Triple_Screen_Strong_Weekly, Bullish_Triple_Screen_Strong_Daily, Bullish_Triple_Screen_Strong_4_Hourly, Bullish_Triple_Screen_Strong_1_Hourly, Bullish_Triple_Screen_Strong_15_Minutes, Bullish_Triple_Screen_Strong_Correction_Monthly, Bullish_Triple_Screen_Strong_Correction_Weekly, Bullish_Triple_Screen_Strong_Correction_Daily, Bullish_Triple_Screen_Strong_Correction_4_Hourly, Bullish_Triple_Screen_Strong_Correction_1_Hourly, Bullish_Triple_Screen_Strong_Correction_15_Minutes, Bullish_Double_Screen_Strong_Quarterly, Bullish_Double_Screen_Strong_Monthly, Bullish_Double_Screen_Strong_Weekly, Bullish_Double_Screen_Strong_Daily, Bullish_Double_Screen_Strong_4_Hourly, Bullish_Double_Screen_Strong_1_Hourly, Bullish_Double_Screen_Strong_15_Minutes, Bullish_Double_Screen_Strong_Correction_Quarterly, Bullish_Double_Screen_Strong_Correction_Monthly, Bullish_Double_Screen_Strong_Correction_Weekly, Bullish_Double_Screen_Strong_Correction_Daily, Bullish_Double_Screen_Strong_Correction_4_Hourly, Bullish_Double_Screen_Strong_Correction_1_Hourly, Bullish_Double_Screen_Strong_Correction_15_Minutes, Bullish_Single_Screen_Yearly, Bullish_Single_Screen_Quarterly, Bullish_Single_Screen_Monthly, Bullish_Single_Screen_Weekly, Bullish_Single_Screen_Daily, Bullish_Single_Screen_4_Hourly, Bullish_Single_Screen_1_Hourly, Bullish_Single_Screen_15_Minutes, Bearish_Triple_Screen_Strong_Monthly, Bearish_Triple_Screen_Strong_Weekly, Bearish_Triple_Screen_Strong_Daily, Bearish_Triple_Screen_Strong_4_Hourly, Bearish_Triple_Screen_Strong_1_Hourly, Bearish_Triple_Screen_Strong_15_Minutes, Bearish_Triple_Screen_Strong_Correction_Monthly, Bearish_Triple_Screen_Strong_Correction_Weekly, Bearish_Triple_Screen_Strong_Correction_Daily, Bearish_Triple_Screen_Strong_Correction_4_Hourly, Bearish_Triple_Screen_Strong_Correction_1_Hourly, Bearish_Triple_Screen_Strong_Correction_15_Minutes, Bearish_Double_Screen_Strong_Quarterly, Bearish_Double_Screen_Strong_Monthly, Bearish_Double_Screen_Strong_Weekly, Bearish_Double_Screen_Strong_Daily, Bearish_Double_Screen_Strong_4_Hourly, Bearish_Double_Screen_Strong_1_Hourly, Bearish_Double_Screen_Strong_15_Minutes, Bearish_Double_Screen_Strong_Correction_Quarterly, Bearish_Double_Screen_Strong_Correction_Monthly, Bearish_Double_Screen_Strong_Correction_Weekly, Bearish_Double_Screen_Strong_Correction_Daily, Bearish_Double_Screen_Strong_Correction_4_Hourly, Bearish_Double_Screen_Strong_Correction_1_Hourly, Bearish_Double_Screen_Strong_Correction_15_Minutes, Bearish_Single_Screen_Yearly, Bearish_Single_Screen_Quarterly, Bearish_Single_Screen_Monthly, Bearish_Single_Screen_Weekly, Bearish_Single_Screen_Daily, Bearish_Single_Screen_4_Hourly, Bearish_Single_Screen_1_Hourly, Bearish_Single_Screen_15_Minutes, Macd_Yearly_Crosses_Above, Macd_Yearly_Crosses_Below, Macd_Quarterly_Crosses_Above, Macd_Quarterly_Crosses_Below, Macd_Monthly_Crosses_Above, Macd_Monthly_Crosses_Below, Macd_Weekly_Crosses_Above, Macd_Weekly_Crosses_Below, Macd_Daily_Crosses_Above, Macd_Daily_Crosses_Below, Macd_4_Hourly_Crosses_Above, Macd_4_Hourly_Crosses_Below, Macd_1_Hourly_Crosses_Above, Macd_1_Hourly_Crosses_Below, Macd_15_Minutes_Crosses_Above, Macd_15_Minutes_Crosses_Below, Stochastic_Yearly_Crosses_Above, Stochastic_Yearly_Crosses_Below, Stochastic_Quarterly_Crosses_Above, Stochastic_Quarterly_Crosses_Below, Stochastic_Monthly_Crosses_Above, Stochastic_Monthly_Crosses_Below, Stochastic_Weekly_Crosses_Above, Stochastic_Weekly_Crosses_Below, Stochastic_Daily_Crosses_Above, Stochastic_Daily_Crosses_Below, Stochastic_4_Hourly_Crosses_Above, Stochastic_4_Hourly_Crosses_Below, Stochastic_1_Hourly_Crosses_Above, Stochastic_1_Hourly_Crosses_Below, Stochastic_15_Minutes_Crosses_Above, Stochastic_15_Minutes_Crosses_Below, Ema_5_13_Yearly_Crosses_Above, Ema_5_13_Yearly_Crosses_Below, Ema_5_13_Quarterly_Crosses_Above, Ema_5_13_Quarterly_Crosses_Below, Ema_5_13_Monthly_Crosses_Above, Ema_5_13_Monthly_Crosses_Below, Ema_5_13_Weekly_Crosses_Above, Ema_5_13_Weekly_Crosses_Below, Ema_5_13_Daily_Crosses_Above, Ema_5_13_Daily_Crosses_Below, Ema_5_13_4_Hourly_Crosses_Above, Ema_5_13_4_Hourly_Crosses_Below, Ema_5_13_1_Hourly_Crosses_Above, Ema_5_13_1_Hourly_Crosses_Below, Ema_5_13_15_Minutes_Crosses_Above, Ema_5_13_15_Minutes_Crosses_Below, Ema_13_26_Yearly_Crosses_Above, Ema_13_26_Yearly_Crosses_Below, Ema_13_26_Quarterly_Crosses_Above, Ema_13_26_Quarterly_Crosses_Below, Ema_13_26_Monthly_Crosses_Above, Ema_13_26_Monthly_Crosses_Below, Ema_13_26_Weekly_Crosses_Above, Ema_13_26_Weekly_Crosses_Below, Ema_13_26_Daily_Crosses_Above, Ema_13_26_Daily_Crosses_Below, Ema_13_26_4_Hourly_Crosses_Above, Ema_13_26_4_Hourly_Crosses_Below, Ema_13_26_1_Hourly_Crosses_Above, Ema_13_26_1_Hourly_Crosses_Below, Ema_13_26_15_Minutes_Crosses_Above, Ema_13_26_15_Minutes_Crosses_Below, Ema_50_100_Yearly_Crosses_Above, Ema_50_100_Yearly_Crosses_Below, Ema_50_100_Quarterly_Crosses_Above, Ema_50_100_Quarterly_Crosses_Below, Ema_50_100_Monthly_Crosses_Above, Ema_50_100_Monthly_Crosses_Below, Ema_50_100_Weekly_Crosses_Above, Ema_50_100_Weekly_Crosses_Below, Ema_50_100_Daily_Crosses_Above, Ema_50_100_Daily_Crosses_Below, Ema_50_100_4_Hourly_Crosses_Above, Ema_50_100_4_Hourly_Crosses_Below, Ema_50_100_1_Hourly_Crosses_Above, Ema_50_100_1_Hourly_Crosses_Below, Ema_50_100_15_Minutes_Crosses_Above, Ema_50_100_15_Minutes_Crosses_Below, Ema_100_200_Yearly_Crosses_Above, Ema_100_200_Yearly_Crosses_Below, Ema_100_200_Quarterly_Crosses_Above, Ema_100_200_Quarterly_Crosses_Below, Ema_100_200_Monthly_Crosses_Above, Ema_100_200_Monthly_Crosses_Below, Ema_100_200_Weekly_Crosses_Above, Ema_100_200_Weekly_Crosses_Below, Ema_100_200_Daily_Crosses_Above, Ema_100_200_Daily_Crosses_Below, Ema_100_200_4_Hourly_Crosses_Above, Ema_100_200_4_Hourly_Crosses_Below, Ema_100_200_1_Hourly_Crosses_Above, Ema_100_200_1_Hourly_Crosses_Below, Ema_100_200_15_Minutes_Crosses_Above, Ema_100_200_15_Minutes_Crosses_Below, Adx_Yearly_Crosses_Above, Adx_Yearly_Crosses_Below, Adx_Quarterly_Crosses_Above, Adx_Quarterly_Crosses_Below, Adx_Monthly_Crosses_Above, Adx_Monthly_Crosses_Below, Adx_Weekly_Crosses_Above, Adx_Weekly_Crosses_Below, Adx_Daily_Crosses_Above, Adx_Daily_Crosses_Below, Adx_4_Hourly_Crosses_Above, Adx_4_Hourly_Crosses_Below, Adx_1_Hourly_Crosses_Above, Adx_1_Hourly_Crosses_Below, Adx_15_Minutes_Crosses_Above, Adx_15_Minutes_Crosses_Below, Rsi_Yearly_Crosses_Above, Rsi_Yearly_Crosses_Below, Rsi_Quarterly_Crosses_Above, Rsi_Quarterly_Crosses_Below, Rsi_Monthly_Crosses_Above, Rsi_Monthly_Crosses_Below, Rsi_Weekly_Crosses_Above, Rsi_Weekly_Crosses_Below, Rsi_Daily_Crosses_Above, Rsi_Daily_Crosses_Below, Rsi_4_Hourly_Crosses_Above, Rsi_4_Hourly_Crosses_Below, Rsi_1_Hourly_Crosses_Above, Rsi_1_Hourly_Crosses_Below, Rsi_15_Minutes_Crosses_Above, Rsi_15_Minutes_Crosses_Below, Upper_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band3_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band3_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band3_Daily_Less_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band3_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band3_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band3_Daily_Less_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band3_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band3_15_Minutes_Less_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Yearly_Less_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Monthly_Less_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Upper_Bollinger_Band2_Weekly_Less_Than_Equal_To, Upper_Bollinger_Band2_Daily_Greater_Than_Equal_To, Upper_Bollinger_Band2_Daily_Less_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Upper_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Upper_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Yearly_Less_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Quarterly_Less_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Monthly_Less_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Greater_Than_Equal_To, Lower_Bollinger_Band2_Weekly_Less_Than_Equal_To, Lower_Bollinger_Band2_Daily_Greater_Than_Equal_To, Lower_Bollinger_Band2_Daily_Less_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_4_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Greater_Than_Equal_To, Lower_Bollinger_Band2_1_Hourly_Less_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Greater_Than_Equal_To, Lower_Bollinger_Band2_15_Minutes_Less_Than_Equal_To, Volume_Yearly_Greater_Than_Equal_To, Volume_Yearly_Less_Than_Equal_To, Volume_Quarterly_Greater_Than_Equal_To, Volume_Quarterly_Less_Than_Equal_To, Volume_Monthly_Greater_Than_Equal_To, Volume_Monthly_Less_Than_Equal_To, Volume_Weekly_Greater_Than_Equal_To, Volume_Weekly_Less_Than_Equal_To, Volume_Daily_Greater_Than_Equal_To, Volume_Daily_Less_Than_Equal_To, Volume_4_Hourly_Greater_Than_Equal_To, Volume_4_Hourly_Less_Than_Equal_To, Volume_1_Hourly_Greater_Than_Equal_To, Volume_1_Hourly_Less_Than_Equal_To, Volume_15_Minutes_Greater_Than_Equal_To, Volume_15_Minutes_Less_Than_Equal_To, Adx_Up_Tick_Yearly_Greater_Than_Equal_To, Adx_Down_Tick_Yearly_Less_Than_Equal_To, Adx_Up_Tick_Quarterly_Greater_Than_Equal_To, Adx_Down_Tick_Quarterly_Less_Than_Equal_To, Adx_Up_Tick_Monthly_Greater_Than_Equal_To, Adx_Down_Tick_Monthly_Less_Than_Equal_To, Adx_Up_Tick_Weekly_Greater_Than_Equal_To, Adx_Down_Tick_Weekly_Less_Than_Equal_To, Adx_Up_Tick_Daily_Greater_Than_Equal_To, Adx_Down_Tick_Daily_Less_Than_Equal_To, Adx_Up_Tick_4_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_4_Hourly_Less_Than_Equal_To, Adx_Up_Tick_1_Hourly_Greater_Than_Equal_To, Adx_Down_Tick_1_Hourly_Less_Than_Equal_To, Adx_Up_Tick_15_Minutes_Greater_Than_Equal_To, Adx_Down_Tick_15_Minutes_Less_Than_Equal_To, volume__yearly__shockers, volume__quarterly__shockers, volume__monthly__shockers, volume__weekly__shockers, volume__daily__shockers, volume__4_hourly__shockers, volume__1_hourly__shockers, volume__15_minutes__shockers
from dbo.Analyse_Stocks where Batch_No = 52 -- and volume_shockers is not null
;

;WITH RankedRows AS (
    select batch_no,sno,
	row_number() over (partition by Batch_No order by Batch_No desc, Trading_View_Order asc, Segments_Order desc, Volume_Shockers desc, Trade_Type_Details_Sum desc ) as report_sort_order
	from dbo.Analyse_15Minutes_Stocks
)
select * 
-- UPDATE a SET Report_Sort_Order = b.report_sort_order
FROM dbo.Analyse_15Minutes_Stocks a JOIN RankedRows b
ON a.Batch_No = b.Batch_No and a.sno = b.sno
where a.Batch_No = 52
;
end 
---------------------------------------------------------------------------------------------
select top 1000 Report_Sort_Order as rso,* from dbo.Analyse_Stocks
where Volume_Shockers is not null
order by Batch_No desc, Report_Sort_Order asc
---------------------------------------------------------------------------------------------
select top 1000 * from dbo.Analyse_15Minutes_Stocks_View
where Volume_Shockers is not null
order by batch_no desc, Report_Sort_Order
;
select * from dbo.Analyse_15Minutes_Stocks_v
;
select distinct batch_no,Symbol from dbo.Analyse_Stocks_View with (nolock) where Batch_No = 63
;
select * from dbo.Analyse_15Minutes_Stocks order by Batch_No desc
;
select distinct Symbol from dbo.Analyse_Stocks_v
;
select distinct batch_no from dbo.Cash_Stocks 
order by 1
;

begin -- purge the records from cash stocks tables 
select distinct batch_no from dbo.Cash_15Minutes_Stocks
order by 1
;
-- delete from dbo.Cash_15Minutes_Stocks where Batch_No < 38
;
select count(1) from dbo.Cash_15Minutes_Stocks
;

select distinct batch_no from dbo.Cash_Stocks
order by 1
;
-- delete from dbo.Cash_Stocks where Batch_No < 43
;
select count(1) from dbo.Cash_Stocks
;
end

begin -- purge the records from analyse stocks tables
select distinct batch_no from dbo.Analyse_Stocks order by 1
;
delete from dbo.Analyse_Stocks where Batch_No <=(select 70-15)
;
select count(1) from dbo.Analyse_Stocks
;

select distinct batch_no from dbo.Analyse_15Minutes_Stocks order by 1
;
delete from dbo.Analyse_15Minutes_Stocks where Batch_No <=(select 54-15)
;
select count(1) from dbo.Analyse_15Minutes_Stocks
;
end

begin
select *
--DELETE 
FROM dbo.Analyse_Stocks             where Batch_No <= (select count(distinct Batch_No) from dbo.Analyse_Stocks) - 15;
select *
--DELETE 
FROM dbo.Analyse_15Minutes_Stocks   where Batch_No <= (select count(distinct Batch_No) from dbo.Analyse_15Minutes_Stocks) - 15;
select *
--DELETE 
FROM dbo.Cash_Stocks                where Batch_No <= (select count(distinct Batch_No) from dbo.Cash_Stocks) - 15;
select *
--DELETE 
FROM dbo.Cash_15Minutes_Stocks      where Batch_No <= (select count(distinct Batch_No) from dbo.Cash_15Minutes_Stocks) - 15;
end

begin -- shrink the log file of the database
USE Stocks_Analysis;

ALTER DATABASE Stocks_Analysis SET RECOVERY SIMPLE;
DBCC SHRINKFILE (Stocks_Analysis_log, 1); -- Shrinks to 1MB
-- ALTER DATABASE Stocks_Analysis SET RECOVERY FULL
;
SELECT name, recovery_model_desc FROM sys.databases --WHERE name = 'Stocks_Analysis';
end

begin -- shrink the log file of the Trade Log database
USE Trade Log;

ALTER DATABASE Trade Log SET RECOVERY SIMPLE;
DBCC SHRINKFILE (Stocks_db_log, 1); -- Shrinks to 1MB
-- ALTER DATABASE Trade Log SET RECOVERY FULL
;
SELECT name, recovery_model_desc FROM sys.databases --WHERE name = 'Trade Log';
end
begin
select distinct batch_no from dbo.Analyse_Stocks
;
select distinct Batch_No from dbo.Analyse_Stocks order by 1 desc
;
select distinct Batch_No from dbo.Analyse_15Minutes_Stocks order by 1 desc
;
select distinct Batch_No from dbo.Cash_Stocks order by Batch_No desc
;
select distinct Batch_No from dbo.Cash_15Minutes_Stocks order by Batch_No desc
;
select CONVERT(VARCHAR, SYSDATETIME(), 120), SYSDATETIME()
SELECT FORMAT(GETDATE(), 'yyyyMMddHHmmss'),
    FORMAT(GETDATE(), 'yyyyMMddHHmmss') + 
    RIGHT('000' + CAST(DATEPART(MILLISECOND, GETDATE()) AS VARCHAR), 3) AS FormattedDateTime
, getdate(),FORMAT(DATEADD(HOUR, 23, GETDATE()), 'yyyyMMddHHmmss')

-- UPDATE dbo.Analyse_15Minutes_Stocks SET batch_no = FORMAT(DATEADD(HOUR, batch_no, GETDATE()), 'yyyyMMddHHmmss')
-- WHERE batch_no BETWEEN 0 AND 100
--update dbo.Cash_Stocks set Batch_No = 20250724191010
--where Batch_No >= 20250724190000 
--;
end
begin -- find the sizes of tables
SELECT 
    t.NAME AS TableName,
    SUM(p.rows) AS RowCounts,
    SUM(a.total_pages) * 8 AS TotalSpaceKB,
    SUM(a.used_pages) * 8 AS UsedSpaceKB,
    (SUM(a.total_pages) - SUM(a.used_pages)) * 8 AS UnusedSpaceKB
FROM 
    sys.tables t
INNER JOIN      
    sys.indexes i ON t.OBJECT_ID = i.object_id
INNER JOIN 
    sys.partitions p ON i.object_id = p.OBJECT_ID AND i.index_id = p.index_id
INNER JOIN 
    sys.allocation_units a ON p.partition_id = a.container_id
where t.NAME like 'z%' 
GROUP BY 
    t.NAME
ORDER BY 
    TotalSpaceKB DESC;

-- change the schema of the tables
SELECT 'ALTER SCHEMA dbo TRANSFER dbo.' + name 
FROM sys.objects 
WHERE type = 'U' AND SCHEMA_NAME(schema_id) = 'dbo';
end
begin 
DELETE FROM dbo.Cash_Stocks WHERE batch_no NOT IN (SELECT distinct TOP 15 batch_no FROM dbo.Cash_Stocks ORDER BY batch_no DESC);
end

select * from dbo.Analyse_Stocks 
where batch_no =  20250725085552 -- 20250725102550 
and Trading_View is not null
order by Batch_No desc;

-- delete from dbo.Analyse_Stocks where Batch_No in (20250725103420,20250725110948)
-- select distinct batch_no from dbo.Analyse_Stocks order by 1 desc;

select * from dbo.Analyse_15Minutes_Stocks -- where Trading_View is not null
order by Batch_No desc
;

select * from (select distinct top 3 batch_no,'Cash_Stocks' as tblname from Cash_Stocks order by 1 desc) a
union all
select * from (select distinct top 3 batch_no,'Analyse_Stocks' as tblname from Analyse_Stocks order by 1 desc) b
;
begin
with cse as (
select *, indicator + '_' + timeline + '_' + replace(direction,' ','_') as ind_direction
from Cash_Stocks 
where Batch_No = (select max(batch_no) from Cash_Stocks)
)
select distinct ind_direction from cse

select * from (
select batch_no, symbol,ind_direction,sno
from cse) as source
pivot( max(sno) for ind_direction in ()) as pivoted
end

begin
WITH cse AS (
    SELECT *,
           indicator + '_' + timeline + '_' + REPLACE(direction, ' ', '_') AS ind_direction
    FROM Cash_Stocks
    WHERE Batch_No = (SELECT MAX(Batch_No) FROM Cash_Stocks)
),
source AS (
    SELECT symbol, ind_direction, MAX(sno) AS sr_value
    FROM cse
    GROUP BY symbol, ind_direction
)
SELECT *
FROM source
PIVOT (
    MAX(sr_value)
    FOR ind_direction IN (adx_daily_crosses_above, adx_quarterly_crosses_above)  -- Add more as needed
) AS pivoted;
end

begin
DECLARE @cols NVARCHAR(MAX), @query NVARCHAR(MAX);

-- Explicit LOB type enforcement inside STRING_AGG
SELECT @cols = STRING_AGG(CAST(QUOTENAME(REPLACE(indicator, ' ', '_') + '_' + REPLACE(timeline, ' ', '_') + '_' + REPLACE(direction, ' ', '_')) AS NVARCHAR(MAX)), ',')
              WITHIN GROUP (ORDER BY indicator)
FROM (
    SELECT DISTINCT indicator, timeline, direction
    FROM Cash_Stocks
    WHERE Batch_No = (SELECT MAX(Batch_No) FROM Cash_Stocks)
) AS temp;

-- Build final query
SET @query = '
WITH cse AS (
    SELECT *,
           REPLACE(indicator, '' '', ''_'') + ''_'' + REPLACE(timeline, '' '', ''_'') + ''_'' + REPLACE(direction, '' '', ''_'') AS ind_direction
    FROM Cash_Stocks
    WHERE Batch_No = (SELECT MAX(Batch_No) FROM Cash_Stocks)
),
source as (
	select symbol, ind_direction
	, 1 as sno
	, MAX(stock_name) as stock_name
	, MAX(bsecode) as bsecode
	, MAX(Percent_Change) as percent_change
	, MAX(price) as price
	, MAX(volume) as volume
	, MAX(Segment) as segment
	, MAX(Batch_No) as batch_no
	from cse
	group by symbol, ind_direction
)
SELECT * 
FROM source
PIVOT (
    MAX(sno)
    FOR ind_direction IN (' + @cols + ')
) AS pivoted
order by symbol';

EXEC sp_executesql @query;
end
begin
USE tempdb;

EXEC sp_helpfile;
DBCC SHRINKFILE (temp9, EMPTYFILE);
ALTER DATABASE tempdb REMOVE FILE temp9;

use Stocks_Analysis;

EXEC sp_helpfile;
DBCC SHRINKFILE (Stocks_Analysis_log, EMPTYFILE);
end
begin

select count(1),batch_no from Analyse_Stocks -- where Trade_Type_Details_Sum is not null
group by Batch_No
;
end
begin

select * from (select distinct top 30 batch_no,'Cash_Stocks' as tblname from Cash_Stocks order by 1 desc) a
union all
select * from (select distinct top 30 batch_no,'Analyse_Stocks' as tblname from Analyse_Stocks order by 1 desc) b
;

select * from Analyse_Stocks where Batch_No = 20250726145435
order by Batch_No desc;
select * from dbo.Analyse_Stocks_v;
end
begin
EXEC sp_rename 'table_name.old_column_name', 'new_column_name', 'COLUMN';


exec sp_rename 'analyse_15minutes_stocks.volume__yearly__shockers','volume_yearly_shockers', 'COLUMN';
exec sp_rename 'analyse_15minutes_stocks.volume__quarterly__shockers','volume_quarterly_shockers', 'COLUMN';
exec sp_rename 'analyse_15minutes_stocks.volume__monthly__shockers','volume_monthly_shockers', 'COLUMN';
exec sp_rename 'analyse_15minutes_stocks.volume__weekly__shockers','volume_weekly_shockers', 'COLUMN';
exec sp_rename 'analyse_15minutes_stocks.volume__daily__shockers','volume_daily_shockers', 'COLUMN';
exec sp_rename 'analyse_15minutes_stocks.volume__4_hourly__shockers','volume_4_hourly_shockers', 'COLUMN';
exec sp_rename 'analyse_15minutes_stocks.volume__1_hourly__shockers','volume_1_hourly_shockers', 'COLUMN';
exec sp_rename 'analyse_15minutes_stocks.volume__15_minutes__shockers','volume_15_minutes_shockers', 'COLUMN';
end

begin
select * from Analyse_Stocks_v order by 1;
;
select top 10 * from Analyse_Stocks
;
select * from Cash_Stocks 
where batch_no = ( select max(batch_no) from Cash_Stocks)
order by batch_no desc
;
select * from 
dbo.Master_Stocks_In_Segments a
inner join Analyse_Stocks_v b on a.Symbol = b.Symbol
;
end
begin
select * from dbo.Cash_Stocks 
where Batch_No = (select max(batch_no) from Cash_Stocks)
order by Batch_No desc



WITH cte AS (
    SELECT *, REPLACE(indicator, ' ', '_') + '_' + REPLACE(timeline, ' ', '_') + '_' + REPLACE(direction, ' ', '_') AS ind_direction
    FROM dbo.Cash_Stocks
    WHERE Batch_No = 20250727075455
),
source as (
	select symbol, ind_direction
	, 1 as sno
	, MAX(stock_name) as stock_name
	, MAX(Percent_Change) as Percent_Change
	, MAX(price) as price
	, MAX(volume) as volume
	, MAX(Batch_No) as batch_no
	, SYSDATETIME() as created_date
	from cte
	group by symbol, ind_direction
)
insert into dbo.Analyse_Stocks (Symbol,Stock_Name,Percent_Change,Price,Volume,Batch_No,Created_Date,adx_quarterly_crosses_below,adx_1_hourly_crosses_below,adx_4_hourly_crosses_below,adx_weekly_crosses_above,adx_weekly_crosses_below,adx_quarterly_crosses_above,adx_monthly_crosses_below,adx_daily_crosses_above,adx_monthly_crosses_above,adx_15_minutes_crosses_above,adx_4_hourly_crosses_above,adx_daily_crosses_below,adx_yearly_crosses_above,adx_1_hourly_crosses_above,adx_yearly_crosses_below,adx_15_minutes_crosses_below,adx_down_tick_15_minutes_less_than_equal_to,adx_down_tick_1_hourly_less_than_equal_to,adx_down_tick_4_hourly_less_than_equal_to,adx_down_tick_monthly_less_than_equal_to,adx_down_tick_quarterly_less_than_equal_to,adx_down_tick_daily_less_than_equal_to,adx_down_tick_weekly_less_than_equal_to,adx_down_tick_yearly_less_than_equal_to,adx_up_tick_quarterly_greater_than_equal_to,adx_up_tick_1_hourly_greater_than_equal_to,adx_up_tick_4_hourly_greater_than_equal_to,adx_up_tick_yearly_greater_than_equal_to,adx_up_tick_daily_greater_than_equal_to,adx_up_tick_15_minutes_greater_than_equal_to,adx_up_tick_weekly_greater_than_equal_to,adx_up_tick_monthly_greater_than_equal_to,ema_100_200_monthly_crosses_above,ema_100_200_yearly_crosses_above,ema_100_200_quarterly_crosses_below,ema_100_200_daily_crosses_below,ema_100_200_1_hourly_crosses_below,ema_100_200_15_minutes_crosses_below,ema_100_200_quarterly_crosses_above,ema_100_200_weekly_crosses_below,ema_100_200_4_hourly_crosses_above,ema_100_200_daily_crosses_above,ema_100_200_15_minutes_crosses_above,ema_100_200_4_hourly_crosses_below,ema_100_200_yearly_crosses_below,ema_100_200_monthly_crosses_below,ema_100_200_weekly_crosses_above,ema_100_200_1_hourly_crosses_above,ema_13_26_weekly_crosses_above,ema_13_26_1_hourly_crosses_below,ema_13_26_15_minutes_crosses_below,ema_13_26_1_hourly_crosses_above,ema_13_26_daily_crosses_above,ema_13_26_monthly_crosses_above,ema_13_26_yearly_crosses_above,ema_13_26_quarterly_crosses_above,ema_13_26_weekly_crosses_below,ema_13_26_4_hourly_crosses_below,ema_13_26_4_hourly_crosses_above,ema_13_26_daily_crosses_below,ema_13_26_quarterly_crosses_below,ema_13_26_15_minutes_crosses_above,ema_13_26_yearly_crosses_below,ema_13_26_monthly_crosses_below,ema_5_13_weekly_crosses_below,ema_5_13_yearly_crosses_above,ema_5_13_monthly_crosses_above,ema_5_13_1_hourly_crosses_below,ema_5_13_weekly_crosses_above,ema_5_13_quarterly_crosses_below,ema_5_13_daily_crosses_above,ema_5_13_15_minutes_crosses_above,ema_5_13_daily_crosses_below,ema_5_13_1_hourly_crosses_above,ema_5_13_15_minutes_crosses_below,ema_5_13_quarterly_crosses_above,ema_5_13_4_hourly_crosses_below,ema_5_13_yearly_crosses_below,ema_5_13_monthly_crosses_below,ema_5_13_4_hourly_crosses_above,ema_50_100_yearly_crosses_above,ema_50_100_4_hourly_crosses_above,ema_50_100_quarterly_crosses_above,ema_50_100_yearly_crosses_below,ema_50_100_4_hourly_crosses_below,ema_50_100_weekly_crosses_below,ema_50_100_daily_crosses_below,ema_50_100_quarterly_crosses_below,ema_50_100_1_hourly_crosses_above,ema_50_100_monthly_crosses_below,ema_50_100_15_minutes_crosses_above,ema_50_100_daily_crosses_above,ema_50_100_15_minutes_crosses_below,ema_50_100_monthly_crosses_above,ema_50_100_weekly_crosses_above,ema_50_100_1_hourly_crosses_below,lower_bollinger_band2_15_minutes_less_than_equal_to,lower_bollinger_band2_weekly_less_than_equal_to,lower_bollinger_band2_4_hourly_greater_than_equal_to,lower_bollinger_band2_daily_less_than_equal_to,lower_bollinger_band2_monthly_greater_than_equal_to,lower_bollinger_band2_yearly_less_than_equal_to,lower_bollinger_band2_yearly_greater_than_equal_to,lower_bollinger_band2_monthly_less_than_equal_to,lower_bollinger_band2_15_minutes_greater_than_equal_to,lower_bollinger_band2_1_hourly_greater_than_equal_to,lower_bollinger_band2_quarterly_less_than_equal_to,lower_bollinger_band2_daily_greater_than_equal_to,lower_bollinger_band2_weekly_greater_than_equal_to,lower_bollinger_band2_1_hourly_less_than_equal_to,lower_bollinger_band2_quarterly_greater_than_equal_to,lower_bollinger_band2_4_hourly_less_than_equal_to,lower_bollinger_band3_weekly_greater_than_equal_to,lower_bollinger_band3_daily_greater_than_equal_to,lower_bollinger_band3_15_minutes_less_than_equal_to,lower_bollinger_band3_daily_less_than_equal_to,lower_bollinger_band3_quarterly_greater_than_equal_to,lower_bollinger_band3_4_hourly_less_than_equal_to,lower_bollinger_band3_quarterly_less_than_equal_to,lower_bollinger_band3_1_hourly_greater_than_equal_to,lower_bollinger_band3_yearly_less_than_equal_to,lower_bollinger_band3_weekly_less_than_equal_to,lower_bollinger_band3_monthly_less_than_equal_to,lower_bollinger_band3_monthly_greater_than_equal_to,lower_bollinger_band3_yearly_greater_than_equal_to,lower_bollinger_band3_1_hourly_less_than_equal_to,lower_bollinger_band3_4_hourly_greater_than_equal_to,lower_bollinger_band3_15_minutes_greater_than_equal_to,macd_1_hourly_crosses_below,macd_daily_crosses_below,macd_15_minutes_crosses_above,macd_daily_crosses_above,macd_quarterly_crosses_below,macd_yearly_crosses_below,macd_4_hourly_crosses_below,macd_1_hourly_crosses_above,macd_monthly_crosses_above,macd_4_hourly_crosses_above,macd_15_minutes_crosses_below,macd_weekly_crosses_above,macd_monthly_crosses_below,macd_quarterly_crosses_above,macd_weekly_crosses_below,macd_yearly_crosses_above,rsi_yearly_crosses_above,rsi_yearly_crosses_below,rsi_monthly_crosses_above,rsi_daily_crosses_above,rsi_daily_crosses_below,rsi_1_hourly_crosses_below,rsi_weekly_crosses_above,rsi_15_minutes_crosses_below,rsi_monthly_crosses_below,rsi_1_hourly_crosses_above,rsi_4_hourly_crosses_above,rsi_quarterly_crosses_above,rsi_15_minutes_crosses_above,rsi_weekly_crosses_below,rsi_quarterly_crosses_below,rsi_4_hourly_crosses_below,stochastic_quarterly_crosses_above,stochastic_15_minutes_crosses_above,stochastic_monthly_crosses_above,stochastic_monthly_crosses_below,stochastic_weekly_crosses_below,stochastic_1_hourly_crosses_above,stochastic_4_hourly_crosses_above,stochastic_daily_crosses_below,stochastic_yearly_crosses_below,stochastic_4_hourly_crosses_below,stochastic_yearly_crosses_above,stochastic_weekly_crosses_above,stochastic_1_hourly_crosses_below,stochastic_quarterly_crosses_below,stochastic_daily_crosses_above,stochastic_15_minutes_crosses_below,upper_bollinger_band2_15_minutes_less_than_equal_to,upper_bollinger_band2_1_hourly_greater_than_equal_to,upper_bollinger_band2_yearly_less_than_equal_to,upper_bollinger_band2_15_minutes_greater_than_equal_to,upper_bollinger_band2_daily_greater_than_equal_to,upper_bollinger_band2_daily_less_than_equal_to,upper_bollinger_band2_monthly_less_than_equal_to,upper_bollinger_band2_1_hourly_less_than_equal_to,upper_bollinger_band2_quarterly_greater_than_equal_to,upper_bollinger_band2_yearly_greater_than_equal_to,upper_bollinger_band2_4_hourly_less_than_equal_to,upper_bollinger_band2_weekly_less_than_equal_to,upper_bollinger_band2_quarterly_less_than_equal_to,upper_bollinger_band2_4_hourly_greater_than_equal_to,upper_bollinger_band2_monthly_greater_than_equal_to,upper_bollinger_band2_weekly_greater_than_equal_to,upper_bollinger_band3_monthly_greater_than_equal_to,upper_bollinger_band3_weekly_greater_than_equal_to,upper_bollinger_band3_weekly_less_than_equal_to,upper_bollinger_band3_quarterly_less_than_equal_to,upper_bollinger_band3_1_hourly_less_than_equal_to,upper_bollinger_band3_4_hourly_greater_than_equal_to,upper_bollinger_band3_monthly_less_than_equal_to,upper_bollinger_band3_4_hourly_less_than_equal_to,upper_bollinger_band3_daily_less_than_equal_to,upper_bollinger_band3_quarterly_greater_than_equal_to,upper_bollinger_band3_daily_greater_than_equal_to,upper_bollinger_band3_yearly_greater_than_equal_to,upper_bollinger_band3_15_minutes_less_than_equal_to,upper_bollinger_band3_1_hourly_greater_than_equal_to,upper_bollinger_band3_15_minutes_greater_than_equal_to,upper_bollinger_band3_yearly_less_than_equal_to,volume_4_hourly_greater_than_equal_to,volume_daily_greater_than_equal_to,volume_weekly_less_than_equal_to,volume_yearly_shockers,volume_4_hourly_shockers,volume_quarterly_greater_than_equal_to,volume_yearly_less_than_equal_to,volume_1_hourly_shockers,volume_yearly_greater_than_equal_to,volume_daily_less_than_equal_to,volume_monthly_greater_than_equal_to,volume_4_hourly_less_than_equal_to,volume_1_hourly_less_than_equal_to,volume_1_hourly_greater_than_equal_to,volume_weekly_shockers,volume_15_minutes_less_than_equal_to,volume_quarterly_less_than_equal_to,volume_15_minutes_greater_than_equal_to,volume_15_minutes_shockers,volume_monthly_shockers,volume_daily_shockers,volume_monthly_less_than_equal_to,volume_quarterly_shockers,volume_weekly_greater_than_equal_to)
SELECT * 
FROM source
PIVOT (
    MAX(sno)
    FOR ind_direction IN (adx_quarterly_crosses_below,adx_1_hourly_crosses_below,adx_4_hourly_crosses_below,adx_weekly_crosses_above,adx_weekly_crosses_below,adx_quarterly_crosses_above,adx_monthly_crosses_below,adx_daily_crosses_above,adx_monthly_crosses_above,adx_15_minutes_crosses_above,adx_4_hourly_crosses_above,adx_daily_crosses_below,adx_yearly_crosses_above,adx_1_hourly_crosses_above,adx_yearly_crosses_below,adx_15_minutes_crosses_below,adx_down_tick_15_minutes_less_than_equal_to,adx_down_tick_1_hourly_less_than_equal_to,adx_down_tick_4_hourly_less_than_equal_to,adx_down_tick_monthly_less_than_equal_to,adx_down_tick_quarterly_less_than_equal_to,adx_down_tick_daily_less_than_equal_to,adx_down_tick_weekly_less_than_equal_to,adx_down_tick_yearly_less_than_equal_to,adx_up_tick_quarterly_greater_than_equal_to,adx_up_tick_1_hourly_greater_than_equal_to,adx_up_tick_4_hourly_greater_than_equal_to,adx_up_tick_yearly_greater_than_equal_to,adx_up_tick_daily_greater_than_equal_to,adx_up_tick_15_minutes_greater_than_equal_to,adx_up_tick_weekly_greater_than_equal_to,adx_up_tick_monthly_greater_than_equal_to,ema_100_200_monthly_crosses_above,ema_100_200_yearly_crosses_above,ema_100_200_quarterly_crosses_below,ema_100_200_daily_crosses_below,ema_100_200_1_hourly_crosses_below,ema_100_200_15_minutes_crosses_below,ema_100_200_quarterly_crosses_above,ema_100_200_weekly_crosses_below,ema_100_200_4_hourly_crosses_above,ema_100_200_daily_crosses_above,ema_100_200_15_minutes_crosses_above,ema_100_200_4_hourly_crosses_below,ema_100_200_yearly_crosses_below,ema_100_200_monthly_crosses_below,ema_100_200_weekly_crosses_above,ema_100_200_1_hourly_crosses_above,ema_13_26_weekly_crosses_above,ema_13_26_1_hourly_crosses_below,ema_13_26_15_minutes_crosses_below,ema_13_26_1_hourly_crosses_above,ema_13_26_daily_crosses_above,ema_13_26_monthly_crosses_above,ema_13_26_yearly_crosses_above,ema_13_26_quarterly_crosses_above,ema_13_26_weekly_crosses_below,ema_13_26_4_hourly_crosses_below,ema_13_26_4_hourly_crosses_above,ema_13_26_daily_crosses_below,ema_13_26_quarterly_crosses_below,ema_13_26_15_minutes_crosses_above,ema_13_26_yearly_crosses_below,ema_13_26_monthly_crosses_below,ema_5_13_weekly_crosses_below,ema_5_13_yearly_crosses_above,ema_5_13_monthly_crosses_above,ema_5_13_1_hourly_crosses_below,ema_5_13_weekly_crosses_above,ema_5_13_quarterly_crosses_below,ema_5_13_daily_crosses_above,ema_5_13_15_minutes_crosses_above,ema_5_13_daily_crosses_below,ema_5_13_1_hourly_crosses_above,ema_5_13_15_minutes_crosses_below,ema_5_13_quarterly_crosses_above,ema_5_13_4_hourly_crosses_below,ema_5_13_yearly_crosses_below,ema_5_13_monthly_crosses_below,ema_5_13_4_hourly_crosses_above,ema_50_100_yearly_crosses_above,ema_50_100_4_hourly_crosses_above,ema_50_100_quarterly_crosses_above,ema_50_100_yearly_crosses_below,ema_50_100_4_hourly_crosses_below,ema_50_100_weekly_crosses_below,ema_50_100_daily_crosses_below,ema_50_100_quarterly_crosses_below,ema_50_100_1_hourly_crosses_above,ema_50_100_monthly_crosses_below,ema_50_100_15_minutes_crosses_above,ema_50_100_daily_crosses_above,ema_50_100_15_minutes_crosses_below,ema_50_100_monthly_crosses_above,ema_50_100_weekly_crosses_above,ema_50_100_1_hourly_crosses_below,lower_bollinger_band2_15_minutes_less_than_equal_to,lower_bollinger_band2_weekly_less_than_equal_to,lower_bollinger_band2_4_hourly_greater_than_equal_to,lower_bollinger_band2_daily_less_than_equal_to,lower_bollinger_band2_monthly_greater_than_equal_to,lower_bollinger_band2_yearly_less_than_equal_to,lower_bollinger_band2_yearly_greater_than_equal_to,lower_bollinger_band2_monthly_less_than_equal_to,lower_bollinger_band2_15_minutes_greater_than_equal_to,lower_bollinger_band2_1_hourly_greater_than_equal_to,lower_bollinger_band2_quarterly_less_than_equal_to,lower_bollinger_band2_daily_greater_than_equal_to,lower_bollinger_band2_weekly_greater_than_equal_to,lower_bollinger_band2_1_hourly_less_than_equal_to,lower_bollinger_band2_quarterly_greater_than_equal_to,lower_bollinger_band2_4_hourly_less_than_equal_to,lower_bollinger_band3_weekly_greater_than_equal_to,lower_bollinger_band3_daily_greater_than_equal_to,lower_bollinger_band3_15_minutes_less_than_equal_to,lower_bollinger_band3_daily_less_than_equal_to,lower_bollinger_band3_quarterly_greater_than_equal_to,lower_bollinger_band3_4_hourly_less_than_equal_to,lower_bollinger_band3_quarterly_less_than_equal_to,lower_bollinger_band3_1_hourly_greater_than_equal_to,lower_bollinger_band3_yearly_less_than_equal_to,lower_bollinger_band3_weekly_less_than_equal_to,lower_bollinger_band3_monthly_less_than_equal_to,lower_bollinger_band3_monthly_greater_than_equal_to,lower_bollinger_band3_yearly_greater_than_equal_to,lower_bollinger_band3_1_hourly_less_than_equal_to,lower_bollinger_band3_4_hourly_greater_than_equal_to,lower_bollinger_band3_15_minutes_greater_than_equal_to,macd_1_hourly_crosses_below,macd_daily_crosses_below,macd_15_minutes_crosses_above,macd_daily_crosses_above,macd_quarterly_crosses_below,macd_yearly_crosses_below,macd_4_hourly_crosses_below,macd_1_hourly_crosses_above,macd_monthly_crosses_above,macd_4_hourly_crosses_above,macd_15_minutes_crosses_below,macd_weekly_crosses_above,macd_monthly_crosses_below,macd_quarterly_crosses_above,macd_weekly_crosses_below,macd_yearly_crosses_above,rsi_yearly_crosses_above,rsi_yearly_crosses_below,rsi_monthly_crosses_above,rsi_daily_crosses_above,rsi_daily_crosses_below,rsi_1_hourly_crosses_below,rsi_weekly_crosses_above,rsi_15_minutes_crosses_below,rsi_monthly_crosses_below,rsi_1_hourly_crosses_above,rsi_4_hourly_crosses_above,rsi_quarterly_crosses_above,rsi_15_minutes_crosses_above,rsi_weekly_crosses_below,rsi_quarterly_crosses_below,rsi_4_hourly_crosses_below,stochastic_quarterly_crosses_above,stochastic_15_minutes_crosses_above,stochastic_monthly_crosses_above,stochastic_monthly_crosses_below,stochastic_weekly_crosses_below,stochastic_1_hourly_crosses_above,stochastic_4_hourly_crosses_above,stochastic_daily_crosses_below,stochastic_yearly_crosses_below,stochastic_4_hourly_crosses_below,stochastic_yearly_crosses_above,stochastic_weekly_crosses_above,stochastic_1_hourly_crosses_below,stochastic_quarterly_crosses_below,stochastic_daily_crosses_above,stochastic_15_minutes_crosses_below,upper_bollinger_band2_15_minutes_less_than_equal_to,upper_bollinger_band2_1_hourly_greater_than_equal_to,upper_bollinger_band2_yearly_less_than_equal_to,upper_bollinger_band2_15_minutes_greater_than_equal_to,upper_bollinger_band2_daily_greater_than_equal_to,upper_bollinger_band2_daily_less_than_equal_to,upper_bollinger_band2_monthly_less_than_equal_to,upper_bollinger_band2_1_hourly_less_than_equal_to,upper_bollinger_band2_quarterly_greater_than_equal_to,upper_bollinger_band2_yearly_greater_than_equal_to,upper_bollinger_band2_4_hourly_less_than_equal_to,upper_bollinger_band2_weekly_less_than_equal_to,upper_bollinger_band2_quarterly_less_than_equal_to,upper_bollinger_band2_4_hourly_greater_than_equal_to,upper_bollinger_band2_monthly_greater_than_equal_to,upper_bollinger_band2_weekly_greater_than_equal_to,upper_bollinger_band3_monthly_greater_than_equal_to,upper_bollinger_band3_weekly_greater_than_equal_to,upper_bollinger_band3_weekly_less_than_equal_to,upper_bollinger_band3_quarterly_less_than_equal_to,upper_bollinger_band3_1_hourly_less_than_equal_to,upper_bollinger_band3_4_hourly_greater_than_equal_to,upper_bollinger_band3_monthly_less_than_equal_to,upper_bollinger_band3_4_hourly_less_than_equal_to,upper_bollinger_band3_daily_less_than_equal_to,upper_bollinger_band3_quarterly_greater_than_equal_to,upper_bollinger_band3_daily_greater_than_equal_to,upper_bollinger_band3_yearly_greater_than_equal_to,upper_bollinger_band3_15_minutes_less_than_equal_to,upper_bollinger_band3_1_hourly_greater_than_equal_to,upper_bollinger_band3_15_minutes_greater_than_equal_to,upper_bollinger_band3_yearly_less_than_equal_to,volume_4_hourly_greater_than_equal_to,volume_daily_greater_than_equal_to,volume_weekly_less_than_equal_to,volume_yearly_shockers,volume_4_hourly_shockers,volume_quarterly_greater_than_equal_to,volume_yearly_less_than_equal_to,volume_1_hourly_shockers,volume_yearly_greater_than_equal_to,volume_daily_less_than_equal_to,volume_monthly_greater_than_equal_to,volume_4_hourly_less_than_equal_to,volume_1_hourly_less_than_equal_to,volume_1_hourly_greater_than_equal_to,volume_weekly_shockers,volume_15_minutes_less_than_equal_to,volume_quarterly_less_than_equal_to,volume_15_minutes_greater_than_equal_to,volume_15_minutes_shockers,volume_monthly_shockers,volume_daily_shockers,volume_monthly_less_than_equal_to,volume_quarterly_shockers,volume_weekly_greater_than_equal_to)
) AS pivoted
order by symbol;
end
rollback transaction
end
begin
select * from dbo.ScreenSort
select * from dbo.Sector_Table
select * from dbo.Stocks_Industry_Sector_Wise
select * from dbo.Stocks_Industry_Sector_Wise_distinct
end
begin
EXEC sp_rename 'table_name.old_column_name', 'new_column_name', 'COLUMN';

exec sp_rename 'Analyse_15Minutes_Stocks.Report_Sort_Order'          ,Report_Sort_Order        ,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.Trading View'               ,Trading_View             ,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.Trading View - Order'       ,Trading_View_Order       ,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.Segments - Order'           ,Segments_Order           ,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.Volume_Shockers - Sum'      ,Volume_Shockers_Sum      ,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.Trade Type Details'         ,Trade_Type_Details       ,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.Trade Type Details - Sum'   ,Trade_Type_Details_Sum   ,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.Percent_Change'                      ,Percent_Change           ,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.Trade Type'                 ,Trade_Type               ,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.Trade Type - Length'        ,Trade_Type_Length        ,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.Trade Type - Bullish Sum'   ,Trade_Type_Bullish_Sum   ,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.Trade Type - Bearish Sum'   ,Trade_Type_Bearish_Sum   ,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.Trade Type Details - Length',Trade_Type_Details_Length,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.Segments - Length'          ,Segments_Length          ,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.Segments_Sum'             ,Segments_Sum             ,'column';

end
begin 
EXEC sp_rename 'table_name.old_column_name', 'new_column_name', 'COLUMN';

exec sp_rename 'Analyse_15Minutes_Stocks.Report_Sort_Order'			   ,Report_Sort_Order        ,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.[Trading View]'               ,Trading_View             ,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.[Trading View - Order]'       ,Trading_View_Order       ,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.[Segments - Order]'           ,Segments_Order           ,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.[Volume_Shockers - Sum]'      ,Volume_Shockers_Sum      ,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.[Trade Type Details]'         ,Trade_Type_Details       ,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.[Trade Type Details - Sum]'   ,Trade_Type_Details_Sum   ,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.Percent_Change'               ,Percent_Change           ,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.[Trade Type]'                 ,Trade_Type               ,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.[Trade Type - Length]'        ,Trade_Type_Length        ,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.[Trade Type - Bullish Sum]'   ,Trade_Type_Bullish_Sum   ,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.[Trade Type - Bearish Sum]'   ,Trade_Type_Bearish_Sum   ,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.[Trade Type Details - Length]',Trade_Type_Details_Length,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.[Segments - Length]'          ,Segments_Length          ,'column';
exec sp_rename 'Analyse_15Minutes_Stocks.Segments_Sum'				   ,Segments_Sum             ,'column';


sno -- Sno
% Cng - Percent_change
segments - segments
end
